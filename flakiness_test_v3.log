Run 1
warning: setting :preferred_cli_env in your mix.exs "def project" is deprecated, set it inside "def cli" instead:

    def cli do
      [preferred_envs: [release: :prod, test: :test]]
    end

  (mix 1.19.4) lib/mix/cli.ex:187: Mix.CLI.preferred_cli_env/3
  (mix 1.19.4) lib/mix/cli.ex:170: Mix.CLI.maybe_change_env_and_target/2
  (mix 1.19.4) lib/mix/cli.ex:59: Mix.CLI.proceed/2
  /opt/homebrew/bin/mix:7: (file)
  (elixir 1.19.4) src/elixir_compiler.erl:81: :elixir_compiler.dispatch/4
  (elixir 1.19.4) src/elixir_compiler.erl:56: :elixir_compiler.compile/4

    warning: unused alias Decapsulator
    │
  8 │   alias DataDiode.S2.Decapsulator
    │   ~
    │
    └─ lib/data_diode/s2/listener.ex:8:3

16:04:27.581 [info] Application logger started at :nonode@nohost
16:04:27.588 [info] Child :ttb_autostart of Supervisor :runtime_tools_sup started
Pid: #PID<0.184.0>
Start Call: :ttb_autostart.start_link()
Restart: :temporary
Shutdown: 3000
Type: :worker
16:04:27.588 [info] Application runtime_tools started at :nonode@nohost
16:04:27.588 [info] Application opentelemetry_api started at :nonode@nohost
16:04:27.588 [info] Application ctx started at :nonode@nohost
16:04:27.589 [info] Application hpack started at :nonode@nohost
16:04:27.589 [info] Application chatterbox started at :nonode@nohost
16:04:27.589 [info] Application acceptor_pool started at :nonode@nohost
16:04:27.595 [info] Child :gproc of Supervisor :gproc_sup started
Pid: #PID<0.188.0>
Start Call: :gproc.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:04:27.596 [info] Child :gproc_monitor of Supervisor :gproc_sup started
Pid: #PID<0.189.0>
Start Call: :gproc_monitor.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:04:27.596 [info] Child :gproc_bcast of Supervisor :gproc_sup started
Pid: #PID<0.190.0>
Start Call: :gproc_bcast.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:04:27.598 [info] Child :gproc_pool of Supervisor :gproc_sup started
Pid: #PID<0.191.0>
Start Call: :gproc_pool.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:04:27.598 [info] Application gproc started at :nonode@nohost
16:04:27.600 [info] Child :grpcbox_services_simple_sup of Supervisor :grpcbox_sup started
Pid: #PID<0.195.0>
Start Call: :grpcbox_services_simple_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:04:27.601 [info] Child :grpcbox_channel_sup of Supervisor :grpcbox_sup started
Pid: #PID<0.196.0>
Start Call: :grpcbox_channel_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:04:27.601 [info] Application grpcbox started at :nonode@nohost
16:04:27.601 [info] Application ssl_verify_fun started at :nonode@nohost
16:04:27.674 [info] Loading 162 CA(s) from :otp store
16:04:27.674 [info] Child :tls_certificate_check_shared_state of Supervisor :tls_certificate_check_sup started
Pid: #PID<0.200.0>
Start Call: :tls_certificate_check_shared_state.start_link()
Restart: :permanent
Shutdown: :infinity
Type: :worker
16:04:27.674 [info] Application tls_certificate_check started at :nonode@nohost
16:04:27.674 [info] Application opentelemetry_exporter started at :nonode@nohost
16:04:27.682 [info] Child :otel_span_ets of Supervisor :otel_span_sup started
Pid: #PID<0.208.0>
Start Call: :otel_span_ets.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:27.683 [info] Child :otel_span_sweeper of Supervisor :otel_span_sup started
Pid: #PID<0.209.0>
Start Call: :otel_span_sweeper.start_link(%{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:27.683 [info] Child :otel_span_sup of Supervisor :opentelemetry_sup started
Pid: #PID<0.207.0>
Start Call: :otel_span_sup.start_link(%{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:04:27.686 [info] Child :otel_resource_detector of Supervisor :opentelemetry_sup started
Pid: #PID<0.210.0>
Start Call: :otel_resource_detector.start_link(%{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:27.688 [info] Child :otel_tracer_provider_sup of Supervisor :opentelemetry_sup started
Pid: #PID<0.213.0>
Start Call: :otel_tracer_provider_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:04:27.691 [info] Child :otel_span_processor_sup of Supervisor #PID<0.214.0> (:otel_tracer_server_sup) started
Pid: #PID<0.215.0>
Start Call: :otel_span_processor_sup.start_link(:otel_span_processor_sup_global)
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:04:27.698 [info] Child :otel_tracer_server of Supervisor #PID<0.214.0> (:otel_tracer_server_sup) started
Pid: #PID<0.216.0>
Start Call: :otel_tracer_server.start_link(:global, :otel_tracer_provider_global, :otel_span_processor_sup_global, {:resource, :undefined, {:attributes, 128, 255, 0, %{"process.executable.name": "erl", "process.runtime.description": "Erlang/OTP 28 erts-16.1.2", "process.runtime.version": "16.1.2", "process.runtime.name": "BEAM", "service.name": "unknown_service:erl", "service.instance.id": 70866970461596427942521595256713473305, "telemetry.sdk.version": "1.6.0", "telemetry.sdk.language": "erlang", "telemetry.sdk.name": "opentelemetry"}}}, %{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:27.701 [debug] Child {:httpc, :"otel_exporter_otlp_<0.217.0>"} of Supervisor :httpc_profile_sup started
Pid: #PID<0.218.0>
Start Call: :httpc_manager.start_link(:"otel_exporter_otlp_<0.217.0>", :only_session_cookies, :inets)
Restart: :permanent
Shutdown: 4000
Type: :worker
16:04:27.704 [info] OTLP exporter successfully initialized
16:04:27.705 [info] Application opentelemetry started at :nonode@nohost
16:04:27.705 [info] Application jason started at :nonode@nohost
16:04:27.706 [info] Application logger_json started at :nonode@nohost
16:04:27.706 [info] Application nimble_ownership started at :nonode@nohost
16:04:27.709 [info] Child Mox of Supervisor Mox.Supervisor started
Pid: #PID<0.222.0>
Start Call: Mox.start_link_ownership()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:27.709 [info] Application mox started at :nonode@nohost
16:04:27.715 [info] Child DataDiode.Metrics of Supervisor DataDiode.Supervisor started
Pid: #PID<0.226.0>
Start Call: DataDiode.Metrics.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:27.715 [info] Child DataDiode.SystemMonitor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.227.0>
Start Call: DataDiode.SystemMonitor.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:27.716 [info] S1: Starting TCP Listener on port 0...
16:04:27.716 [info] Child DataDiode.S1.Listener of Supervisor DataDiode.Supervisor started
Pid: #PID<0.228.0>
Start Call: DataDiode.S1.Listener.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:27.718 [info] Child DataDiode.S1.HandlerSupervisor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.229.0>
Start Call: DataDiode.S1.HandlerSupervisor.start_link()
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:04:27.720 [warning] S1 Encapsulator: Invalid S2_PORT 0, using default 42001
16:04:27.720 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.230.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:27.720 [info] Child DataDiode.S1.Heartbeat of Supervisor DataDiode.Supervisor started
Pid: #PID<0.231.0>
Start Call: DataDiode.S1.Heartbeat.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:27.720 [info] Child DataDiode.S2.HeartbeatMonitor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.232.0>
Start Call: DataDiode.S2.HeartbeatMonitor.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:27.720 [info] Child DataDiode.DiskCleaner of Supervisor DataDiode.Supervisor started
Pid: #PID<0.233.0>
Start Call: DataDiode.DiskCleaner.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:27.721 [info] S2: Starting UDP Listener on port 0...
16:04:27.721 [info] Child DataDiode.S2.Listener of Supervisor DataDiode.Supervisor started
Pid: #PID<0.234.0>
Start Call: DataDiode.S2.Listener.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:27.721 [info] Child DataDiode.S2.TaskSupervisor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.235.0>
Start Call: Task.Supervisor.start_link([name: DataDiode.S2.TaskSupervisor, max_children: 200])
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:04:27.721 [info] Application data_diode started at :nonode@nohost
16:04:27.726 [info] Child ExUnit.Server of Supervisor ExUnit.Supervisor started
Pid: #PID<0.241.0>
Start Call: ExUnit.Server.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:27.726 [info] Child ExUnit.CaptureServer of Supervisor ExUnit.Supervisor started
Pid: #PID<0.242.0>
Start Call: ExUnit.CaptureServer.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:27.726 [info] Application ex_unit started at :nonode@nohost
Running ExUnit with seed: 728221, max_cases: 16

    warning: variable "c" is unused (if the variable is not meant to be used, prefix it with an underscore)
    │
 26 │     {:ok, c} = :gen_tcp.connect({127,0,0,1}, port, [:binary, active: false])
    │           ~
    │
    └─ test/long_term_robustness_test.exs:26:11: DataDiode.LongTermRobustnessTest."test TCPHandler exhaustive branch coverage"/1

    warning: variable "pid3" is unused (if the variable is not meant to be used, prefix it with an underscore)
    │
 62 │     {:ok, pid3} = TCPHandler.start_link(s3)
    │           ~~~~
    │
    └─ test/long_term_robustness_test.exs:62:11: DataDiode.LongTermRobustnessTest."test TCPHandler exhaustive branch coverage"/1

.....     warning: redefining module DataDiode.S1.EncapsulatorMock (current version defined in memory)
     │
 491 │     Module.create(name, [info | body], Macro.Env.location(__ENV__))
     │     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     │
     └─ deps/mox/lib/mox.ex:491: DataDiode.S1.EncapsulatorMock (module)

.16:04:27.810 [info] DiskCleaner: Low disk space detected on . (< 15%). Starting autonomous cleanup...
16:04:27.810 [warning] DiskCleaner: Simulation - would delete oldest .dat files in . now.
....16:04:27.823 [error] S2: Failed to parse header: invalid_packet_size
.16:04:27.823 [info] S2: Decapsulated packet from 0.0.0.0:0. Payload size: 0 bytes.
.16:04:27.823 [debug] S2: Successfully wrote 0 bytes to ./data_1766120667823_1_0.dat. (Simulated secure write)
.16:04:27.823 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 9 bytes.
.16:04:27.823 [debug] S2: Successfully wrote 9 bytes to ./data_1766120667823_2_80.dat. (Simulated secure write)
.16:04:27.823 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 0 bytes.
.16:04:27.823 [debug] S2: Successfully wrote 0 bytes to ./data_1766120667823_3_51210.dat. (Simulated secure write)
.16:04:27.823 [error] S2: Failed to parse header: invalid_packet_size
.16:04:27.823 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 23 bytes.
.16:04:27.823 [debug] S2: Successfully wrote 23 bytes to ./data_1766120667823_4_51210.dat. (Simulated secure write)
.16:04:27.823 [error] S2: Failed to parse header: invalid_packet_size
16:04:27.823 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 23 bytes.
16:04:27.823 [debug] S2: Successfully wrote 23 bytes to ./data_1766120667823_5_51210.dat. (Simulated secure write)
16:04:27.849 [info] Child of Supervisor :inet_gethost_native_sup started
Pid: #PID<0.400.0>
Start Call: :inet_gethost_native.init([])
16:04:27.849 [debug] Child :inet_gethost_native_sup of Supervisor :kernel_safe_sup started
Pid: #PID<0.399.0>
Start Call: :inet_gethost_native.start_link()
Restart: :temporary
Shutdown: 1000
Type: :worker
16:04:27.854 [info] S1: Forwarded 11 bytes.
.16:04:27.864 [debug] S1: TCPHandler received unexpected message: :unknown
.16:04:27.865 [debug] S1: TCPHandler received unexpected message: :accept_loop
.16:04:27.865 [info] S1: Connection closed by 1.2.3.4:80
.16:04:27.866 [warning] S1: Dropping oversized packet (1048577 bytes) from 1.2.3.4
..16:04:27.867 [error] S1: TCP error for 1.2.3.4: :econnreset
......16:04:27.880 [debug] SystemMonitor: Received unexpected message: :unexp
16:04:27.883 [debug] S1: TCPHandler received unexpected message: :unexp
16:04:27.883 [info] S1: Starting TCP Listener on port 0...
16:04:27.883 [debug] S1: Listener received unexpected message: :unexp
16:04:28.719 [info] S2: Starting UDP Listener on port 0...
16:04:28.719 [warning] S2: Received unexpected message: :unexp
16:04:28.719 [error] S2: UDP Listener socket closed unexpectedly. Terminating.
16:04:28.726 [info] DiskCleaner: Low disk space detected on . (< 15%). Starting autonomous cleanup...
16:04:28.726 [warning] DiskCleaner: Simulation - would delete oldest .dat files in . now.
16:04:28.731 [info] S2: Decapsulated packet from 127.0.0.1:20480. Payload size: 7 bytes.
16:04:28.731 [debug] S2: Successfully wrote 7 bytes to /tmp/diode_test/data_1766120668731_7_20480.dat. (Simulated secure write)
16:04:28.731 [info] S2: Decapsulated packet from 127.0.0.1:0. Payload size: 9 bytes.
16:04:28.733 [debug] S1: Generating end-to-end heartbeat.
16:04:28.733 [warning] S1 Heartbeat: Received unexpected message: :unexp
16:04:28.733 [error] S2: Critical Failure! Channel heartbeat missing for > 6 minutes. The diode path may be obstructed.
16:04:28.733 [warning] S2 HeartbeatMonitor: Received unexpected message: :unexp
...16:04:29.222 [info] S1: New connection accepted.
16:04:29.224 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.46>}
16:04:29.224 [info] S1: New connection accepted.
16:04:29.225 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.51>}
16:04:29.225 [info] S1: New connection accepted.
16:04:29.225 [info] S1: New connection accepted.
16:04:29.225 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.52>}
16:04:29.225 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.53>}
16:04:29.225 [info] S1: New connection accepted.
16:04:29.225 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.54>}
..16:04:29.472 [debug] S1: TCPHandler received unexpected message: :accept_loop
.16:04:29.473 [warning] S2: Invalid LISTEN_IP_S2 invalid, falling back to all interfaces.
..16:04:29.474 [info] S2: Starting UDP Listener on port 0...
.16:04:29.495 [info] S2: Starting UDP Listener on port 0...
.16:04:29.495 [info] S2: Starting UDP Listener on port 0...
16:04:29.495 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.496 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669495_13_80.dat. (Simulated secure write)
16:04:29.496 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.496 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669496_14_80.dat. (Simulated secure write)
16:04:29.496 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.496 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669496_15_80.dat. (Simulated secure write)
16:04:29.496 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.496 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669496_16_80.dat. (Simulated secure write)
16:04:29.496 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.496 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669496_17_80.dat. (Simulated secure write)
16:04:29.496 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.496 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669496_18_80.dat. (Simulated secure write)
16:04:29.496 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.496 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669496_19_80.dat. (Simulated secure write)
16:04:29.496 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.496 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669496_20_80.dat. (Simulated secure write)
16:04:29.497 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.497 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669497_21_80.dat. (Simulated secure write)
16:04:29.497 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.497 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669497_22_80.dat. (Simulated secure write)
16:04:29.497 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.497 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669497_23_80.dat. (Simulated secure write)
16:04:29.497 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.497 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669497_24_80.dat. (Simulated secure write)
16:04:29.497 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.497 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669497_25_80.dat. (Simulated secure write)
16:04:29.497 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.497 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669497_26_80.dat. (Simulated secure write)
16:04:29.497 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.497 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669497_27_80.dat. (Simulated secure write)
16:04:29.497 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.498 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669498_28_80.dat. (Simulated secure write)
16:04:29.498 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.498 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669498_29_80.dat. (Simulated secure write)
16:04:29.498 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.498 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669498_30_80.dat. (Simulated secure write)
16:04:29.498 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.498 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669498_31_80.dat. (Simulated secure write)
16:04:29.498 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.498 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669498_32_80.dat. (Simulated secure write)
16:04:29.498 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.498 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669498_33_80.dat. (Simulated secure write)
16:04:29.498 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.498 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669498_34_80.dat. (Simulated secure write)
16:04:29.498 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.498 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669498_35_80.dat. (Simulated secure write)
16:04:29.499 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.499 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669499_36_80.dat. (Simulated secure write)
16:04:29.499 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.499 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669499_37_80.dat. (Simulated secure write)
16:04:29.499 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.499 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669499_38_80.dat. (Simulated secure write)
16:04:29.499 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.499 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669499_39_80.dat. (Simulated secure write)
16:04:29.499 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.499 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669499_40_80.dat. (Simulated secure write)
16:04:29.499 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.499 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669499_41_80.dat. (Simulated secure write)
16:04:29.499 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.499 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669499_42_80.dat. (Simulated secure write)
16:04:29.499 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.499 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669499_43_80.dat. (Simulated secure write)
16:04:29.499 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.499 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669499_44_80.dat. (Simulated secure write)
16:04:29.499 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.500 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669500_45_80.dat. (Simulated secure write)
16:04:29.500 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.500 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669500_46_80.dat. (Simulated secure write)
16:04:29.500 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.500 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669500_47_80.dat. (Simulated secure write)
16:04:29.500 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.500 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669500_48_80.dat. (Simulated secure write)
16:04:29.500 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.500 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669500_49_80.dat. (Simulated secure write)
16:04:29.500 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.500 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.500 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669500_51_80.dat. (Simulated secure write)
16:04:29.500 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669500_50_80.dat. (Simulated secure write)
16:04:29.500 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.500 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669500_52_80.dat. (Simulated secure write)
16:04:29.500 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.500 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669500_53_80.dat. (Simulated secure write)
16:04:29.500 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.500 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669500_54_80.dat. (Simulated secure write)
16:04:29.500 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.500 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669500_55_80.dat. (Simulated secure write)
16:04:29.501 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.501 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669501_56_80.dat. (Simulated secure write)
16:04:29.501 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.501 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669501_57_80.dat. (Simulated secure write)
16:04:29.501 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.501 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669501_58_80.dat. (Simulated secure write)
16:04:29.501 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.501 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669501_59_80.dat. (Simulated secure write)
16:04:29.501 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.501 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669501_60_80.dat. (Simulated secure write)
16:04:29.501 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.501 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669501_61_80.dat. (Simulated secure write)
16:04:29.501 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.501 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669501_62_80.dat. (Simulated secure write)
16:04:29.501 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.501 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669501_63_80.dat. (Simulated secure write)
16:04:29.501 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.501 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669501_64_80.dat. (Simulated secure write)
16:04:29.501 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.501 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669501_65_80.dat. (Simulated secure write)
16:04:29.502 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.502 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669502_66_80.dat. (Simulated secure write)
16:04:29.502 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.502 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.502 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669502_67_80.dat. (Simulated secure write)
16:04:29.502 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.502 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669502_68_80.dat. (Simulated secure write)
16:04:29.502 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.502 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669502_69_80.dat. (Simulated secure write)
16:04:29.502 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.502 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669502_70_80.dat. (Simulated secure write)
16:04:29.502 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.502 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669502_71_80.dat. (Simulated secure write)
16:04:29.502 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.502 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669502_72_80.dat. (Simulated secure write)
16:04:29.502 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.502 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669502_73_80.dat. (Simulated secure write)
16:04:29.502 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.502 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669502_74_80.dat. (Simulated secure write)
16:04:29.503 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.503 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669503_75_80.dat. (Simulated secure write)
16:04:29.503 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.503 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669503_76_80.dat. (Simulated secure write)
16:04:29.503 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.503 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669503_77_80.dat. (Simulated secure write)
16:04:29.503 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.503 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669503_78_80.dat. (Simulated secure write)
16:04:29.503 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.503 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669503_79_80.dat. (Simulated secure write)
16:04:29.503 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669503_80_80.dat. (Simulated secure write)
16:04:29.503 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.503 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.503 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.503 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.503 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.503 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.504 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.504 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.504 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.504 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.504 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.504 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.504 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.504 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.504 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.504 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669504_81_80.dat. (Simulated secure write)
16:04:29.504 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.504 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669504_83_80.dat. (Simulated secure write)
16:04:29.504 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669504_87_80.dat. (Simulated secure write)
16:04:29.504 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669504_86_80.dat. (Simulated secure write)
16:04:29.504 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669504_82_80.dat. (Simulated secure write)
16:04:29.504 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669504_84_80.dat. (Simulated secure write)
16:04:29.504 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.504 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669504_85_80.dat. (Simulated secure write)
16:04:29.505 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669505_88_80.dat. (Simulated secure write)
16:04:29.505 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.505 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669505_89_80.dat. (Simulated secure write)
16:04:29.505 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.505 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669505_90_80.dat. (Simulated secure write)
16:04:29.505 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.505 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669505_91_80.dat. (Simulated secure write)
16:04:29.505 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.505 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669505_92_80.dat. (Simulated secure write)
16:04:29.505 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.505 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669505_93_80.dat. (Simulated secure write)
16:04:29.505 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.505 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669505_94_80.dat. (Simulated secure write)
16:04:29.505 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.505 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669505_95_80.dat. (Simulated secure write)
16:04:29.505 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.505 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669505_96_80.dat. (Simulated secure write)
16:04:29.505 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.505 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669505_97_80.dat. (Simulated secure write)
16:04:29.505 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.505 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669505_98_80.dat. (Simulated secure write)
16:04:29.505 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.505 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669505_99_80.dat. (Simulated secure write)
16:04:29.505 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.506 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669505_101_80.dat. (Simulated secure write)
16:04:29.506 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669505_100_80.dat. (Simulated secure write)
16:04:29.506 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.506 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669506_103_80.dat. (Simulated secure write)
16:04:29.506 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669506_102_80.dat. (Simulated secure write)
16:04:29.506 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669506_104_80.dat. (Simulated secure write)
16:04:29.506 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669506_107_80.dat. (Simulated secure write)
16:04:29.506 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669506_106_80.dat. (Simulated secure write)
16:04:29.506 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669506_108_80.dat. (Simulated secure write)
16:04:29.506 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669506_105_80.dat. (Simulated secure write)
16:04:29.506 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669506_109_80.dat. (Simulated secure write)
16:04:29.506 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.506 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:29.506 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669506_110_80.dat. (Simulated secure write)
16:04:29.506 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669506_111_80.dat. (Simulated secure write)
16:04:29.506 [debug] S2: Successfully wrote 7 bytes to ./data_1766120669506_112_80.dat. (Simulated secure write)
...16:04:29.607 [info] S2: Starting UDP Listener on port 0...
16:04:29.607 [info] S2: Decapsulated packet from 1.2.3.4:80. Payload size: 5 bytes.
16:04:29.607 [debug] S2: Successfully wrote 5 bytes to ./data_1766120669607_113_80.dat. (Simulated secure write)
.16:04:29.618 [error] S2: UDP Listener socket closed unexpectedly. Terminating.
.16:04:29.619 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.230.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:29.619 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.708.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:29.629 [warning] S1 Encapsulator: Invalid IP invalid, dropping packet.
.16:04:29.731 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.708.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:29.731 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.710.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:04:29.741 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.710.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:29.742 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.712.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:04:29.753 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.712.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:29.753 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.714.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
...16:04:29.764 [info] S1: Starting TCP Listener on port 8092...
16:04:29.764 [info] S1: New connection accepted.
16:04:29.764 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.80>}
16:04:29.765 [info] S1: New connection accepted.
16:04:29.765 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.82>}
16:04:29.765 [info] S1: New connection accepted.
16:04:29.765 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.84>}
16:04:29.765 [info] S1: New connection accepted.
16:04:29.765 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.86>}
16:04:29.766 [info] S1: New connection accepted.
16:04:29.766 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.88>}
16:04:29.766 [info] S1: New connection accepted.
16:04:29.766 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.90>}
16:04:29.766 [info] S1: New connection accepted.
16:04:29.766 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.92>}
16:04:29.766 [info] S1: New connection accepted.
16:04:29.766 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.94>}
16:04:29.766 [info] S1: New connection accepted.
16:04:29.766 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.96>}
16:04:29.767 [info] S1: New connection accepted.
16:04:29.767 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.98>}
16:04:29.767 [info] S1: New connection accepted.
16:04:29.767 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.100>}
16:04:29.767 [info] S1: New connection accepted.
16:04:29.767 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.102>}
16:04:29.767 [info] S1: New connection accepted.
16:04:29.767 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.104>}
16:04:29.767 [info] S1: New connection accepted.
16:04:29.767 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.106>}
16:04:29.768 [info] S1: New connection accepted.
16:04:29.768 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.108>}
16:04:29.768 [info] S1: New connection accepted.
16:04:29.768 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.110>}
16:04:29.768 [info] S1: New connection accepted.
16:04:29.768 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.112>}
16:04:29.768 [info] S1: New connection accepted.
16:04:29.768 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.114>}
16:04:29.768 [info] S1: New connection accepted.
16:04:29.768 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.116>}
16:04:29.769 [info] S1: New connection accepted.
16:04:29.769 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.118>}
16:04:29.769 [info] S1: New connection accepted.
16:04:29.769 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.120>}
16:04:29.769 [info] S1: New connection accepted.
16:04:29.769 [info] S1: New connection accepted.
16:04:29.769 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.122>}
16:04:29.769 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.124>}
16:04:29.769 [info] S1: New connection accepted.
16:04:29.769 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.126>}
16:04:29.770 [info] S1: New connection accepted.
16:04:29.770 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.128>}
16:04:29.770 [info] S1: New connection accepted.
16:04:29.770 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.130>}
16:04:29.770 [info] S1: New connection accepted.
16:04:29.770 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.132>}
16:04:29.770 [info] S1: New connection accepted.
16:04:29.770 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.134>}
16:04:29.770 [info] S1: New connection accepted.
16:04:29.770 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.136>}
16:04:29.770 [info] S1: New connection accepted.
16:04:29.771 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.138>}
16:04:29.771 [info] S1: New connection accepted.
16:04:29.771 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.140>}
16:04:29.771 [info] S1: New connection accepted.
16:04:29.771 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.142>}
16:04:29.771 [info] S1: New connection accepted.
16:04:29.771 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.144>}
16:04:29.771 [info] S1: New connection accepted.
16:04:29.771 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.146>}
16:04:29.771 [info] S1: New connection accepted.
16:04:29.771 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.148>}
16:04:29.772 [info] S1: New connection accepted.
16:04:29.772 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.150>}
16:04:29.772 [info] S1: New connection accepted.
16:04:29.772 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.152>}
16:04:29.772 [info] S1: New connection accepted.
16:04:29.772 [info] S1: New connection accepted.
16:04:29.772 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.154>}
16:04:29.772 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.156>}
16:04:29.772 [info] S1: New connection accepted.
16:04:29.772 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.158>}
16:04:29.773 [info] S1: New connection accepted.
16:04:29.773 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.160>}
16:04:29.773 [info] S1: New connection accepted.
16:04:29.773 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.162>}
16:04:29.773 [info] S1: New connection accepted.
16:04:29.773 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.164>}
16:04:29.773 [info] S1: New connection accepted.
16:04:29.773 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.166>}
16:04:29.773 [info] S1: New connection accepted.
16:04:29.773 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.168>}
16:04:29.773 [info] S1: New connection accepted.
16:04:29.774 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.170>}
16:04:29.774 [info] S1: New connection accepted.
16:04:29.774 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.172>}
16:04:29.774 [info] S1: New connection accepted.
16:04:29.774 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.174>}
16:04:29.774 [info] S1: New connection accepted.
16:04:29.774 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.176>}
16:04:29.774 [info] S1: New connection accepted.
16:04:29.774 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.178>}
...16:04:30.328 [info] S1: Starting TCP Listener on port 0...
.16:04:30.328 [info] S1: Starting TCP Listener on port 0...
16:04:30.830 [info] S1: New connection accepted.
..16:04:30.831 [info] S1: Starting TCP Listener on port 0...
16:04:31.331 [error] S1: Listener socket fatal error: :closed. Terminating.
16:04:31.332 [error] GenServer :s1_flapping_test_unique terminating
** (stop) :closed
Last message: :accept_loop
State: #Port<0.186>
.16:04:31.332 [error] Process :s1_flapping_test_unique (#PID<0.784.0>) terminating
** (exit) :closed
    (stdlib 7.1) gen_server.erl:2562: :gen_server.handle_common_reply/5
    (stdlib 7.1) proc_lib.erl:333: :proc_lib.init_p_do_apply/3
Initial Call: DataDiode.S1.Listener.init/1
Ancestors: [#PID<0.783.0>]
Message Queue Length: 0
Messages: []
Links: []
Dictionary: []
Trapping Exits: false
Status: :running
Heap Size: 1598
Stack Size: 29
Reductions: 2746
.16:04:31.332 [error] S1: Listener socket fatal error: :closed. Terminating.
....16:04:31.834 [warning] S1: Invalid LISTEN_IP invalid, using all interfaces.
.
Finished in 4.0 seconds (0.1s async, 3.9s sync)
1 doctest, 65 tests, 0 failures
Run 2
warning: setting :preferred_cli_env in your mix.exs "def project" is deprecated, set it inside "def cli" instead:

    def cli do
      [preferred_envs: [release: :prod, test: :test]]
    end

  (mix 1.19.4) lib/mix/cli.ex:187: Mix.CLI.preferred_cli_env/3
  (mix 1.19.4) lib/mix/cli.ex:170: Mix.CLI.maybe_change_env_and_target/2
  (mix 1.19.4) lib/mix/cli.ex:59: Mix.CLI.proceed/2
  /opt/homebrew/bin/mix:7: (file)
  (elixir 1.19.4) src/elixir_compiler.erl:81: :elixir_compiler.dispatch/4
  (elixir 1.19.4) src/elixir_compiler.erl:56: :elixir_compiler.compile/4

    warning: unused alias Decapsulator
    │
  8 │   alias DataDiode.S2.Decapsulator
    │   ~
    │
    └─ lib/data_diode/s2/listener.ex:8:3

16:04:32.605 [info] Application logger started at :nonode@nohost
16:04:32.618 [info] Child :ttb_autostart of Supervisor :runtime_tools_sup started
Pid: #PID<0.184.0>
Start Call: :ttb_autostart.start_link()
Restart: :temporary
Shutdown: 3000
Type: :worker
16:04:32.618 [info] Application runtime_tools started at :nonode@nohost
16:04:32.618 [info] Application opentelemetry_api started at :nonode@nohost
16:04:32.619 [info] Application ctx started at :nonode@nohost
16:04:32.619 [info] Application hpack started at :nonode@nohost
16:04:32.619 [info] Application chatterbox started at :nonode@nohost
16:04:32.619 [info] Application acceptor_pool started at :nonode@nohost
16:04:32.631 [info] Child :gproc of Supervisor :gproc_sup started
Pid: #PID<0.188.0>
Start Call: :gproc.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:04:32.632 [info] Child :gproc_monitor of Supervisor :gproc_sup started
Pid: #PID<0.189.0>
Start Call: :gproc_monitor.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:04:32.633 [info] Child :gproc_bcast of Supervisor :gproc_sup started
Pid: #PID<0.190.0>
Start Call: :gproc_bcast.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:04:32.634 [info] Child :gproc_pool of Supervisor :gproc_sup started
Pid: #PID<0.191.0>
Start Call: :gproc_pool.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:04:32.634 [info] Application gproc started at :nonode@nohost
16:04:32.637 [info] Child :grpcbox_services_simple_sup of Supervisor :grpcbox_sup started
Pid: #PID<0.195.0>
Start Call: :grpcbox_services_simple_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:04:32.638 [info] Child :grpcbox_channel_sup of Supervisor :grpcbox_sup started
Pid: #PID<0.196.0>
Start Call: :grpcbox_channel_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:04:32.638 [info] Application grpcbox started at :nonode@nohost
16:04:32.638 [info] Application ssl_verify_fun started at :nonode@nohost
16:04:32.763 [info] Loading 162 CA(s) from :otp store
16:04:32.763 [info] Child :tls_certificate_check_shared_state of Supervisor :tls_certificate_check_sup started
Pid: #PID<0.200.0>
Start Call: :tls_certificate_check_shared_state.start_link()
Restart: :permanent
Shutdown: :infinity
Type: :worker
16:04:32.763 [info] Application tls_certificate_check started at :nonode@nohost
16:04:32.763 [info] Application opentelemetry_exporter started at :nonode@nohost
16:04:32.774 [info] Child :otel_span_ets of Supervisor :otel_span_sup started
Pid: #PID<0.208.0>
Start Call: :otel_span_ets.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:32.775 [info] Child :otel_span_sweeper of Supervisor :otel_span_sup started
Pid: #PID<0.209.0>
Start Call: :otel_span_sweeper.start_link(%{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:32.775 [info] Child :otel_span_sup of Supervisor :opentelemetry_sup started
Pid: #PID<0.207.0>
Start Call: :otel_span_sup.start_link(%{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:04:32.780 [info] Child :otel_resource_detector of Supervisor :opentelemetry_sup started
Pid: #PID<0.210.0>
Start Call: :otel_resource_detector.start_link(%{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:32.782 [info] Child :otel_tracer_provider_sup of Supervisor :opentelemetry_sup started
Pid: #PID<0.213.0>
Start Call: :otel_tracer_provider_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:04:32.785 [info] Child :otel_span_processor_sup of Supervisor #PID<0.214.0> (:otel_tracer_server_sup) started
Pid: #PID<0.215.0>
Start Call: :otel_span_processor_sup.start_link(:otel_span_processor_sup_global)
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:04:32.791 [info] Child :otel_tracer_server of Supervisor #PID<0.214.0> (:otel_tracer_server_sup) started
Pid: #PID<0.216.0>
Start Call: :otel_tracer_server.start_link(:global, :otel_tracer_provider_global, :otel_span_processor_sup_global, {:resource, :undefined, {:attributes, 128, 255, 0, %{"process.executable.name": "erl", "process.runtime.description": "Erlang/OTP 28 erts-16.1.2", "process.runtime.version": "16.1.2", "process.runtime.name": "BEAM", "service.name": "unknown_service:erl", "service.instance.id": 120008788082612838602273911414989972072, "telemetry.sdk.version": "1.6.0", "telemetry.sdk.language": "erlang", "telemetry.sdk.name": "opentelemetry"}}}, %{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:32.794 [debug] Child {:httpc, :"otel_exporter_otlp_<0.217.0>"} of Supervisor :httpc_profile_sup started
Pid: #PID<0.218.0>
Start Call: :httpc_manager.start_link(:"otel_exporter_otlp_<0.217.0>", :only_session_cookies, :inets)
Restart: :permanent
Shutdown: 4000
Type: :worker
16:04:32.798 [info] OTLP exporter successfully initialized
16:04:32.799 [info] Application opentelemetry started at :nonode@nohost
16:04:32.800 [info] Application jason started at :nonode@nohost
16:04:32.800 [info] Application logger_json started at :nonode@nohost
16:04:32.801 [info] Application nimble_ownership started at :nonode@nohost
16:04:32.806 [info] Child Mox of Supervisor Mox.Supervisor started
Pid: #PID<0.222.0>
Start Call: Mox.start_link_ownership()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:32.806 [info] Application mox started at :nonode@nohost
16:04:32.812 [info] Child DataDiode.Metrics of Supervisor DataDiode.Supervisor started
Pid: #PID<0.226.0>
Start Call: DataDiode.Metrics.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:32.812 [info] Child DataDiode.SystemMonitor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.227.0>
Start Call: DataDiode.SystemMonitor.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:32.813 [info] S1: Starting TCP Listener on port 0...
16:04:32.813 [info] Child DataDiode.S1.Listener of Supervisor DataDiode.Supervisor started
Pid: #PID<0.228.0>
Start Call: DataDiode.S1.Listener.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:32.814 [info] Child DataDiode.S1.HandlerSupervisor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.229.0>
Start Call: DataDiode.S1.HandlerSupervisor.start_link()
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:04:32.816 [warning] S1 Encapsulator: Invalid S2_PORT 0, using default 42001
16:04:32.816 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.230.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:32.816 [info] Child DataDiode.S1.Heartbeat of Supervisor DataDiode.Supervisor started
Pid: #PID<0.231.0>
Start Call: DataDiode.S1.Heartbeat.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:32.816 [info] Child DataDiode.S2.HeartbeatMonitor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.232.0>
Start Call: DataDiode.S2.HeartbeatMonitor.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:32.816 [info] Child DataDiode.DiskCleaner of Supervisor DataDiode.Supervisor started
Pid: #PID<0.233.0>
Start Call: DataDiode.DiskCleaner.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:32.817 [info] S2: Starting UDP Listener on port 0...
16:04:32.817 [info] Child DataDiode.S2.Listener of Supervisor DataDiode.Supervisor started
Pid: #PID<0.234.0>
Start Call: DataDiode.S2.Listener.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:32.817 [info] Child DataDiode.S2.TaskSupervisor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.235.0>
Start Call: Task.Supervisor.start_link([name: DataDiode.S2.TaskSupervisor, max_children: 200])
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:04:32.817 [info] Application data_diode started at :nonode@nohost
16:04:32.822 [info] Child ExUnit.Server of Supervisor ExUnit.Supervisor started
Pid: #PID<0.241.0>
Start Call: ExUnit.Server.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:32.822 [info] Child ExUnit.CaptureServer of Supervisor ExUnit.Supervisor started
Pid: #PID<0.242.0>
Start Call: ExUnit.CaptureServer.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:32.822 [info] Application ex_unit started at :nonode@nohost
Running ExUnit with seed: 824443, max_cases: 16

..    warning: variable "c" is unused (if the variable is not meant to be used, prefix it with an underscore)
    │
 26 │     {:ok, c} = :gen_tcp.connect({127,0,0,1}, port, [:binary, active: false])
    │           ~
    │
    └─ test/long_term_robustness_test.exs:26:11: DataDiode.LongTermRobustnessTest."test TCPHandler exhaustive branch coverage"/1

    warning: variable "pid3" is unused (if the variable is not meant to be used, prefix it with an underscore)
    │
 62 │     {:ok, pid3} = TCPHandler.start_link(s3)
    │           ~~~~
    │
    └─ test/long_term_robustness_test.exs:62:11: DataDiode.LongTermRobustnessTest."test TCPHandler exhaustive branch coverage"/1

.     warning: redefining module DataDiode.S1.EncapsulatorMock (current version defined in memory)
     │
 491 │     Module.create(name, [info | body], Macro.Env.location(__ENV__))
     │     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     │
     └─ deps/mox/lib/mox.ex:491: DataDiode.S1.EncapsulatorMock (module)

.........16:04:32.949 [error] S2: Failed to parse header: invalid_packet_size
.16:04:32.949 [info] S2: Decapsulated packet from 0.0.0.0:0. Payload size: 0 bytes.
16:04:32.949 [debug] S2: Successfully wrote 0 bytes to ./data_1766120672949_1_0.dat. (Simulated secure write)
.16:04:32.949 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 0 bytes.
16:04:32.949 [debug] S2: Successfully wrote 0 bytes to ./data_1766120672949_2_51210.dat. (Simulated secure write)
.16:04:32.949 [error] S2: Failed to parse header: invalid_packet_size
.16:04:32.949 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 9 bytes.
.16:04:32.949 [debug] S2: Successfully wrote 9 bytes to ./data_1766120672949_3_80.dat. (Simulated secure write)
.16:04:32.949 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 23 bytes.
16:04:32.949 [debug] S2: Successfully wrote 23 bytes to ./data_1766120672949_4_51210.dat. (Simulated secure write)
16:04:32.950 [error] S2: Failed to parse header: invalid_packet_size
.16:04:32.950 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 23 bytes.
16:04:32.950 [debug] S2: Successfully wrote 23 bytes to ./data_1766120672950_5_51210.dat. (Simulated secure write)
.16:04:33.004 [info] Child of Supervisor :inet_gethost_native_sup started
Pid: #PID<0.402.0>
Start Call: :inet_gethost_native.init([])
16:04:33.004 [debug] Child :inet_gethost_native_sup of Supervisor :kernel_safe_sup started
Pid: #PID<0.401.0>
Start Call: :inet_gethost_native.start_link()
Restart: :temporary
Shutdown: 1000
Type: :worker
16:04:33.015 [info] S1: Forwarded 11 bytes.
.16:04:33.026 [debug] S1: TCPHandler received unexpected message: :unknown
.16:04:33.026 [info] S1: Connection closed by 1.2.3.4:80
.16:04:33.026 [debug] S1: TCPHandler received unexpected message: :accept_loop
..16:04:33.027 [warning] S1: Dropping oversized packet (1048577 bytes) from 1.2.3.4
16:04:33.028 [error] S1: TCP error for 1.2.3.4: :econnreset
.......16:04:33.033 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.230.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:33.033 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.424.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:33.044 [warning] S1 Encapsulator: Invalid IP invalid, dropping packet.
.16:04:33.145 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.424.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:33.145 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.426.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:04:33.156 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.426.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:33.156 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.428.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:04:33.168 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.428.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:33.168 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.430.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:04:33.179 [info] S1: Starting TCP Listener on port 0...
.16:04:33.180 [info] S1: Starting TCP Listener on port 0...
16:04:33.681 [info] S1: New connection accepted.
...16:04:34.683 [info] S1: Starting TCP Listener on port 0...
16:04:35.184 [error] S1: Listener socket fatal error: :closed. Terminating.
16:04:35.184 [error] GenServer :s1_flapping_test_unique terminating
** (stop) :closed
Last message: :accept_loop
State: #Port<0.48>
16:04:35.185 [error] Process :s1_flapping_test_unique (#PID<0.443.0>) terminating
** (exit) :closed
    (stdlib 7.1) gen_server.erl:2562: :gen_server.handle_common_reply/5
    (stdlib 7.1) proc_lib.erl:333: :proc_lib.init_p_do_apply/3
Initial Call: DataDiode.S1.Listener.init/1
Ancestors: [#PID<0.442.0>]
Message Queue Length: 0
Messages: []
Links: []
Dictionary: []
Trapping Exits: false
Status: :running
Heap Size: 1598
Stack Size: 29
Reductions: 2965
..16:04:35.186 [error] S1: Listener socket fatal error: :closed. Terminating.
.16:04:35.186 [warning] S1: Invalid LISTEN_IP invalid, using all interfaces.
...16:04:35.193 [debug] SystemMonitor: Received unexpected message: :unexp
16:04:35.195 [debug] S1: TCPHandler received unexpected message: :unexp
16:04:35.196 [info] S1: Starting TCP Listener on port 0...
16:04:35.196 [debug] S1: Listener received unexpected message: :unexp
16:04:35.819 [info] S2: Starting UDP Listener on port 0...
16:04:35.819 [warning] S2: Received unexpected message: :unexp
16:04:35.819 [error] S2: UDP Listener socket closed unexpectedly. Terminating.
16:04:35.828 [info] DiskCleaner: Low disk space detected on . (< 15%). Starting autonomous cleanup...
16:04:35.828 [warning] DiskCleaner: Simulation - would delete oldest .dat files in . now.
16:04:35.833 [info] S2: Decapsulated packet from 127.0.0.1:20480. Payload size: 7 bytes.
16:04:35.833 [debug] S2: Successfully wrote 7 bytes to /tmp/diode_test/data_1766120675833_8_20480.dat. (Simulated secure write)
16:04:35.833 [info] S2: Decapsulated packet from 127.0.0.1:0. Payload size: 9 bytes.
16:04:35.835 [debug] S1: Generating end-to-end heartbeat.
16:04:35.835 [warning] S1 Heartbeat: Received unexpected message: :unexp
16:04:35.835 [error] S2: Critical Failure! Channel heartbeat missing for > 6 minutes. The diode path may be obstructed.
16:04:35.835 [warning] S2 HeartbeatMonitor: Received unexpected message: :unexp
.16:04:35.836 [warning] S2: Invalid LISTEN_IP_S2 invalid, falling back to all interfaces.
..16:04:35.837 [info] S2: Starting UDP Listener on port 0...
16:04:35.837 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.837 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675837_9_80.dat. (Simulated secure write)
16:04:35.837 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.837 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675837_10_80.dat. (Simulated secure write)
16:04:35.837 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.837 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675837_11_80.dat. (Simulated secure write)
16:04:35.837 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.838 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675837_12_80.dat. (Simulated secure write)
16:04:35.838 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.838 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675838_13_80.dat. (Simulated secure write)
16:04:35.838 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.838 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675838_14_80.dat. (Simulated secure write)
16:04:35.838 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.838 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675838_15_80.dat. (Simulated secure write)
16:04:35.838 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.838 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675838_16_80.dat. (Simulated secure write)
16:04:35.838 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.838 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675838_17_80.dat. (Simulated secure write)
16:04:35.838 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.838 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675838_18_80.dat. (Simulated secure write)
16:04:35.838 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.838 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675838_19_80.dat. (Simulated secure write)
16:04:35.838 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.838 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675838_20_80.dat. (Simulated secure write)
16:04:35.839 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.839 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675839_21_80.dat. (Simulated secure write)
16:04:35.839 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.839 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675839_22_80.dat. (Simulated secure write)
16:04:35.839 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.839 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675839_23_80.dat. (Simulated secure write)
16:04:35.839 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.839 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675839_24_80.dat. (Simulated secure write)
16:04:35.839 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.839 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675839_25_80.dat. (Simulated secure write)
16:04:35.839 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.839 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675839_26_80.dat. (Simulated secure write)
16:04:35.839 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.839 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675839_27_80.dat. (Simulated secure write)
16:04:35.839 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.839 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675839_28_80.dat. (Simulated secure write)
16:04:35.840 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.840 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675840_29_80.dat. (Simulated secure write)
16:04:35.840 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.840 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675840_30_80.dat. (Simulated secure write)
16:04:35.840 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.840 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675840_31_80.dat. (Simulated secure write)
16:04:35.840 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.840 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675840_32_80.dat. (Simulated secure write)
16:04:35.840 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.840 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675840_33_80.dat. (Simulated secure write)
16:04:35.840 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.840 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675840_34_80.dat. (Simulated secure write)
16:04:35.840 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.840 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675840_35_80.dat. (Simulated secure write)
16:04:35.840 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.840 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675840_36_80.dat. (Simulated secure write)
16:04:35.840 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.840 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675840_37_80.dat. (Simulated secure write)
16:04:35.841 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.841 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675841_38_80.dat. (Simulated secure write)
16:04:35.841 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.841 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675841_39_80.dat. (Simulated secure write)
16:04:35.841 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.841 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675841_40_80.dat. (Simulated secure write)
16:04:35.841 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.841 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675841_41_80.dat. (Simulated secure write)
16:04:35.841 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.841 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675841_42_80.dat. (Simulated secure write)
16:04:35.841 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.841 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675841_43_80.dat. (Simulated secure write)
16:04:35.841 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.841 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675841_44_80.dat. (Simulated secure write)
16:04:35.841 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.841 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675841_45_80.dat. (Simulated secure write)
16:04:35.841 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.841 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675841_46_80.dat. (Simulated secure write)
16:04:35.842 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.842 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675842_47_80.dat. (Simulated secure write)
16:04:35.842 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.842 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675842_48_80.dat. (Simulated secure write)
16:04:35.842 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.842 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675842_49_80.dat. (Simulated secure write)
16:04:35.842 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.842 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675842_50_80.dat. (Simulated secure write)
16:04:35.842 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.842 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675842_51_80.dat. (Simulated secure write)
16:04:35.842 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.842 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675842_52_80.dat. (Simulated secure write)
16:04:35.842 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.842 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675842_53_80.dat. (Simulated secure write)
16:04:35.842 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.842 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675842_54_80.dat. (Simulated secure write)
16:04:35.842 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.842 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675842_55_80.dat. (Simulated secure write)
16:04:35.842 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.842 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675842_56_80.dat. (Simulated secure write)
16:04:35.843 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.843 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675843_57_80.dat. (Simulated secure write)
16:04:35.843 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.843 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675843_58_80.dat. (Simulated secure write)
16:04:35.843 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.843 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675843_59_80.dat. (Simulated secure write)
16:04:35.843 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.843 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675843_60_80.dat. (Simulated secure write)
16:04:35.843 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.843 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675843_61_80.dat. (Simulated secure write)
16:04:35.843 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.843 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675843_62_80.dat. (Simulated secure write)
16:04:35.843 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.843 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675843_63_80.dat. (Simulated secure write)
16:04:35.843 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.843 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675843_64_80.dat. (Simulated secure write)
16:04:35.843 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.843 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675843_65_80.dat. (Simulated secure write)
16:04:35.844 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.844 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675844_66_80.dat. (Simulated secure write)
16:04:35.844 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.844 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675844_67_80.dat. (Simulated secure write)
16:04:35.844 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.844 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675844_68_80.dat. (Simulated secure write)
16:04:35.844 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.844 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675844_69_80.dat. (Simulated secure write)
16:04:35.844 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.844 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675844_70_80.dat. (Simulated secure write)
16:04:35.844 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.844 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675844_71_80.dat. (Simulated secure write)
16:04:35.844 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.844 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675844_72_80.dat. (Simulated secure write)
16:04:35.844 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.844 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675844_73_80.dat. (Simulated secure write)
16:04:35.844 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.845 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675845_74_80.dat. (Simulated secure write)
16:04:35.845 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.845 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675845_75_80.dat. (Simulated secure write)
16:04:35.845 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.845 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675845_76_80.dat. (Simulated secure write)
16:04:35.845 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.845 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.845 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675845_77_80.dat. (Simulated secure write)
16:04:35.845 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675845_78_80.dat. (Simulated secure write)
16:04:35.845 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.845 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675845_79_80.dat. (Simulated secure write)
16:04:35.845 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.845 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675845_80_80.dat. (Simulated secure write)
16:04:35.845 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.845 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675845_81_80.dat. (Simulated secure write)
16:04:35.845 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.845 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675845_82_80.dat. (Simulated secure write)
16:04:35.845 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.846 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675845_83_80.dat. (Simulated secure write)
16:04:35.846 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.846 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675846_84_80.dat. (Simulated secure write)
16:04:35.846 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.846 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675846_85_80.dat. (Simulated secure write)
16:04:35.846 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.846 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675846_86_80.dat. (Simulated secure write)
16:04:35.846 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.846 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675846_87_80.dat. (Simulated secure write)
16:04:35.846 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.846 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675846_88_80.dat. (Simulated secure write)
16:04:35.846 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.846 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675846_89_80.dat. (Simulated secure write)
16:04:35.846 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.846 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675846_90_80.dat. (Simulated secure write)
16:04:35.846 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.846 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675846_91_80.dat. (Simulated secure write)
16:04:35.846 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.846 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675846_92_80.dat. (Simulated secure write)
16:04:35.846 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.846 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675846_93_80.dat. (Simulated secure write)
16:04:35.847 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.847 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675847_94_80.dat. (Simulated secure write)
16:04:35.847 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.847 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675847_95_80.dat. (Simulated secure write)
16:04:35.847 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.847 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675847_96_80.dat. (Simulated secure write)
16:04:35.847 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.847 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675847_97_80.dat. (Simulated secure write)
16:04:35.847 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.847 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675847_98_80.dat. (Simulated secure write)
16:04:35.847 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.847 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675847_99_80.dat. (Simulated secure write)
16:04:35.847 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.847 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675847_100_80.dat. (Simulated secure write)
16:04:35.847 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.847 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675847_101_80.dat. (Simulated secure write)
16:04:35.847 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.847 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675847_102_80.dat. (Simulated secure write)
16:04:35.847 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.847 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675847_103_80.dat. (Simulated secure write)
16:04:35.848 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.848 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675848_104_80.dat. (Simulated secure write)
16:04:35.848 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.848 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675848_105_80.dat. (Simulated secure write)
16:04:35.848 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.848 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675848_106_80.dat. (Simulated secure write)
16:04:35.848 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.848 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675848_107_80.dat. (Simulated secure write)
16:04:35.848 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:35.848 [debug] S2: Successfully wrote 7 bytes to ./data_1766120675848_108_80.dat. (Simulated secure write)
.16:04:35.949 [info] S2: Starting UDP Listener on port 0...
16:04:35.949 [info] S2: Decapsulated packet from 1.2.3.4:80. Payload size: 5 bytes.
16:04:35.949 [debug] S2: Successfully wrote 5 bytes to ./data_1766120675949_109_80.dat. (Simulated secure write)
.16:04:35.960 [info] S2: Starting UDP Listener on port 0...
...16:04:35.960 [error] S2: UDP Listener socket closed unexpectedly. Terminating.
.16:04:35.960 [info] S2: Starting UDP Listener on port 0...
...16:04:35.982 [info] S1: Starting TCP Listener on port 8092...
16:04:35.983 [info] S1: New connection accepted.
16:04:35.983 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.68>}
16:04:35.983 [info] S1: New connection accepted.
16:04:35.983 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.70>}
16:04:35.983 [info] S1: New connection accepted.
16:04:35.983 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.72>}
16:04:35.984 [info] S1: New connection accepted.
16:04:35.984 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.74>}
16:04:35.984 [info] S1: New connection accepted.
16:04:35.984 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.76>}
16:04:35.984 [info] S1: New connection accepted.
16:04:35.984 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.78>}
16:04:35.984 [info] S1: New connection accepted.
16:04:35.984 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.80>}
16:04:35.985 [info] S1: New connection accepted.
16:04:35.985 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.82>}
16:04:35.985 [info] S1: New connection accepted.
16:04:35.985 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.84>}
16:04:35.985 [info] S1: New connection accepted.
16:04:35.985 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.86>}
16:04:35.985 [info] S1: New connection accepted.
16:04:35.985 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.88>}
16:04:35.985 [info] S1: New connection accepted.
16:04:35.986 [info] S1: New connection accepted.
16:04:35.986 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.90>}
16:04:35.986 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.92>}
16:04:35.986 [info] S1: New connection accepted.
16:04:35.986 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.94>}
16:04:35.986 [info] S1: New connection accepted.
16:04:35.986 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.96>}
16:04:35.986 [info] S1: New connection accepted.
16:04:35.986 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.98>}
16:04:35.986 [info] S1: New connection accepted.
16:04:35.987 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.100>}
16:04:35.987 [info] S1: New connection accepted.
16:04:35.987 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.102>}
16:04:35.987 [info] S1: New connection accepted.
16:04:35.987 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.104>}
16:04:35.987 [info] S1: New connection accepted.
16:04:35.987 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.106>}
16:04:35.987 [info] S1: New connection accepted.
16:04:35.987 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.108>}
16:04:35.987 [info] S1: New connection accepted.
16:04:35.988 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.110>}
16:04:35.988 [info] S1: New connection accepted.
16:04:35.988 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.112>}
16:04:35.988 [info] S1: New connection accepted.
16:04:35.988 [info] S1: New connection accepted.
16:04:35.988 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.114>}
16:04:35.988 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.116>}
16:04:35.988 [info] S1: New connection accepted.
16:04:35.988 [info] S1: New connection accepted.
16:04:35.989 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.118>}
16:04:35.989 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.120>}
16:04:35.989 [info] S1: New connection accepted.
16:04:35.989 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.122>}
16:04:35.989 [info] S1: New connection accepted.
16:04:35.989 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.124>}
16:04:35.989 [info] S1: New connection accepted.
16:04:35.989 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.126>}
16:04:35.989 [info] S1: New connection accepted.
16:04:35.989 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.128>}
16:04:35.989 [info] S1: New connection accepted.
16:04:35.989 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.130>}
16:04:35.990 [info] S1: New connection accepted.
16:04:35.990 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.132>}
16:04:35.990 [info] S1: New connection accepted.
16:04:35.990 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.134>}
16:04:35.990 [info] S1: New connection accepted.
16:04:35.990 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.136>}
16:04:35.990 [info] S1: New connection accepted.
16:04:35.990 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.138>}
16:04:35.990 [info] S1: New connection accepted.
16:04:35.990 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.140>}
16:04:35.991 [info] S1: New connection accepted.
16:04:35.991 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.142>}
16:04:35.991 [info] S1: New connection accepted.
16:04:35.991 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.144>}
16:04:35.991 [info] S1: New connection accepted.
16:04:35.991 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.146>}
16:04:35.991 [info] S1: New connection accepted.
16:04:35.991 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.148>}
16:04:35.991 [info] S1: New connection accepted.
16:04:35.991 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.150>}
16:04:35.991 [info] S1: New connection accepted.
16:04:35.992 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.152>}
16:04:35.992 [info] S1: New connection accepted.
16:04:35.992 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.154>}
16:04:35.992 [info] S1: New connection accepted.
16:04:35.992 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.156>}
16:04:35.992 [info] S1: New connection accepted.
16:04:35.992 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.158>}
16:04:35.992 [info] S1: New connection accepted.
16:04:35.992 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.160>}
16:04:35.992 [info] S1: New connection accepted.
16:04:35.992 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.162>}
16:04:35.993 [info] S1: New connection accepted.
16:04:35.993 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.164>}
16:04:35.993 [info] S1: New connection accepted.
16:04:35.993 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.166>}
.....16:04:36.825 [info] S1: New connection accepted.
16:04:36.825 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.172>}
16:04:36.825 [info] S1: New connection accepted.
16:04:36.825 [info] S1: New connection accepted.
16:04:36.825 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.175>}
16:04:36.826 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.176>}
16:04:36.826 [info] S1: New connection accepted.
16:04:36.826 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.178>}
16:04:36.826 [info] S1: New connection accepted.
16:04:36.826 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.180>}
.16:04:37.078 [debug] S1: TCPHandler received unexpected message: :accept_loop
..
Finished in 4.2 seconds (0.1s async, 4.0s sync)
1 doctest, 65 tests, 0 failures
Run 3
warning: setting :preferred_cli_env in your mix.exs "def project" is deprecated, set it inside "def cli" instead:

    def cli do
      [preferred_envs: [release: :prod, test: :test]]
    end

  (mix 1.19.4) lib/mix/cli.ex:187: Mix.CLI.preferred_cli_env/3
  (mix 1.19.4) lib/mix/cli.ex:170: Mix.CLI.maybe_change_env_and_target/2
  (mix 1.19.4) lib/mix/cli.ex:59: Mix.CLI.proceed/2
  /opt/homebrew/bin/mix:7: (file)
  (elixir 1.19.4) src/elixir_compiler.erl:81: :elixir_compiler.dispatch/4
  (elixir 1.19.4) src/elixir_compiler.erl:56: :elixir_compiler.compile/4

    warning: unused alias Decapsulator
    │
  8 │   alias DataDiode.S2.Decapsulator
    │   ~
    │
    └─ lib/data_diode/s2/listener.ex:8:3

16:04:37.902 [info] Application logger started at :nonode@nohost
16:04:37.907 [info] Child :ttb_autostart of Supervisor :runtime_tools_sup started
Pid: #PID<0.184.0>
Start Call: :ttb_autostart.start_link()
Restart: :temporary
Shutdown: 3000
Type: :worker
16:04:37.907 [info] Application runtime_tools started at :nonode@nohost
16:04:37.907 [info] Application opentelemetry_api started at :nonode@nohost
16:04:37.907 [info] Application ctx started at :nonode@nohost
16:04:37.907 [info] Application hpack started at :nonode@nohost
16:04:37.907 [info] Application chatterbox started at :nonode@nohost
16:04:37.907 [info] Application acceptor_pool started at :nonode@nohost
16:04:37.914 [info] Child :gproc of Supervisor :gproc_sup started
Pid: #PID<0.188.0>
Start Call: :gproc.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:04:37.915 [info] Child :gproc_monitor of Supervisor :gproc_sup started
Pid: #PID<0.189.0>
Start Call: :gproc_monitor.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:04:37.915 [info] Child :gproc_bcast of Supervisor :gproc_sup started
Pid: #PID<0.190.0>
Start Call: :gproc_bcast.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:04:37.917 [info] Child :gproc_pool of Supervisor :gproc_sup started
Pid: #PID<0.191.0>
Start Call: :gproc_pool.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:04:37.917 [info] Application gproc started at :nonode@nohost
16:04:37.919 [info] Child :grpcbox_services_simple_sup of Supervisor :grpcbox_sup started
Pid: #PID<0.195.0>
Start Call: :grpcbox_services_simple_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:04:37.920 [info] Child :grpcbox_channel_sup of Supervisor :grpcbox_sup started
Pid: #PID<0.196.0>
Start Call: :grpcbox_channel_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:04:37.920 [info] Application grpcbox started at :nonode@nohost
16:04:37.920 [info] Application ssl_verify_fun started at :nonode@nohost
16:04:37.985 [info] Loading 162 CA(s) from :otp store
16:04:37.986 [info] Child :tls_certificate_check_shared_state of Supervisor :tls_certificate_check_sup started
Pid: #PID<0.200.0>
Start Call: :tls_certificate_check_shared_state.start_link()
Restart: :permanent
Shutdown: :infinity
Type: :worker
16:04:37.986 [info] Application tls_certificate_check started at :nonode@nohost
16:04:37.986 [info] Application opentelemetry_exporter started at :nonode@nohost
16:04:37.994 [info] Child :otel_span_ets of Supervisor :otel_span_sup started
Pid: #PID<0.208.0>
Start Call: :otel_span_ets.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:37.995 [info] Child :otel_span_sweeper of Supervisor :otel_span_sup started
Pid: #PID<0.209.0>
Start Call: :otel_span_sweeper.start_link(%{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:37.995 [info] Child :otel_span_sup of Supervisor :opentelemetry_sup started
Pid: #PID<0.207.0>
Start Call: :otel_span_sup.start_link(%{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:04:37.997 [info] Child :otel_resource_detector of Supervisor :opentelemetry_sup started
Pid: #PID<0.210.0>
Start Call: :otel_resource_detector.start_link(%{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:37.998 [info] Child :otel_tracer_provider_sup of Supervisor :opentelemetry_sup started
Pid: #PID<0.213.0>
Start Call: :otel_tracer_provider_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:04:38.001 [info] Child :otel_span_processor_sup of Supervisor #PID<0.214.0> (:otel_tracer_server_sup) started
Pid: #PID<0.215.0>
Start Call: :otel_span_processor_sup.start_link(:otel_span_processor_sup_global)
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:04:38.007 [info] Child :otel_tracer_server of Supervisor #PID<0.214.0> (:otel_tracer_server_sup) started
Pid: #PID<0.216.0>
Start Call: :otel_tracer_server.start_link(:global, :otel_tracer_provider_global, :otel_span_processor_sup_global, {:resource, :undefined, {:attributes, 128, 255, 0, %{"process.executable.name": "erl", "process.runtime.description": "Erlang/OTP 28 erts-16.1.2", "process.runtime.version": "16.1.2", "process.runtime.name": "BEAM", "service.name": "unknown_service:erl", "service.instance.id": 122312419044242870640965683851849917834, "telemetry.sdk.version": "1.6.0", "telemetry.sdk.language": "erlang", "telemetry.sdk.name": "opentelemetry"}}}, %{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:38.009 [debug] Child {:httpc, :"otel_exporter_otlp_<0.217.0>"} of Supervisor :httpc_profile_sup started
Pid: #PID<0.218.0>
Start Call: :httpc_manager.start_link(:"otel_exporter_otlp_<0.217.0>", :only_session_cookies, :inets)
Restart: :permanent
Shutdown: 4000
Type: :worker
16:04:38.013 [info] OTLP exporter successfully initialized
16:04:38.014 [info] Application opentelemetry started at :nonode@nohost
16:04:38.016 [info] Application jason started at :nonode@nohost
16:04:38.016 [info] Application logger_json started at :nonode@nohost
16:04:38.016 [info] Application nimble_ownership started at :nonode@nohost
16:04:38.019 [info] Child Mox of Supervisor Mox.Supervisor started
Pid: #PID<0.222.0>
Start Call: Mox.start_link_ownership()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:38.019 [info] Application mox started at :nonode@nohost
16:04:38.023 [info] Child DataDiode.Metrics of Supervisor DataDiode.Supervisor started
Pid: #PID<0.226.0>
Start Call: DataDiode.Metrics.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:38.023 [info] Child DataDiode.SystemMonitor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.227.0>
Start Call: DataDiode.SystemMonitor.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:38.024 [info] S1: Starting TCP Listener on port 0...
16:04:38.024 [info] Child DataDiode.S1.Listener of Supervisor DataDiode.Supervisor started
Pid: #PID<0.228.0>
Start Call: DataDiode.S1.Listener.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:38.026 [info] Child DataDiode.S1.HandlerSupervisor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.229.0>
Start Call: DataDiode.S1.HandlerSupervisor.start_link()
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:04:38.027 [warning] S1 Encapsulator: Invalid S2_PORT 0, using default 42001
16:04:38.027 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.230.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:38.027 [info] Child DataDiode.S1.Heartbeat of Supervisor DataDiode.Supervisor started
Pid: #PID<0.231.0>
Start Call: DataDiode.S1.Heartbeat.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:38.027 [info] Child DataDiode.S2.HeartbeatMonitor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.232.0>
Start Call: DataDiode.S2.HeartbeatMonitor.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:38.027 [info] Child DataDiode.DiskCleaner of Supervisor DataDiode.Supervisor started
Pid: #PID<0.233.0>
Start Call: DataDiode.DiskCleaner.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:38.028 [info] S2: Starting UDP Listener on port 0...
16:04:38.028 [info] Child DataDiode.S2.Listener of Supervisor DataDiode.Supervisor started
Pid: #PID<0.234.0>
Start Call: DataDiode.S2.Listener.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:38.028 [info] Child DataDiode.S2.TaskSupervisor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.235.0>
Start Call: Task.Supervisor.start_link([name: DataDiode.S2.TaskSupervisor, max_children: 200])
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:04:38.028 [info] Application data_diode started at :nonode@nohost
16:04:38.035 [info] Child ExUnit.Server of Supervisor ExUnit.Supervisor started
Pid: #PID<0.241.0>
Start Call: ExUnit.Server.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:38.035 [info] Child ExUnit.CaptureServer of Supervisor ExUnit.Supervisor started
Pid: #PID<0.242.0>
Start Call: ExUnit.CaptureServer.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:38.035 [info] Application ex_unit started at :nonode@nohost
Running ExUnit with seed: 37215, max_cases: 16

    warning: variable "c" is unused (if the variable is not meant to be used, prefix it with an underscore)
    │
 26 │     {:ok, c} = :gen_tcp.connect({127,0,0,1}, port, [:binary, active: false])
    │           ~
    │
    └─ test/long_term_robustness_test.exs:26:11: DataDiode.LongTermRobustnessTest."test TCPHandler exhaustive branch coverage"/1

    warning: variable "pid3" is unused (if the variable is not meant to be used, prefix it with an underscore)
    │
 62 │     {:ok, pid3} = TCPHandler.start_link(s3)
    │           ~~~~
    │
    └─ test/long_term_robustness_test.exs:62:11: DataDiode.LongTermRobustnessTest."test TCPHandler exhaustive branch coverage"/1

...     warning: redefining module DataDiode.S1.EncapsulatorMock (current version defined in memory)
     │
 491 │     Module.create(name, [info | body], Macro.Env.location(__ENV__))
     │     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     │
     └─ deps/mox/lib/mox.ex:491: DataDiode.S1.EncapsulatorMock (module)

...16:04:38.137 [info] DiskCleaner: Low disk space detected on . (< 15%). Starting autonomous cleanup...
16:04:38.137 [warning] DiskCleaner: Simulation - would delete oldest .dat files in . now.
.......16:04:38.152 [error] S2: Failed to parse header: invalid_packet_size
16:04:38.152 [error] S2: Failed to parse header: invalid_packet_size
.16:04:38.152 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 0 bytes.
.16:04:38.152 [debug] S2: Successfully wrote 0 bytes to ./data_1766120678152_1_51210.dat. (Simulated secure write)
.16:04:38.153 [info] S2: Decapsulated packet from 0.0.0.0:0. Payload size: 0 bytes.
16:04:38.153 [debug] S2: Successfully wrote 0 bytes to ./data_1766120678153_2_0.dat. (Simulated secure write)
.16:04:38.153 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 23 bytes.
.16:04:38.153 [debug] S2: Successfully wrote 23 bytes to ./data_1766120678153_3_51210.dat. (Simulated secure write)
.16:04:38.153 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 9 bytes.
.16:04:38.153 [debug] S2: Successfully wrote 9 bytes to ./data_1766120678153_4_80.dat. (Simulated secure write)
16:04:38.153 [error] S2: Failed to parse header: invalid_packet_size
16:04:38.153 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 23 bytes.
16:04:38.153 [debug] S2: Successfully wrote 23 bytes to ./data_1766120678153_5_51210.dat. (Simulated secure write)
16:04:38.177 [info] Child of Supervisor :inet_gethost_native_sup started
Pid: #PID<0.400.0>
Start Call: :inet_gethost_native.init([])
16:04:38.177 [debug] Child :inet_gethost_native_sup of Supervisor :kernel_safe_sup started
Pid: #PID<0.399.0>
Start Call: :inet_gethost_native.start_link()
Restart: :temporary
Shutdown: 1000
Type: :worker
16:04:38.184 [warning] S1: Dropping oversized packet (1048577 bytes) from 1.2.3.4
.16:04:38.184 [info] S1: Forwarded 11 bytes.
.16:04:38.195 [info] S1: Connection closed by 1.2.3.4:80
.16:04:38.195 [debug] S1: TCPHandler received unexpected message: :unknown
.16:04:38.195 [error] S1: TCP error for 1.2.3.4: :econnreset
.16:04:38.195 [debug] S1: TCPHandler received unexpected message: :accept_loop
...16:04:38.196 [info] S1: Starting TCP Listener on port 8092...
16:04:38.196 [info] S1: New connection accepted.
16:04:38.199 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.37>}
16:04:38.199 [info] S1: New connection accepted.
16:04:38.199 [info] S1: New connection accepted.
16:04:38.199 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.44>}
16:04:38.199 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.45>}
16:04:38.199 [info] S1: New connection accepted.
16:04:38.199 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.46>}
16:04:38.200 [info] S1: New connection accepted.
16:04:38.200 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.47>}
16:04:38.200 [info] S1: New connection accepted.
16:04:38.200 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.48>}
16:04:38.236 [info] S1: New connection accepted.
16:04:38.236 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.49>}
16:04:38.236 [info] S1: New connection accepted.
16:04:38.236 [info] S1: New connection accepted.
16:04:38.236 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.51>}
16:04:38.236 [info] S1: New connection accepted.
16:04:38.237 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.53>}
16:04:38.237 [info] S1: New connection accepted.
16:04:38.237 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.55>}
16:04:38.237 [info] S1: New connection accepted.
16:04:38.237 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.57>}
16:04:38.237 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.59>}
16:04:38.237 [info] S1: New connection accepted.
16:04:38.237 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.61>}
16:04:38.237 [info] S1: New connection accepted.
16:04:38.237 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.63>}
16:04:38.237 [info] S1: New connection accepted.
16:04:38.237 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.65>}
16:04:38.237 [info] S1: New connection accepted.
16:04:38.237 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.67>}
16:04:38.237 [info] S1: New connection accepted.
16:04:38.238 [info] S1: New connection accepted.
16:04:38.238 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.69>}
16:04:38.238 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.71>}
16:04:38.238 [info] S1: New connection accepted.
16:04:38.238 [info] S1: New connection accepted.
16:04:38.238 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.73>}
16:04:38.238 [info] S1: New connection accepted.
16:04:38.238 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.75>}
16:04:38.238 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.77>}
16:04:38.238 [info] S1: New connection accepted.
16:04:38.238 [info] S1: New connection accepted.
16:04:38.238 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.79>}
16:04:38.238 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.81>}
16:04:38.238 [info] S1: New connection accepted.
16:04:38.238 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.83>}
16:04:38.238 [info] S1: New connection accepted.
16:04:38.238 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.85>}
16:04:38.238 [info] S1: New connection accepted.
16:04:38.239 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.87>}
16:04:38.239 [info] S1: New connection accepted.
16:04:38.239 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.89>}
16:04:38.239 [info] S1: New connection accepted.
16:04:38.239 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.91>}
16:04:38.239 [info] S1: New connection accepted.
16:04:38.239 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.93>}
16:04:38.239 [info] S1: New connection accepted.
16:04:38.239 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.95>}
16:04:38.239 [info] S1: New connection accepted.
16:04:38.239 [info] S1: New connection accepted.
16:04:38.239 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.97>}
16:04:38.239 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.99>}
16:04:38.239 [info] S1: New connection accepted.
16:04:38.239 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.101>}
16:04:38.240 [info] S1: New connection accepted.
16:04:38.240 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.103>}
16:04:38.240 [info] S1: New connection accepted.
16:04:38.240 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.105>}
16:04:38.240 [info] S1: New connection accepted.
16:04:38.240 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.107>}
16:04:38.240 [info] S1: New connection accepted.
16:04:38.240 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.109>}
16:04:38.240 [info] S1: New connection accepted.
16:04:38.240 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.111>}
16:04:38.240 [info] S1: New connection accepted.
16:04:38.240 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.113>}
16:04:38.240 [info] S1: New connection accepted.
16:04:38.240 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.115>}
16:04:38.240 [info] S1: New connection accepted.
16:04:38.240 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.117>}
16:04:38.241 [info] S1: New connection accepted.
16:04:38.241 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.119>}
16:04:38.241 [info] S1: New connection accepted.
16:04:38.241 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.121>}
16:04:38.241 [info] S1: New connection accepted.
16:04:38.241 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.123>}
16:04:38.241 [info] S1: New connection accepted.
16:04:38.241 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.125>}
16:04:38.241 [info] S1: New connection accepted.
16:04:38.241 [info] S1: New connection accepted.
16:04:38.241 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.127>}
16:04:38.241 [info] S1: New connection accepted.
16:04:38.241 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.129>}
16:04:38.241 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.131>}
16:04:38.241 [info] S1: New connection accepted.
16:04:38.241 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.133>}
16:04:38.241 [info] S1: New connection accepted.
16:04:38.742 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.135>}
........16:04:38.797 [warning] S2: Invalid LISTEN_IP_S2 invalid, falling back to all interfaces.
.16:04:38.798 [info] S2: Starting UDP Listener on port 0...
16:04:38.798 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.798 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678798_57_80.dat. (Simulated secure write)
16:04:38.798 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.799 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678798_58_80.dat. (Simulated secure write)
16:04:38.799 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.799 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678799_59_80.dat. (Simulated secure write)
16:04:38.799 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.799 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678799_60_80.dat. (Simulated secure write)
16:04:38.799 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.799 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678799_61_80.dat. (Simulated secure write)
16:04:38.799 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.799 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678799_62_80.dat. (Simulated secure write)
16:04:38.799 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.799 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678799_63_80.dat. (Simulated secure write)
16:04:38.799 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.799 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678799_64_80.dat. (Simulated secure write)
16:04:38.799 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.799 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678799_65_80.dat. (Simulated secure write)
16:04:38.800 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.800 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678800_66_80.dat. (Simulated secure write)
16:04:38.800 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.800 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678800_67_80.dat. (Simulated secure write)
16:04:38.800 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.800 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.800 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678800_68_80.dat. (Simulated secure write)
16:04:38.800 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678800_69_80.dat. (Simulated secure write)
16:04:38.800 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.800 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678800_70_80.dat. (Simulated secure write)
16:04:38.800 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.800 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678800_71_80.dat. (Simulated secure write)
16:04:38.800 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.800 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678800_72_80.dat. (Simulated secure write)
16:04:38.800 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.800 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678800_73_80.dat. (Simulated secure write)
16:04:38.800 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.800 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678800_74_80.dat. (Simulated secure write)
16:04:38.800 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.801 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678800_75_80.dat. (Simulated secure write)
16:04:38.801 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.801 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678801_76_80.dat. (Simulated secure write)
16:04:38.801 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.801 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678801_77_80.dat. (Simulated secure write)
16:04:38.801 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.801 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678801_78_80.dat. (Simulated secure write)
16:04:38.801 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.801 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678801_79_80.dat. (Simulated secure write)
16:04:38.801 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.801 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678801_80_80.dat. (Simulated secure write)
16:04:38.801 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.801 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678801_81_80.dat. (Simulated secure write)
16:04:38.801 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.801 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678801_82_80.dat. (Simulated secure write)
16:04:38.801 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.801 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678801_83_80.dat. (Simulated secure write)
16:04:38.801 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.802 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678802_84_80.dat. (Simulated secure write)
16:04:38.802 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.802 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678802_85_80.dat. (Simulated secure write)
16:04:38.802 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.802 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678802_86_80.dat. (Simulated secure write)
16:04:38.802 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.802 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678802_87_80.dat. (Simulated secure write)
16:04:38.802 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.802 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678802_88_80.dat. (Simulated secure write)
16:04:38.802 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.802 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678802_89_80.dat. (Simulated secure write)
16:04:38.802 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.802 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678802_90_80.dat. (Simulated secure write)
16:04:38.802 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.802 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678802_91_80.dat. (Simulated secure write)
16:04:38.802 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.802 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678802_92_80.dat. (Simulated secure write)
16:04:38.802 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.802 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678802_93_80.dat. (Simulated secure write)
16:04:38.803 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.803 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678803_94_80.dat. (Simulated secure write)
16:04:38.803 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.803 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678803_95_80.dat. (Simulated secure write)
16:04:38.803 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.803 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678803_96_80.dat. (Simulated secure write)
16:04:38.803 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.803 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678803_97_80.dat. (Simulated secure write)
16:04:38.803 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.803 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678803_98_80.dat. (Simulated secure write)
16:04:38.803 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.803 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678803_99_80.dat. (Simulated secure write)
16:04:38.803 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.803 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678803_100_80.dat. (Simulated secure write)
16:04:38.803 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.803 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678803_101_80.dat. (Simulated secure write)
16:04:38.803 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.803 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678803_102_80.dat. (Simulated secure write)
16:04:38.804 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.804 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678804_103_80.dat. (Simulated secure write)
16:04:38.804 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.804 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678804_104_80.dat. (Simulated secure write)
16:04:38.804 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.804 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678804_105_80.dat. (Simulated secure write)
16:04:38.804 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.804 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678804_106_80.dat. (Simulated secure write)
16:04:38.804 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.804 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678804_107_80.dat. (Simulated secure write)
16:04:38.804 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.804 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678804_108_80.dat. (Simulated secure write)
16:04:38.804 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.804 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678804_109_80.dat. (Simulated secure write)
16:04:38.804 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.804 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678804_110_80.dat. (Simulated secure write)
16:04:38.804 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.804 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678804_111_80.dat. (Simulated secure write)
16:04:38.804 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.804 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678804_112_80.dat. (Simulated secure write)
16:04:38.804 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.804 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678804_113_80.dat. (Simulated secure write)
16:04:38.805 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.805 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.805 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678805_114_80.dat. (Simulated secure write)
16:04:38.805 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.805 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678805_115_80.dat. (Simulated secure write)
16:04:38.805 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.805 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678805_116_80.dat. (Simulated secure write)
16:04:38.805 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.805 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678805_117_80.dat. (Simulated secure write)
16:04:38.805 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.805 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678805_118_80.dat. (Simulated secure write)
16:04:38.805 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.805 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678805_119_80.dat. (Simulated secure write)
16:04:38.805 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.805 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678805_120_80.dat. (Simulated secure write)
16:04:38.805 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.805 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678805_121_80.dat. (Simulated secure write)
16:04:38.805 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.805 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678805_122_80.dat. (Simulated secure write)
16:04:38.806 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.806 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678806_123_80.dat. (Simulated secure write)
16:04:38.806 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.806 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678806_124_80.dat. (Simulated secure write)
16:04:38.806 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.806 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678806_125_80.dat. (Simulated secure write)
16:04:38.806 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.806 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678806_126_80.dat. (Simulated secure write)
16:04:38.806 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.806 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678806_127_80.dat. (Simulated secure write)
16:04:38.806 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.806 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678806_128_80.dat. (Simulated secure write)
16:04:38.806 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678806_129_80.dat. (Simulated secure write)
16:04:38.806 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.806 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.806 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.806 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.807 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.807 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.807 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.807 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.807 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.807 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.807 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.807 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.807 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.807 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.807 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678807_130_80.dat. (Simulated secure write)
16:04:38.807 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678807_131_80.dat. (Simulated secure write)
16:04:38.807 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.808 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.808 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.808 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.808 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.808 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.808 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.808 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.808 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.808 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.808 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678808_132_80.dat. (Simulated secure write)
16:04:38.808 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678808_133_80.dat. (Simulated secure write)
16:04:38.808 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.808 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678808_134_80.dat. (Simulated secure write)
16:04:38.808 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678808_140_80.dat. (Simulated secure write)
16:04:38.808 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678808_142_80.dat. (Simulated secure write)
16:04:38.809 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678809_144_80.dat. (Simulated secure write)
16:04:38.809 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678809_145_80.dat. (Simulated secure write)
16:04:38.808 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678808_138_80.dat. (Simulated secure write)
16:04:38.808 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678808_139_80.dat. (Simulated secure write)
16:04:38.808 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678808_135_80.dat. (Simulated secure write)
16:04:38.808 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678808_137_80.dat. (Simulated secure write)
16:04:38.809 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678809_146_80.dat. (Simulated secure write)
16:04:38.809 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678809_149_80.dat. (Simulated secure write)
16:04:38.808 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678808_136_80.dat. (Simulated secure write)
16:04:38.809 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678809_147_80.dat. (Simulated secure write)
16:04:38.808 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678808_141_80.dat. (Simulated secure write)
16:04:38.809 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678809_150_80.dat. (Simulated secure write)
16:04:38.809 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678809_148_80.dat. (Simulated secure write)
16:04:38.809 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678809_151_80.dat. (Simulated secure write)
16:04:38.809 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678809_143_80.dat. (Simulated secure write)
16:04:38.809 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.809 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678809_152_80.dat. (Simulated secure write)
16:04:38.809 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:38.809 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678809_153_80.dat. (Simulated secure write)
16:04:38.809 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678809_154_80.dat. (Simulated secure write)
16:04:38.809 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678809_155_80.dat. (Simulated secure write)
16:04:38.809 [debug] S2: Successfully wrote 7 bytes to ./data_1766120678809_156_80.dat. (Simulated secure write)
..16:04:38.910 [error] S2: UDP Listener socket closed unexpectedly. Terminating.
.16:04:38.910 [info] S2: Starting UDP Listener on port 0...
.16:04:38.932 [info] S2: Starting UDP Listener on port 0...
.16:04:38.932 [info] S2: Starting UDP Listener on port 0...
16:04:38.932 [info] S2: Decapsulated packet from 1.2.3.4:80. Payload size: 5 bytes.
16:04:38.932 [debug] S2: Successfully wrote 5 bytes to ./data_1766120678932_157_80.dat. (Simulated secure write)
..16:04:38.943 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.230.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:38.943 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.602.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:04:38.954 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.602.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:38.954 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.604.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:38.964 [warning] S1 Encapsulator: Invalid IP invalid, dropping packet.
.16:04:39.066 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.604.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:39.066 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.606.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:04:39.077 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.606.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:39.077 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.608.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
....16:04:39.529 [info] S1: New connection accepted.
16:04:39.529 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.157>}
16:04:39.529 [info] S1: New connection accepted.
16:04:39.529 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.160>}
16:04:39.530 [info] S1: New connection accepted.
16:04:39.530 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.161>}
16:04:39.530 [info] S1: New connection accepted.
16:04:39.530 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.163>}
16:04:39.530 [info] S1: New connection accepted.
.16:04:39.779 [debug] S1: TCPHandler received unexpected message: :accept_loop
...16:04:39.781 [error] S1: Listener socket fatal error: :closed. Terminating.
.16:04:39.781 [info] S1: Starting TCP Listener on port 0...
..16:04:39.781 [info] S1: Starting TCP Listener on port 0...
16:04:40.031 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.165>}
16:04:40.283 [info] S1: New connection accepted.
.16:04:40.283 [warning] S1: Invalid LISTEN_IP invalid, using all interfaces.
..16:04:40.284 [info] S1: Starting TCP Listener on port 0...
16:04:40.785 [error] S1: Listener socket fatal error: :closed. Terminating.
16:04:40.785 [error] GenServer :s1_flapping_test_unique terminating
** (stop) :closed
Last message: :accept_loop
State: #Port<0.178>
16:04:40.785 [error] Process :s1_flapping_test_unique (#PID<0.722.0>) terminating
** (exit) :closed
    (stdlib 7.1) gen_server.erl:2562: :gen_server.handle_common_reply/5
    (stdlib 7.1) proc_lib.erl:333: :proc_lib.init_p_do_apply/3
Initial Call: DataDiode.S1.Listener.init/1
Ancestors: [#PID<0.721.0>]
Message Queue Length: 0
Messages: []
Links: []
Dictionary: []
Trapping Exits: false
Status: :running
Heap Size: 1598
Stack Size: 29
Reductions: 2746
....16:04:41.296 [debug] SystemMonitor: Received unexpected message: :unexp
16:04:41.300 [debug] S1: TCPHandler received unexpected message: :unexp
16:04:41.300 [info] S1: Starting TCP Listener on port 0...
16:04:41.300 [debug] S1: Listener received unexpected message: :unexp
16:04:42.035 [info] S2: Starting UDP Listener on port 0...
16:04:42.035 [warning] S2: Received unexpected message: :unexp
16:04:42.035 [error] S2: UDP Listener socket closed unexpectedly. Terminating.
16:04:42.040 [info] DiskCleaner: Low disk space detected on . (< 15%). Starting autonomous cleanup...
16:04:42.040 [warning] DiskCleaner: Simulation - would delete oldest .dat files in . now.
16:04:42.044 [info] S2: Decapsulated packet from 127.0.0.1:20480. Payload size: 7 bytes.
16:04:42.044 [debug] S2: Successfully wrote 7 bytes to /tmp/diode_test/data_1766120682044_164_20480.dat. (Simulated secure write)
16:04:42.044 [info] S2: Decapsulated packet from 127.0.0.1:0. Payload size: 9 bytes.
16:04:42.045 [debug] S1: Generating end-to-end heartbeat.
16:04:42.045 [warning] S1 Heartbeat: Received unexpected message: :unexp
16:04:42.045 [error] S2: Critical Failure! Channel heartbeat missing for > 6 minutes. The diode path may be obstructed.
16:04:42.045 [warning] S2 HeartbeatMonitor: Received unexpected message: :unexp
.
Finished in 3.9 seconds (0.1s async, 3.8s sync)
1 doctest, 65 tests, 0 failures
Run 4
warning: setting :preferred_cli_env in your mix.exs "def project" is deprecated, set it inside "def cli" instead:

    def cli do
      [preferred_envs: [release: :prod, test: :test]]
    end

  (mix 1.19.4) lib/mix/cli.ex:187: Mix.CLI.preferred_cli_env/3
  (mix 1.19.4) lib/mix/cli.ex:170: Mix.CLI.maybe_change_env_and_target/2
  (mix 1.19.4) lib/mix/cli.ex:59: Mix.CLI.proceed/2
  /opt/homebrew/bin/mix:7: (file)
  (elixir 1.19.4) src/elixir_compiler.erl:81: :elixir_compiler.dispatch/4
  (elixir 1.19.4) src/elixir_compiler.erl:56: :elixir_compiler.compile/4

    warning: unused alias Decapsulator
    │
  8 │   alias DataDiode.S2.Decapsulator
    │   ~
    │
    └─ lib/data_diode/s2/listener.ex:8:3

16:04:42.503 [info] Application logger started at :nonode@nohost
16:04:42.507 [info] Child :ttb_autostart of Supervisor :runtime_tools_sup started
Pid: #PID<0.184.0>
Start Call: :ttb_autostart.start_link()
Restart: :temporary
Shutdown: 3000
Type: :worker
16:04:42.507 [info] Application runtime_tools started at :nonode@nohost
16:04:42.507 [info] Application opentelemetry_api started at :nonode@nohost
16:04:42.508 [info] Application ctx started at :nonode@nohost
16:04:42.508 [info] Application hpack started at :nonode@nohost
16:04:42.508 [info] Application chatterbox started at :nonode@nohost
16:04:42.508 [info] Application acceptor_pool started at :nonode@nohost
16:04:42.512 [info] Child :gproc of Supervisor :gproc_sup started
Pid: #PID<0.188.0>
Start Call: :gproc.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:04:42.513 [info] Child :gproc_monitor of Supervisor :gproc_sup started
Pid: #PID<0.189.0>
Start Call: :gproc_monitor.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:04:42.514 [info] Child :gproc_bcast of Supervisor :gproc_sup started
Pid: #PID<0.190.0>
Start Call: :gproc_bcast.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:04:42.515 [info] Child :gproc_pool of Supervisor :gproc_sup started
Pid: #PID<0.191.0>
Start Call: :gproc_pool.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:04:42.515 [info] Application gproc started at :nonode@nohost
16:04:42.517 [info] Child :grpcbox_services_simple_sup of Supervisor :grpcbox_sup started
Pid: #PID<0.195.0>
Start Call: :grpcbox_services_simple_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:04:42.518 [info] Child :grpcbox_channel_sup of Supervisor :grpcbox_sup started
Pid: #PID<0.196.0>
Start Call: :grpcbox_channel_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:04:42.518 [info] Application grpcbox started at :nonode@nohost
16:04:42.518 [info] Application ssl_verify_fun started at :nonode@nohost
16:04:42.576 [info] Loading 162 CA(s) from :otp store
16:04:42.576 [info] Child :tls_certificate_check_shared_state of Supervisor :tls_certificate_check_sup started
Pid: #PID<0.200.0>
Start Call: :tls_certificate_check_shared_state.start_link()
Restart: :permanent
Shutdown: :infinity
Type: :worker
16:04:42.576 [info] Application tls_certificate_check started at :nonode@nohost
16:04:42.576 [info] Application opentelemetry_exporter started at :nonode@nohost
16:04:42.581 [info] Child :otel_span_ets of Supervisor :otel_span_sup started
Pid: #PID<0.208.0>
Start Call: :otel_span_ets.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:42.582 [info] Child :otel_span_sweeper of Supervisor :otel_span_sup started
Pid: #PID<0.209.0>
Start Call: :otel_span_sweeper.start_link(%{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:42.582 [info] Child :otel_span_sup of Supervisor :opentelemetry_sup started
Pid: #PID<0.207.0>
Start Call: :otel_span_sup.start_link(%{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:04:42.584 [info] Child :otel_resource_detector of Supervisor :opentelemetry_sup started
Pid: #PID<0.210.0>
Start Call: :otel_resource_detector.start_link(%{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:42.585 [info] Child :otel_tracer_provider_sup of Supervisor :opentelemetry_sup started
Pid: #PID<0.213.0>
Start Call: :otel_tracer_provider_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:04:42.587 [info] Child :otel_span_processor_sup of Supervisor #PID<0.214.0> (:otel_tracer_server_sup) started
Pid: #PID<0.215.0>
Start Call: :otel_span_processor_sup.start_link(:otel_span_processor_sup_global)
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:04:42.593 [info] Child :otel_tracer_server of Supervisor #PID<0.214.0> (:otel_tracer_server_sup) started
Pid: #PID<0.216.0>
Start Call: :otel_tracer_server.start_link(:global, :otel_tracer_provider_global, :otel_span_processor_sup_global, {:resource, :undefined, {:attributes, 128, 255, 0, %{"process.executable.name": "erl", "process.runtime.description": "Erlang/OTP 28 erts-16.1.2", "process.runtime.version": "16.1.2", "process.runtime.name": "BEAM", "service.name": "unknown_service:erl", "service.instance.id": 149944465624866628350411876497439138644, "telemetry.sdk.version": "1.6.0", "telemetry.sdk.language": "erlang", "telemetry.sdk.name": "opentelemetry"}}}, %{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:42.597 [debug] Child {:httpc, :"otel_exporter_otlp_<0.217.0>"} of Supervisor :httpc_profile_sup started
Pid: #PID<0.218.0>
Start Call: :httpc_manager.start_link(:"otel_exporter_otlp_<0.217.0>", :only_session_cookies, :inets)
Restart: :permanent
Shutdown: 4000
Type: :worker
16:04:42.600 [info] OTLP exporter successfully initialized
16:04:42.601 [info] Application opentelemetry started at :nonode@nohost
16:04:42.601 [info] Application jason started at :nonode@nohost
16:04:42.602 [info] Application logger_json started at :nonode@nohost
16:04:42.602 [info] Application nimble_ownership started at :nonode@nohost
16:04:42.604 [info] Child Mox of Supervisor Mox.Supervisor started
Pid: #PID<0.222.0>
Start Call: Mox.start_link_ownership()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:42.605 [info] Application mox started at :nonode@nohost
16:04:42.609 [info] Child DataDiode.Metrics of Supervisor DataDiode.Supervisor started
Pid: #PID<0.226.0>
Start Call: DataDiode.Metrics.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:42.609 [info] Child DataDiode.SystemMonitor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.227.0>
Start Call: DataDiode.SystemMonitor.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:42.610 [info] S1: Starting TCP Listener on port 0...
16:04:42.610 [info] Child DataDiode.S1.Listener of Supervisor DataDiode.Supervisor started
Pid: #PID<0.228.0>
Start Call: DataDiode.S1.Listener.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:42.612 [info] Child DataDiode.S1.HandlerSupervisor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.229.0>
Start Call: DataDiode.S1.HandlerSupervisor.start_link()
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:04:42.613 [warning] S1 Encapsulator: Invalid S2_PORT 0, using default 42001
16:04:42.613 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.230.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:42.613 [info] Child DataDiode.S1.Heartbeat of Supervisor DataDiode.Supervisor started
Pid: #PID<0.231.0>
Start Call: DataDiode.S1.Heartbeat.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:42.613 [info] Child DataDiode.S2.HeartbeatMonitor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.232.0>
Start Call: DataDiode.S2.HeartbeatMonitor.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:42.613 [info] Child DataDiode.DiskCleaner of Supervisor DataDiode.Supervisor started
Pid: #PID<0.233.0>
Start Call: DataDiode.DiskCleaner.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:42.614 [info] S2: Starting UDP Listener on port 0...
16:04:42.614 [info] Child DataDiode.S2.Listener of Supervisor DataDiode.Supervisor started
Pid: #PID<0.234.0>
Start Call: DataDiode.S2.Listener.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:42.614 [info] Child DataDiode.S2.TaskSupervisor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.235.0>
Start Call: Task.Supervisor.start_link([name: DataDiode.S2.TaskSupervisor, max_children: 200])
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:04:42.614 [info] Application data_diode started at :nonode@nohost
16:04:42.619 [info] Child ExUnit.Server of Supervisor ExUnit.Supervisor started
Pid: #PID<0.241.0>
Start Call: ExUnit.Server.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:42.619 [info] Child ExUnit.CaptureServer of Supervisor ExUnit.Supervisor started
Pid: #PID<0.242.0>
Start Call: ExUnit.CaptureServer.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:42.619 [info] Application ex_unit started at :nonode@nohost
Running ExUnit with seed: 620918, max_cases: 16

    warning: variable "c" is unused (if the variable is not meant to be used, prefix it with an underscore)
    │
 26 │     {:ok, c} = :gen_tcp.connect({127,0,0,1}, port, [:binary, active: false])
    │           ~
    │
    └─ test/long_term_robustness_test.exs:26:11: DataDiode.LongTermRobustnessTest."test TCPHandler exhaustive branch coverage"/1

    warning: variable "pid3" is unused (if the variable is not meant to be used, prefix it with an underscore)
    │
 62 │     {:ok, pid3} = TCPHandler.start_link(s3)
    │           ~~~~
    │
    └─ test/long_term_robustness_test.exs:62:11: DataDiode.LongTermRobustnessTest."test TCPHandler exhaustive branch coverage"/1

16:04:42.695 [info] DiskCleaner: Low disk space detected on . (< 15%). Starting autonomous cleanup...
16:04:42.695 [warning] DiskCleaner: Simulation - would delete oldest .dat files in . now.
..     warning: redefining module DataDiode.S1.EncapsulatorMock (current version defined in memory)
     │
 491 │     Module.create(name, [info | body], Macro.Env.location(__ENV__))
     │     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     │
     └─ deps/mox/lib/mox.ex:491: DataDiode.S1.EncapsulatorMock (module)

........16:04:42.710 [info] S2: Decapsulated packet from 0.0.0.0:0. Payload size: 0 bytes.
.16:04:42.710 [debug] S2: Successfully wrote 0 bytes to ./data_1766120682710_1_0.dat. (Simulated secure write)
.16:04:42.710 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 0 bytes.
.16:04:42.710 [debug] S2: Successfully wrote 0 bytes to ./data_1766120682710_2_51210.dat. (Simulated secure write)
.16:04:42.710 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 23 bytes.
.16:04:42.710 [debug] S2: Successfully wrote 23 bytes to ./data_1766120682710_3_51210.dat. (Simulated secure write)
.16:04:42.713 [error] S2: Failed to parse header: invalid_packet_size
.16:04:42.714 [error] S2: Failed to parse header: invalid_packet_size
16:04:42.714 [error] S2: Failed to parse header: invalid_packet_size
.16:04:42.714 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 23 bytes.
.16:04:42.714 [debug] S2: Successfully wrote 23 bytes to ./data_1766120682714_4_51210.dat. (Simulated secure write)
.16:04:42.714 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 9 bytes.
16:04:42.714 [debug] S2: Successfully wrote 9 bytes to ./data_1766120682714_5_80.dat. (Simulated secure write)
16:04:42.732 [debug] S1: TCPHandler received unexpected message: :unknown
.16:04:42.732 [info] S1: Connection closed by 1.2.3.4:80
.16:04:42.732 [error] S1: TCP error for 1.2.3.4: :econnreset
.16:04:42.739 [info] Child of Supervisor :inet_gethost_native_sup started
Pid: #PID<0.388.0>
Start Call: :inet_gethost_native.init([])
16:04:42.739 [debug] Child :inet_gethost_native_sup of Supervisor :kernel_safe_sup started
Pid: #PID<0.387.0>
Start Call: :inet_gethost_native.start_link()
Restart: :temporary
Shutdown: 1000
Type: :worker
16:04:42.746 [info] S1: Forwarded 11 bytes.
.16:04:42.757 [warning] S1: Dropping oversized packet (1048577 bytes) from 1.2.3.4
..16:04:42.758 [debug] S1: TCPHandler received unexpected message: :accept_loop
...16:04:42.759 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.230.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:42.759 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.401.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:04:42.770 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.401.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:42.770 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.403.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:42.781 [warning] S1 Encapsulator: Invalid IP invalid, dropping packet.
.16:04:42.882 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.403.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:42.882 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.405.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:04:42.893 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.405.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:42.893 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.407.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:04:42.904 [info] S1: Starting TCP Listener on port 8092...
16:04:42.904 [info] S1: New connection accepted.
16:04:42.905 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.45>}
16:04:42.905 [info] S1: New connection accepted.
16:04:42.906 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.52>}
16:04:42.906 [info] S1: New connection accepted.
16:04:42.906 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.53>}
16:04:42.906 [info] S1: New connection accepted.
16:04:42.906 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.54>}
16:04:42.906 [info] S1: New connection accepted.
16:04:42.906 [info] S1: New connection accepted.
16:04:42.906 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.55>}
16:04:42.906 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.56>}
16:04:42.952 [info] S1: New connection accepted.
16:04:42.952 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.57>}
16:04:42.953 [info] S1: New connection accepted.
16:04:42.953 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.59>}
16:04:42.953 [info] S1: New connection accepted.
16:04:42.953 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.61>}
16:04:42.953 [info] S1: New connection accepted.
16:04:42.953 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.63>}
16:04:42.953 [info] S1: New connection accepted.
16:04:42.953 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.65>}
16:04:42.953 [info] S1: New connection accepted.
16:04:42.954 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.67>}
16:04:42.954 [info] S1: New connection accepted.
16:04:42.954 [info] S1: New connection accepted.
16:04:42.954 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.69>}
16:04:42.954 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.71>}
16:04:42.954 [info] S1: New connection accepted.
16:04:42.954 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.73>}
16:04:42.954 [info] S1: New connection accepted.
16:04:42.954 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.75>}
16:04:42.954 [info] S1: New connection accepted.
16:04:42.954 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.77>}
16:04:42.954 [info] S1: New connection accepted.
16:04:42.955 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.79>}
16:04:42.955 [info] S1: New connection accepted.
16:04:42.955 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.81>}
16:04:42.955 [info] S1: New connection accepted.
16:04:42.955 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.83>}
16:04:42.955 [info] S1: New connection accepted.
16:04:42.955 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.85>}
16:04:42.955 [info] S1: New connection accepted.
16:04:42.955 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.87>}
16:04:42.955 [info] S1: New connection accepted.
16:04:42.955 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.89>}
16:04:42.955 [info] S1: New connection accepted.
16:04:42.955 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.91>}
16:04:42.956 [info] S1: New connection accepted.
16:04:42.956 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.93>}
16:04:42.956 [info] S1: New connection accepted.
16:04:42.956 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.95>}
16:04:42.956 [info] S1: New connection accepted.
16:04:42.956 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.97>}
16:04:42.956 [info] S1: New connection accepted.
16:04:42.956 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.99>}
16:04:42.956 [info] S1: New connection accepted.
16:04:42.956 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.101>}
16:04:42.956 [info] S1: New connection accepted.
16:04:42.956 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.103>}
16:04:42.956 [info] S1: New connection accepted.
16:04:42.957 [info] S1: New connection accepted.
16:04:42.957 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.105>}
16:04:42.957 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.107>}
16:04:42.957 [info] S1: New connection accepted.
16:04:42.957 [info] S1: New connection accepted.
16:04:42.957 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.109>}
16:04:42.957 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.111>}
16:04:42.957 [info] S1: New connection accepted.
16:04:42.957 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.113>}
16:04:42.957 [info] S1: New connection accepted.
16:04:42.957 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.115>}
16:04:42.957 [info] S1: New connection accepted.
16:04:42.957 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.117>}
16:04:42.958 [info] S1: New connection accepted.
16:04:42.958 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.119>}
16:04:42.958 [info] S1: New connection accepted.
16:04:42.958 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.121>}
16:04:42.958 [info] S1: New connection accepted.
16:04:42.958 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.123>}
16:04:42.958 [info] S1: New connection accepted.
16:04:42.958 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.125>}
16:04:42.958 [info] S1: New connection accepted.
16:04:42.958 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.127>}
16:04:42.958 [info] S1: New connection accepted.
16:04:42.958 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.129>}
16:04:42.958 [info] S1: New connection accepted.
16:04:42.958 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.131>}
16:04:42.959 [info] S1: New connection accepted.
16:04:42.959 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.133>}
16:04:42.959 [info] S1: New connection accepted.
16:04:42.959 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.135>}
16:04:42.959 [info] S1: New connection accepted.
16:04:42.959 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.137>}
16:04:42.959 [info] S1: New connection accepted.
16:04:42.959 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.139>}
16:04:42.959 [info] S1: New connection accepted.
16:04:42.959 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.141>}
16:04:42.959 [info] S1: New connection accepted.
16:04:42.959 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.143>}
...........16:04:43.612 [debug] S1: TCPHandler received unexpected message: :accept_loop
.16:04:44.114 [info] S1: New connection accepted.
16:04:44.114 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.157>}
16:04:44.114 [info] S1: New connection accepted.
16:04:44.114 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.160>}
16:04:44.114 [info] S1: New connection accepted.
16:04:44.114 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.161>}
16:04:44.114 [info] S1: New connection accepted.
16:04:44.114 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.164>}
16:04:44.115 [info] S1: New connection accepted.
16:04:44.115 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.165>}
.16:04:44.318 [info] S1: Starting TCP Listener on port 0...
16:04:44.819 [info] S1: New connection accepted.
..16:04:44.820 [warning] S1: Invalid LISTEN_IP invalid, using all interfaces.
.16:04:44.820 [info] S1: Starting TCP Listener on port 0...
.16:04:44.820 [error] S1: Listener socket fatal error: :closed. Terminating.
..16:04:45.322 [info] S1: Starting TCP Listener on port 0...
...16:04:45.823 [error] S1: Listener socket fatal error: :closed. Terminating.
16:04:45.823 [error] GenServer :s1_flapping_test_unique terminating
** (stop) :closed
Last message: :accept_loop
State: #Port<0.172>
.16:04:45.823 [error] Process :s1_flapping_test_unique (#PID<0.586.0>) terminating
** (exit) :closed
    (stdlib 7.1) gen_server.erl:2562: :gen_server.handle_common_reply/5
    (stdlib 7.1) proc_lib.erl:333: :proc_lib.init_p_do_apply/3
Initial Call: DataDiode.S1.Listener.init/1
Ancestors: [#PID<0.585.0>]
Message Queue Length: 0
Messages: []
Links: []
Dictionary: []
Trapping Exits: false
Status: :running
Heap Size: 1598
Stack Size: 29
Reductions: 2754
.16:04:45.823 [info] S2: Starting UDP Listener on port 0...
16:04:45.824 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.824 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685824_63_80.dat. (Simulated secure write)
16:04:45.824 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.824 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685824_64_80.dat. (Simulated secure write)
16:04:45.824 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.824 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685824_65_80.dat. (Simulated secure write)
16:04:45.824 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.824 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685824_66_80.dat. (Simulated secure write)
16:04:45.824 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.824 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685824_67_80.dat. (Simulated secure write)
16:04:45.824 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.824 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685824_68_80.dat. (Simulated secure write)
16:04:45.825 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.825 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685825_69_80.dat. (Simulated secure write)
16:04:45.825 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.825 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685825_70_80.dat. (Simulated secure write)
16:04:45.825 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.825 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685825_71_80.dat. (Simulated secure write)
16:04:45.825 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.825 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685825_72_80.dat. (Simulated secure write)
16:04:45.825 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.825 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685825_73_80.dat. (Simulated secure write)
16:04:45.825 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.825 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685825_74_80.dat. (Simulated secure write)
16:04:45.825 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.825 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685825_75_80.dat. (Simulated secure write)
16:04:45.825 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.825 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685825_76_80.dat. (Simulated secure write)
16:04:45.825 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.825 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685825_77_80.dat. (Simulated secure write)
16:04:45.826 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.826 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685826_78_80.dat. (Simulated secure write)
16:04:45.826 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.826 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685826_79_80.dat. (Simulated secure write)
16:04:45.826 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.826 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685826_80_80.dat. (Simulated secure write)
16:04:45.826 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.826 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685826_81_80.dat. (Simulated secure write)
16:04:45.826 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.826 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685826_82_80.dat. (Simulated secure write)
16:04:45.826 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.826 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685826_83_80.dat. (Simulated secure write)
16:04:45.826 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.826 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685826_84_80.dat. (Simulated secure write)
16:04:45.826 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.826 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685826_85_80.dat. (Simulated secure write)
16:04:45.827 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.827 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685827_86_80.dat. (Simulated secure write)
16:04:45.827 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.827 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685827_87_80.dat. (Simulated secure write)
16:04:45.827 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.827 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685827_88_80.dat. (Simulated secure write)
16:04:45.827 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.827 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685827_89_80.dat. (Simulated secure write)
16:04:45.827 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.827 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685827_90_80.dat. (Simulated secure write)
16:04:45.827 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.827 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685827_91_80.dat. (Simulated secure write)
16:04:45.827 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.827 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685827_92_80.dat. (Simulated secure write)
16:04:45.827 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.827 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685827_93_80.dat. (Simulated secure write)
16:04:45.827 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.827 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685827_94_80.dat. (Simulated secure write)
16:04:45.827 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.827 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685827_95_80.dat. (Simulated secure write)
16:04:45.828 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.828 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685828_96_80.dat. (Simulated secure write)
16:04:45.828 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.828 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685828_97_80.dat. (Simulated secure write)
16:04:45.828 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.828 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685828_98_80.dat. (Simulated secure write)
16:04:45.828 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.828 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685828_99_80.dat. (Simulated secure write)
16:04:45.828 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.828 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685828_100_80.dat. (Simulated secure write)
16:04:45.828 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.828 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685828_101_80.dat. (Simulated secure write)
16:04:45.828 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.828 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685828_102_80.dat. (Simulated secure write)
16:04:45.828 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.828 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685828_103_80.dat. (Simulated secure write)
16:04:45.828 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.828 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685828_104_80.dat. (Simulated secure write)
16:04:45.828 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.828 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685828_105_80.dat. (Simulated secure write)
16:04:45.828 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.828 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685828_106_80.dat. (Simulated secure write)
16:04:45.829 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.829 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685829_107_80.dat. (Simulated secure write)
16:04:45.829 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.829 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.829 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685829_108_80.dat. (Simulated secure write)
16:04:45.829 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.829 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685829_109_80.dat. (Simulated secure write)
16:04:45.829 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.829 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685829_110_80.dat. (Simulated secure write)
16:04:45.829 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.829 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685829_111_80.dat. (Simulated secure write)
16:04:45.829 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.829 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685829_112_80.dat. (Simulated secure write)
16:04:45.829 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.829 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685829_113_80.dat. (Simulated secure write)
16:04:45.829 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.829 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685829_114_80.dat. (Simulated secure write)
16:04:45.829 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.829 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685829_115_80.dat. (Simulated secure write)
16:04:45.829 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.829 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685829_116_80.dat. (Simulated secure write)
16:04:45.829 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.829 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685829_117_80.dat. (Simulated secure write)
16:04:45.830 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.830 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685830_118_80.dat. (Simulated secure write)
16:04:45.830 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.830 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685830_119_80.dat. (Simulated secure write)
16:04:45.830 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.830 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685830_120_80.dat. (Simulated secure write)
16:04:45.830 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.830 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685830_121_80.dat. (Simulated secure write)
16:04:45.830 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.830 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685830_122_80.dat. (Simulated secure write)
16:04:45.830 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.830 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685830_123_80.dat. (Simulated secure write)
16:04:45.830 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.830 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685830_124_80.dat. (Simulated secure write)
16:04:45.830 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.830 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685830_125_80.dat. (Simulated secure write)
16:04:45.830 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.830 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685830_126_80.dat. (Simulated secure write)
16:04:45.831 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.831 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685831_127_80.dat. (Simulated secure write)
16:04:45.831 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.831 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685831_128_80.dat. (Simulated secure write)
16:04:45.831 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.831 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685831_129_80.dat. (Simulated secure write)
16:04:45.831 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.831 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685831_130_80.dat. (Simulated secure write)
16:04:45.831 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.831 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.831 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.831 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.831 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.831 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.831 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.831 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.831 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.832 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685832_131_80.dat. (Simulated secure write)
16:04:45.832 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685832_132_80.dat. (Simulated secure write)
16:04:45.832 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685832_133_80.dat. (Simulated secure write)
16:04:45.832 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685832_134_80.dat. (Simulated secure write)
16:04:45.832 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685832_135_80.dat. (Simulated secure write)
16:04:45.832 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685832_136_80.dat. (Simulated secure write)
16:04:45.832 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685832_137_80.dat. (Simulated secure write)
16:04:45.832 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685832_138_80.dat. (Simulated secure write)
16:04:45.832 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685832_140_80.dat. (Simulated secure write)
16:04:45.832 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685832_139_80.dat. (Simulated secure write)
16:04:45.832 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.832 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685832_141_80.dat. (Simulated secure write)
16:04:45.832 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.832 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685832_142_80.dat. (Simulated secure write)
16:04:45.832 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.832 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685832_143_80.dat. (Simulated secure write)
16:04:45.832 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.832 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685832_144_80.dat. (Simulated secure write)
16:04:45.832 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.832 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685832_145_80.dat. (Simulated secure write)
16:04:45.832 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.832 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685832_146_80.dat. (Simulated secure write)
16:04:45.832 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.832 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685832_147_80.dat. (Simulated secure write)
16:04:45.832 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.832 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685832_148_80.dat. (Simulated secure write)
16:04:45.832 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.832 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.832 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685832_149_80.dat. (Simulated secure write)
16:04:45.832 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.832 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685832_150_80.dat. (Simulated secure write)
16:04:45.833 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.833 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685833_151_80.dat. (Simulated secure write)
16:04:45.833 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.833 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685833_152_80.dat. (Simulated secure write)
16:04:45.833 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.833 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685833_153_80.dat. (Simulated secure write)
16:04:45.833 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.833 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685833_154_80.dat. (Simulated secure write)
16:04:45.833 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.833 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685833_155_80.dat. (Simulated secure write)
16:04:45.833 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.833 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685833_156_80.dat. (Simulated secure write)
16:04:45.833 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.833 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685833_157_80.dat. (Simulated secure write)
16:04:45.833 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.833 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685833_158_80.dat. (Simulated secure write)
16:04:45.833 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.833 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685833_159_80.dat. (Simulated secure write)
16:04:45.833 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.833 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685833_160_80.dat. (Simulated secure write)
16:04:45.833 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:45.833 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685833_161_80.dat. (Simulated secure write)
16:04:45.833 [debug] S2: Successfully wrote 7 bytes to ./data_1766120685833_162_80.dat. (Simulated secure write)
.16:04:45.934 [error] S2: UDP Listener socket closed unexpectedly. Terminating.
.16:04:45.934 [warning] S2: Invalid LISTEN_IP_S2 invalid, falling back to all interfaces.
..16:04:45.934 [info] S2: Starting UDP Listener on port 0...
16:04:45.935 [info] S2: Decapsulated packet from 1.2.3.4:80. Payload size: 5 bytes.
16:04:45.935 [debug] S2: Successfully wrote 5 bytes to ./data_1766120685935_163_80.dat. (Simulated secure write)
..16:04:45.946 [info] S2: Starting UDP Listener on port 0...
.16:04:45.967 [info] S2: Starting UDP Listener on port 0...
.16:04:45.977 [debug] SystemMonitor: Received unexpected message: :unexp
16:04:45.980 [debug] S1: TCPHandler received unexpected message: :unexp
16:04:45.980 [info] S1: Starting TCP Listener on port 0...
16:04:45.980 [debug] S1: Listener received unexpected message: :unexp
16:04:46.620 [info] S2: Starting UDP Listener on port 0...
16:04:46.620 [warning] S2: Received unexpected message: :unexp
16:04:46.620 [error] S2: UDP Listener socket closed unexpectedly. Terminating.
16:04:46.626 [info] DiskCleaner: Low disk space detected on . (< 15%). Starting autonomous cleanup...
16:04:46.626 [warning] DiskCleaner: Simulation - would delete oldest .dat files in . now.
16:04:46.630 [info] S2: Decapsulated packet from 127.0.0.1:20480. Payload size: 7 bytes.
16:04:46.630 [debug] S2: Successfully wrote 7 bytes to /tmp/diode_test/data_1766120686630_164_20480.dat. (Simulated secure write)
16:04:46.630 [info] S2: Decapsulated packet from 127.0.0.1:0. Payload size: 9 bytes.
16:04:46.632 [debug] S1: Generating end-to-end heartbeat.
16:04:46.632 [warning] S1 Heartbeat: Received unexpected message: :unexp
16:04:46.632 [error] S2: Critical Failure! Channel heartbeat missing for > 6 minutes. The diode path may be obstructed.
16:04:46.632 [warning] S2 HeartbeatMonitor: Received unexpected message: :unexp
.
Finished in 3.9 seconds (0.1s async, 3.8s sync)
1 doctest, 65 tests, 0 failures
Run 5
warning: setting :preferred_cli_env in your mix.exs "def project" is deprecated, set it inside "def cli" instead:

    def cli do
      [preferred_envs: [release: :prod, test: :test]]
    end

  (mix 1.19.4) lib/mix/cli.ex:187: Mix.CLI.preferred_cli_env/3
  (mix 1.19.4) lib/mix/cli.ex:170: Mix.CLI.maybe_change_env_and_target/2
  (mix 1.19.4) lib/mix/cli.ex:59: Mix.CLI.proceed/2
  /opt/homebrew/bin/mix:7: (file)
  (elixir 1.19.4) src/elixir_compiler.erl:81: :elixir_compiler.dispatch/4
  (elixir 1.19.4) src/elixir_compiler.erl:56: :elixir_compiler.compile/4

    warning: unused alias Decapsulator
    │
  8 │   alias DataDiode.S2.Decapsulator
    │   ~
    │
    └─ lib/data_diode/s2/listener.ex:8:3

16:04:47.091 [info] Application logger started at :nonode@nohost
16:04:47.096 [info] Child :ttb_autostart of Supervisor :runtime_tools_sup started
Pid: #PID<0.184.0>
Start Call: :ttb_autostart.start_link()
Restart: :temporary
Shutdown: 3000
Type: :worker
16:04:47.096 [info] Application runtime_tools started at :nonode@nohost
16:04:47.096 [info] Application opentelemetry_api started at :nonode@nohost
16:04:47.096 [info] Application ctx started at :nonode@nohost
16:04:47.096 [info] Application hpack started at :nonode@nohost
16:04:47.096 [info] Application chatterbox started at :nonode@nohost
16:04:47.096 [info] Application acceptor_pool started at :nonode@nohost
16:04:47.101 [info] Child :gproc of Supervisor :gproc_sup started
Pid: #PID<0.188.0>
Start Call: :gproc.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:04:47.102 [info] Child :gproc_monitor of Supervisor :gproc_sup started
Pid: #PID<0.189.0>
Start Call: :gproc_monitor.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:04:47.102 [info] Child :gproc_bcast of Supervisor :gproc_sup started
Pid: #PID<0.190.0>
Start Call: :gproc_bcast.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:04:47.103 [info] Child :gproc_pool of Supervisor :gproc_sup started
Pid: #PID<0.191.0>
Start Call: :gproc_pool.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:04:47.103 [info] Application gproc started at :nonode@nohost
16:04:47.105 [info] Child :grpcbox_services_simple_sup of Supervisor :grpcbox_sup started
Pid: #PID<0.195.0>
Start Call: :grpcbox_services_simple_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:04:47.105 [info] Child :grpcbox_channel_sup of Supervisor :grpcbox_sup started
Pid: #PID<0.196.0>
Start Call: :grpcbox_channel_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:04:47.106 [info] Application grpcbox started at :nonode@nohost
16:04:47.106 [info] Application ssl_verify_fun started at :nonode@nohost
16:04:47.165 [info] Loading 162 CA(s) from :otp store
16:04:47.165 [info] Child :tls_certificate_check_shared_state of Supervisor :tls_certificate_check_sup started
Pid: #PID<0.200.0>
Start Call: :tls_certificate_check_shared_state.start_link()
Restart: :permanent
Shutdown: :infinity
Type: :worker
16:04:47.165 [info] Application tls_certificate_check started at :nonode@nohost
16:04:47.165 [info] Application opentelemetry_exporter started at :nonode@nohost
16:04:47.170 [info] Child :otel_span_ets of Supervisor :otel_span_sup started
Pid: #PID<0.208.0>
Start Call: :otel_span_ets.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:47.171 [info] Child :otel_span_sweeper of Supervisor :otel_span_sup started
Pid: #PID<0.209.0>
Start Call: :otel_span_sweeper.start_link(%{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:47.171 [info] Child :otel_span_sup of Supervisor :opentelemetry_sup started
Pid: #PID<0.207.0>
Start Call: :otel_span_sup.start_link(%{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:04:47.173 [info] Child :otel_resource_detector of Supervisor :opentelemetry_sup started
Pid: #PID<0.210.0>
Start Call: :otel_resource_detector.start_link(%{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:47.175 [info] Child :otel_tracer_provider_sup of Supervisor :opentelemetry_sup started
Pid: #PID<0.213.0>
Start Call: :otel_tracer_provider_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:04:47.177 [info] Child :otel_span_processor_sup of Supervisor #PID<0.214.0> (:otel_tracer_server_sup) started
Pid: #PID<0.215.0>
Start Call: :otel_span_processor_sup.start_link(:otel_span_processor_sup_global)
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:04:47.182 [info] Child :otel_tracer_server of Supervisor #PID<0.214.0> (:otel_tracer_server_sup) started
Pid: #PID<0.216.0>
Start Call: :otel_tracer_server.start_link(:global, :otel_tracer_provider_global, :otel_span_processor_sup_global, {:resource, :undefined, {:attributes, 128, 255, 0, %{"process.executable.name": "erl", "process.runtime.description": "Erlang/OTP 28 erts-16.1.2", "process.runtime.version": "16.1.2", "process.runtime.name": "BEAM", "service.name": "unknown_service:erl", "service.instance.id": 266291482741605047155194034667795828452, "telemetry.sdk.version": "1.6.0", "telemetry.sdk.language": "erlang", "telemetry.sdk.name": "opentelemetry"}}}, %{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:47.185 [debug] Child {:httpc, :"otel_exporter_otlp_<0.217.0>"} of Supervisor :httpc_profile_sup started
Pid: #PID<0.218.0>
Start Call: :httpc_manager.start_link(:"otel_exporter_otlp_<0.217.0>", :only_session_cookies, :inets)
Restart: :permanent
Shutdown: 4000
Type: :worker
16:04:47.188 [info] OTLP exporter successfully initialized
16:04:47.188 [info] Application opentelemetry started at :nonode@nohost
16:04:47.189 [info] Application jason started at :nonode@nohost
16:04:47.189 [info] Application logger_json started at :nonode@nohost
16:04:47.189 [info] Application nimble_ownership started at :nonode@nohost
16:04:47.192 [info] Child Mox of Supervisor Mox.Supervisor started
Pid: #PID<0.222.0>
Start Call: Mox.start_link_ownership()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:47.192 [info] Application mox started at :nonode@nohost
16:04:47.196 [info] Child DataDiode.Metrics of Supervisor DataDiode.Supervisor started
Pid: #PID<0.226.0>
Start Call: DataDiode.Metrics.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:47.196 [info] Child DataDiode.SystemMonitor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.227.0>
Start Call: DataDiode.SystemMonitor.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:47.197 [info] S1: Starting TCP Listener on port 0...
16:04:47.197 [info] Child DataDiode.S1.Listener of Supervisor DataDiode.Supervisor started
Pid: #PID<0.228.0>
Start Call: DataDiode.S1.Listener.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:47.199 [info] Child DataDiode.S1.HandlerSupervisor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.229.0>
Start Call: DataDiode.S1.HandlerSupervisor.start_link()
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:04:47.201 [warning] S1 Encapsulator: Invalid S2_PORT 0, using default 42001
16:04:47.201 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.230.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:47.201 [info] Child DataDiode.S1.Heartbeat of Supervisor DataDiode.Supervisor started
Pid: #PID<0.231.0>
Start Call: DataDiode.S1.Heartbeat.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:47.201 [info] Child DataDiode.S2.HeartbeatMonitor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.232.0>
Start Call: DataDiode.S2.HeartbeatMonitor.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:47.201 [info] Child DataDiode.DiskCleaner of Supervisor DataDiode.Supervisor started
Pid: #PID<0.233.0>
Start Call: DataDiode.DiskCleaner.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:47.202 [info] S2: Starting UDP Listener on port 0...
16:04:47.202 [info] Child DataDiode.S2.Listener of Supervisor DataDiode.Supervisor started
Pid: #PID<0.234.0>
Start Call: DataDiode.S2.Listener.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:47.202 [info] Child DataDiode.S2.TaskSupervisor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.235.0>
Start Call: Task.Supervisor.start_link([name: DataDiode.S2.TaskSupervisor, max_children: 200])
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:04:47.202 [info] Application data_diode started at :nonode@nohost
16:04:47.206 [info] Child ExUnit.Server of Supervisor ExUnit.Supervisor started
Pid: #PID<0.241.0>
Start Call: ExUnit.Server.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:47.206 [info] Child ExUnit.CaptureServer of Supervisor ExUnit.Supervisor started
Pid: #PID<0.242.0>
Start Call: ExUnit.CaptureServer.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:47.207 [info] Application ex_unit started at :nonode@nohost
Running ExUnit with seed: 208462, max_cases: 16

     warning: redefining module DataDiode.S1.EncapsulatorMock (current version defined in memory)
     │
 491 │     Module.create(name, [info | body], Macro.Env.location(__ENV__))
     │     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     │
     └─ deps/mox/lib/mox.ex:491: DataDiode.S1.EncapsulatorMock (module)

    warning: variable "c" is unused (if the variable is not meant to be used, prefix it with an underscore)
    │
 26 │     {:ok, c} = :gen_tcp.connect({127,0,0,1}, port, [:binary, active: false])
    │           ~
    │
    └─ test/long_term_robustness_test.exs:26:11: DataDiode.LongTermRobustnessTest."test TCPHandler exhaustive branch coverage"/1

    warning: variable "pid3" is unused (if the variable is not meant to be used, prefix it with an underscore)
    │
 62 │     {:ok, pid3} = TCPHandler.start_link(s3)
    │           ~~~~
    │
    └─ test/long_term_robustness_test.exs:62:11: DataDiode.LongTermRobustnessTest."test TCPHandler exhaustive branch coverage"/1

............16:04:47.288 [info] Child of Supervisor :inet_gethost_native_sup started
Pid: #PID<0.372.0>
Start Call: :inet_gethost_native.init([])
16:04:47.288 [debug] Child :inet_gethost_native_sup of Supervisor :kernel_safe_sup started
Pid: #PID<0.371.0>
Start Call: :inet_gethost_native.start_link()
Restart: :temporary
Shutdown: 1000
Type: :worker
.16:04:47.297 [info] S1: Connection closed by 1.2.3.4:80
.16:04:47.298 [warning] S1: Dropping oversized packet (1048577 bytes) from 1.2.3.4
.16:04:47.298 [info] S1: Forwarded 11 bytes.
16:04:47.302 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 23 bytes.
.16:04:47.302 [debug] S2: Successfully wrote 23 bytes to ./data_1766120687302_3_51210.dat. (Simulated secure write)
.16:04:47.302 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 0 bytes.
16:04:47.302 [debug] S2: Successfully wrote 0 bytes to ./data_1766120687302_4_51210.dat. (Simulated secure write)
.16:04:47.304 [error] S2: Failed to parse header: invalid_packet_size
.16:04:47.304 [error] S2: Failed to parse header: invalid_packet_size
.16:04:47.304 [info] S2: Decapsulated packet from 0.0.0.0:0. Payload size: 0 bytes.
16:04:47.304 [debug] S2: Successfully wrote 0 bytes to ./data_1766120687304_5_0.dat. (Simulated secure write)
16:04:47.304 [error] S2: Failed to parse header: invalid_packet_size
.16:04:47.304 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 23 bytes.
.16:04:47.304 [debug] S2: Successfully wrote 23 bytes to ./data_1766120687304_6_51210.dat. (Simulated secure write)
16:04:47.304 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 9 bytes.
.16:04:47.304 [debug] S2: Successfully wrote 9 bytes to ./data_1766120687304_7_80.dat. (Simulated secure write)
.16:04:47.309 [debug] S1: TCPHandler received unexpected message: :unknown
.16:04:47.309 [error] S1: TCP error for 1.2.3.4: :econnreset
.16:04:47.309 [debug] S1: TCPHandler received unexpected message: :accept_loop
...16:04:47.337 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.230.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:47.337 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.403.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:04:47.347 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.403.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:47.347 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.405.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:04:47.358 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.405.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:47.358 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.407.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:47.369 [warning] S1 Encapsulator: Invalid IP invalid, dropping packet.
.16:04:47.470 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.407.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:47.470 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.409.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:04:47.527 [debug] S1: TCPHandler received unexpected message: :accept_loop
....16:04:47.699 [info] S1: New connection accepted.
16:04:47.699 [info] S1: New connection accepted.
16:04:47.700 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.53>}
16:04:47.700 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.56>}
16:04:47.701 [info] S1: New connection accepted.
16:04:47.701 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.59>}
16:04:47.701 [info] S1: New connection accepted.
16:04:47.701 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.60>}
16:04:47.701 [info] S1: New connection accepted.
16:04:47.701 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.61>}
........16:04:47.956 [info] S1: Starting TCP Listener on port 8092...
16:04:47.957 [info] S1: New connection accepted.
16:04:47.957 [info] S1: New connection accepted.
16:04:47.957 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.67>}
16:04:47.957 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.69>}
16:04:47.957 [info] S1: New connection accepted.
16:04:47.957 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.71>}
16:04:47.957 [info] S1: New connection accepted.
16:04:47.957 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.73>}
16:04:47.957 [info] S1: New connection accepted.
16:04:47.958 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.75>}
16:04:47.958 [info] S1: New connection accepted.
16:04:47.958 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.77>}
16:04:47.958 [info] S1: New connection accepted.
16:04:47.958 [info] S1: New connection accepted.
16:04:47.958 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.79>}
16:04:47.958 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.81>}
16:04:47.958 [info] S1: New connection accepted.
16:04:47.958 [info] S1: New connection accepted.
16:04:47.958 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.83>}
16:04:47.959 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.85>}
16:04:47.959 [info] S1: New connection accepted.
16:04:47.959 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.87>}
16:04:47.959 [info] S1: New connection accepted.
16:04:47.959 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.89>}
16:04:47.959 [info] S1: New connection accepted.
16:04:47.959 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.91>}
16:04:47.959 [info] S1: New connection accepted.
16:04:47.959 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.93>}
16:04:47.959 [info] S1: New connection accepted.
16:04:47.960 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.95>}
16:04:47.960 [info] S1: New connection accepted.
16:04:47.960 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.97>}
16:04:47.960 [info] S1: New connection accepted.
16:04:47.960 [info] S1: New connection accepted.
16:04:47.960 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.99>}
16:04:47.960 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.101>}
16:04:47.960 [info] S1: New connection accepted.
16:04:47.961 [info] S1: New connection accepted.
16:04:47.961 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.103>}
16:04:47.961 [info] S1: New connection accepted.
16:04:47.961 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.105>}
16:04:47.961 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.107>}
16:04:47.961 [info] S1: New connection accepted.
16:04:47.961 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.109>}
16:04:47.961 [info] S1: New connection accepted.
16:04:47.961 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.111>}
16:04:47.961 [info] S1: New connection accepted.
16:04:47.962 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.113>}
16:04:47.962 [info] S1: New connection accepted.
16:04:47.962 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.115>}
16:04:47.962 [info] S1: New connection accepted.
16:04:47.962 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.117>}
16:04:47.962 [info] S1: New connection accepted.
16:04:47.962 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.119>}
16:04:47.962 [info] S1: New connection accepted.
16:04:47.962 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.121>}
16:04:47.962 [info] S1: New connection accepted.
16:04:47.962 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.123>}
16:04:47.963 [info] S1: New connection accepted.
16:04:47.963 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.125>}
16:04:47.963 [info] S1: New connection accepted.
16:04:47.963 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.127>}
16:04:47.963 [info] S1: New connection accepted.
16:04:47.963 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.129>}
16:04:47.963 [info] S1: New connection accepted.
16:04:47.963 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.131>}
16:04:47.963 [info] S1: New connection accepted.
16:04:47.963 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.133>}
16:04:47.963 [info] S1: New connection accepted.
16:04:47.963 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.135>}
16:04:47.964 [info] S1: New connection accepted.
16:04:47.964 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.137>}
16:04:47.964 [info] S1: New connection accepted.
16:04:47.964 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.139>}
16:04:47.964 [info] S1: New connection accepted.
16:04:47.964 [info] S1: New connection accepted.
16:04:47.964 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.141>}
16:04:47.964 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.143>}
16:04:47.964 [info] S1: New connection accepted.
16:04:47.964 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.145>}
16:04:47.965 [info] S1: New connection accepted.
16:04:47.965 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.147>}
16:04:47.965 [info] S1: New connection accepted.
16:04:47.965 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.149>}
16:04:47.965 [info] S1: New connection accepted.
16:04:47.965 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.151>}
16:04:47.965 [info] S1: New connection accepted.
16:04:47.965 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.153>}
16:04:47.965 [info] S1: New connection accepted.
16:04:47.965 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.155>}
16:04:47.966 [info] S1: New connection accepted.
16:04:47.966 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.157>}
16:04:47.966 [info] S1: New connection accepted.
16:04:47.966 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.159>}
16:04:47.966 [info] S1: New connection accepted.
16:04:47.966 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.161>}
16:04:47.966 [info] S1: New connection accepted.
16:04:47.966 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.163>}
16:04:47.966 [info] S1: New connection accepted.
16:04:47.966 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.165>}
...16:04:48.467 [error] S1: Listener socket fatal error: :closed. Terminating.
.16:04:48.468 [info] S1: Starting TCP Listener on port 0...
...16:04:48.468 [info] S1: Starting TCP Listener on port 0...
16:04:48.969 [info] S1: New connection accepted.
..16:04:49.470 [warning] S1: Invalid LISTEN_IP invalid, using all interfaces.
.16:04:49.471 [info] S1: Starting TCP Listener on port 0...
16:04:49.971 [error] S1: Listener socket fatal error: :closed. Terminating.
16:04:49.971 [error] GenServer :s1_flapping_test_unique terminating
** (stop) :closed
Last message: :accept_loop
State: #Port<0.172>
16:04:49.971 [error] Process :s1_flapping_test_unique (#PID<0.588.0>) terminating
** (exit) :closed
    (stdlib 7.1) gen_server.erl:2562: :gen_server.handle_common_reply/5
    (stdlib 7.1) proc_lib.erl:333: :proc_lib.init_p_do_apply/3
Initial Call: DataDiode.S1.Listener.init/1
Ancestors: [#PID<0.587.0>]
Message Queue Length: 0
Messages: []
Links: []
Dictionary: []
Trapping Exits: false
Status: :running
Heap Size: 2586
Stack Size: 29
Reductions: 2708
.16:04:49.983 [debug] SystemMonitor: Received unexpected message: :unexp
16:04:49.987 [debug] S1: TCPHandler received unexpected message: :unexp
16:04:49.987 [info] S1: Starting TCP Listener on port 0...
16:04:49.987 [debug] S1: Listener received unexpected message: :unexp
16:04:50.707 [info] S2: Starting UDP Listener on port 0...
16:04:50.707 [warning] S2: Received unexpected message: :unexp
16:04:50.707 [error] S2: UDP Listener socket closed unexpectedly. Terminating.
16:04:50.710 [info] DiskCleaner: Low disk space detected on . (< 15%). Starting autonomous cleanup...
16:04:50.710 [warning] DiskCleaner: Simulation - would delete oldest .dat files in . now.
16:04:50.714 [info] S2: Decapsulated packet from 127.0.0.1:20480. Payload size: 7 bytes.
16:04:50.714 [debug] S2: Successfully wrote 7 bytes to /tmp/diode_test/data_1766120690714_64_20480.dat. (Simulated secure write)
16:04:50.714 [info] S2: Decapsulated packet from 127.0.0.1:0. Payload size: 9 bytes.
16:04:50.715 [debug] S1: Generating end-to-end heartbeat.
16:04:50.715 [warning] S1 Heartbeat: Received unexpected message: :unexp
16:04:50.715 [error] S2: Critical Failure! Channel heartbeat missing for > 6 minutes. The diode path may be obstructed.
16:04:50.715 [warning] S2 HeartbeatMonitor: Received unexpected message: :unexp
.16:04:50.716 [info] S2: Starting UDP Listener on port 0...
.16:04:50.716 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.716 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690716_65_80.dat. (Simulated secure write)
16:04:50.716 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.716 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690716_66_80.dat. (Simulated secure write)
16:04:50.716 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.716 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690716_67_80.dat. (Simulated secure write)
16:04:50.716 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.716 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690716_68_80.dat. (Simulated secure write)
16:04:50.716 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.716 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690716_69_80.dat. (Simulated secure write)
16:04:50.716 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.716 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690716_70_80.dat. (Simulated secure write)
16:04:50.717 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.717 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690717_71_80.dat. (Simulated secure write)
16:04:50.717 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.717 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690717_72_80.dat. (Simulated secure write)
16:04:50.717 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.717 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690717_73_80.dat. (Simulated secure write)
16:04:50.717 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.717 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690717_74_80.dat. (Simulated secure write)
16:04:50.717 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.717 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.717 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690717_75_80.dat. (Simulated secure write)
16:04:50.717 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690717_76_80.dat. (Simulated secure write)
16:04:50.717 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.717 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690717_77_80.dat. (Simulated secure write)
16:04:50.717 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.717 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690717_78_80.dat. (Simulated secure write)
16:04:50.717 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.717 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690717_79_80.dat. (Simulated secure write)
16:04:50.717 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.717 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690717_80_80.dat. (Simulated secure write)
16:04:50.717 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.717 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690717_81_80.dat. (Simulated secure write)
16:04:50.717 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.717 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690717_82_80.dat. (Simulated secure write)
16:04:50.718 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.718 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690718_83_80.dat. (Simulated secure write)
16:04:50.718 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.718 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690718_84_80.dat. (Simulated secure write)
16:04:50.718 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.718 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690718_85_80.dat. (Simulated secure write)
16:04:50.718 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.718 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690718_86_80.dat. (Simulated secure write)
16:04:50.718 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.718 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690718_87_80.dat. (Simulated secure write)
16:04:50.718 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.718 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690718_88_80.dat. (Simulated secure write)
16:04:50.718 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.718 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690718_89_80.dat. (Simulated secure write)
16:04:50.718 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.718 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690718_90_80.dat. (Simulated secure write)
16:04:50.718 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.718 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690718_91_80.dat. (Simulated secure write)
16:04:50.718 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.718 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690718_92_80.dat. (Simulated secure write)
16:04:50.718 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.718 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690718_93_80.dat. (Simulated secure write)
16:04:50.718 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.718 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690718_94_80.dat. (Simulated secure write)
16:04:50.718 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.719 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690719_95_80.dat. (Simulated secure write)
16:04:50.719 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.719 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690719_96_80.dat. (Simulated secure write)
16:04:50.719 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.719 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690719_97_80.dat. (Simulated secure write)
16:04:50.719 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.719 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690719_98_80.dat. (Simulated secure write)
16:04:50.719 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.719 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690719_99_80.dat. (Simulated secure write)
16:04:50.719 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.719 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690719_100_80.dat. (Simulated secure write)
16:04:50.719 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.719 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690719_101_80.dat. (Simulated secure write)
16:04:50.719 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.719 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690719_102_80.dat. (Simulated secure write)
16:04:50.719 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.719 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690719_103_80.dat. (Simulated secure write)
16:04:50.719 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.719 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690719_104_80.dat. (Simulated secure write)
16:04:50.719 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.719 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690719_105_80.dat. (Simulated secure write)
16:04:50.719 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.719 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690719_106_80.dat. (Simulated secure write)
16:04:50.719 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.719 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690719_107_80.dat. (Simulated secure write)
16:04:50.719 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.719 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690719_108_80.dat. (Simulated secure write)
16:04:50.719 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.719 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690719_109_80.dat. (Simulated secure write)
16:04:50.719 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.719 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690719_110_80.dat. (Simulated secure write)
16:04:50.720 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.720 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690720_111_80.dat. (Simulated secure write)
16:04:50.720 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.720 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690720_112_80.dat. (Simulated secure write)
16:04:50.720 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.720 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690720_113_80.dat. (Simulated secure write)
16:04:50.720 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.720 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690720_114_80.dat. (Simulated secure write)
16:04:50.720 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.720 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690720_115_80.dat. (Simulated secure write)
16:04:50.720 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.720 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690720_116_80.dat. (Simulated secure write)
16:04:50.720 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.720 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690720_117_80.dat. (Simulated secure write)
16:04:50.720 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.720 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690720_118_80.dat. (Simulated secure write)
16:04:50.720 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.720 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690720_119_80.dat. (Simulated secure write)
16:04:50.720 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.720 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690720_120_80.dat. (Simulated secure write)
16:04:50.720 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.720 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690720_121_80.dat. (Simulated secure write)
16:04:50.720 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.720 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690720_122_80.dat. (Simulated secure write)
16:04:50.720 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.720 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690720_123_80.dat. (Simulated secure write)
16:04:50.720 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.720 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690720_124_80.dat. (Simulated secure write)
16:04:50.720 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.720 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690720_125_80.dat. (Simulated secure write)
16:04:50.720 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.720 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690720_126_80.dat. (Simulated secure write)
16:04:50.721 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.721 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690721_127_80.dat. (Simulated secure write)
16:04:50.721 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.721 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690721_128_80.dat. (Simulated secure write)
16:04:50.721 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.721 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690721_129_80.dat. (Simulated secure write)
16:04:50.721 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.721 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690721_130_80.dat. (Simulated secure write)
16:04:50.721 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.721 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690721_131_80.dat. (Simulated secure write)
16:04:50.721 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.721 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690721_132_80.dat. (Simulated secure write)
16:04:50.721 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.721 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690721_133_80.dat. (Simulated secure write)
16:04:50.721 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.721 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690721_134_80.dat. (Simulated secure write)
16:04:50.721 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.721 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690721_135_80.dat. (Simulated secure write)
16:04:50.721 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.721 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.721 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690721_136_80.dat. (Simulated secure write)
16:04:50.721 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690721_137_80.dat. (Simulated secure write)
16:04:50.721 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.721 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690721_138_80.dat. (Simulated secure write)
16:04:50.721 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.721 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690721_139_80.dat. (Simulated secure write)
16:04:50.721 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.721 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690721_140_80.dat. (Simulated secure write)
16:04:50.721 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.721 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690721_141_80.dat. (Simulated secure write)
16:04:50.721 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.721 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690721_142_80.dat. (Simulated secure write)
16:04:50.722 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.722 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690722_143_80.dat. (Simulated secure write)
16:04:50.722 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.722 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690722_144_80.dat. (Simulated secure write)
16:04:50.722 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.722 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690722_145_80.dat. (Simulated secure write)
16:04:50.722 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.722 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690722_146_80.dat. (Simulated secure write)
16:04:50.722 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.722 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690722_147_80.dat. (Simulated secure write)
16:04:50.722 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.722 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690722_148_80.dat. (Simulated secure write)
16:04:50.722 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.722 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.722 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690722_149_80.dat. (Simulated secure write)
16:04:50.722 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690722_150_80.dat. (Simulated secure write)
16:04:50.722 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.722 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690722_151_80.dat. (Simulated secure write)
16:04:50.722 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.722 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690722_152_80.dat. (Simulated secure write)
16:04:50.722 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.722 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.722 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690722_153_80.dat. (Simulated secure write)
16:04:50.722 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.722 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690722_154_80.dat. (Simulated secure write)
16:04:50.722 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.722 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690722_155_80.dat. (Simulated secure write)
16:04:50.722 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.722 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690722_156_80.dat. (Simulated secure write)
16:04:50.722 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.722 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690722_157_80.dat. (Simulated secure write)
16:04:50.722 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.722 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690722_158_80.dat. (Simulated secure write)
16:04:50.722 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.722 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690722_159_80.dat. (Simulated secure write)
16:04:50.723 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.723 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690723_160_80.dat. (Simulated secure write)
16:04:50.723 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.723 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690723_161_80.dat. (Simulated secure write)
16:04:50.723 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.723 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:50.723 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690723_162_80.dat. (Simulated secure write)
16:04:50.723 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690723_163_80.dat. (Simulated secure write)
16:04:50.723 [debug] S2: Successfully wrote 7 bytes to ./data_1766120690723_164_80.dat. (Simulated secure write)
..16:04:50.823 [warning] S2: Invalid LISTEN_IP_S2 invalid, falling back to all interfaces.
.16:04:50.823 [info] S2: Starting UDP Listener on port 0...
..16:04:50.844 [info] S2: Starting UDP Listener on port 0...
16:04:50.844 [info] S2: Decapsulated packet from 1.2.3.4:80. Payload size: 5 bytes.
16:04:50.844 [debug] S2: Successfully wrote 5 bytes to ./data_1766120690844_165_80.dat. (Simulated secure write)
.16:04:50.855 [error] S2: UDP Listener socket closed unexpectedly. Terminating.
.16:04:50.855 [info] S2: Starting UDP Listener on port 0...
.
Finished in 3.6 seconds (0.1s async, 3.5s sync)
1 doctest, 65 tests, 0 failures
Run 6
warning: setting :preferred_cli_env in your mix.exs "def project" is deprecated, set it inside "def cli" instead:

    def cli do
      [preferred_envs: [release: :prod, test: :test]]
    end

  (mix 1.19.4) lib/mix/cli.ex:187: Mix.CLI.preferred_cli_env/3
  (mix 1.19.4) lib/mix/cli.ex:170: Mix.CLI.maybe_change_env_and_target/2
  (mix 1.19.4) lib/mix/cli.ex:59: Mix.CLI.proceed/2
  /opt/homebrew/bin/mix:7: (file)
  (elixir 1.19.4) src/elixir_compiler.erl:81: :elixir_compiler.dispatch/4
  (elixir 1.19.4) src/elixir_compiler.erl:56: :elixir_compiler.compile/4

    warning: unused alias Decapsulator
    │
  8 │   alias DataDiode.S2.Decapsulator
    │   ~
    │
    └─ lib/data_diode/s2/listener.ex:8:3

16:04:51.354 [info] Application logger started at :nonode@nohost
16:04:51.359 [info] Child :ttb_autostart of Supervisor :runtime_tools_sup started
Pid: #PID<0.184.0>
Start Call: :ttb_autostart.start_link()
Restart: :temporary
Shutdown: 3000
Type: :worker
16:04:51.359 [info] Application runtime_tools started at :nonode@nohost
16:04:51.359 [info] Application opentelemetry_api started at :nonode@nohost
16:04:51.359 [info] Application ctx started at :nonode@nohost
16:04:51.359 [info] Application hpack started at :nonode@nohost
16:04:51.359 [info] Application chatterbox started at :nonode@nohost
16:04:51.359 [info] Application acceptor_pool started at :nonode@nohost
16:04:51.365 [info] Child :gproc of Supervisor :gproc_sup started
Pid: #PID<0.188.0>
Start Call: :gproc.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:04:51.366 [info] Child :gproc_monitor of Supervisor :gproc_sup started
Pid: #PID<0.189.0>
Start Call: :gproc_monitor.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:04:51.367 [info] Child :gproc_bcast of Supervisor :gproc_sup started
Pid: #PID<0.190.0>
Start Call: :gproc_bcast.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:04:51.368 [info] Child :gproc_pool of Supervisor :gproc_sup started
Pid: #PID<0.191.0>
Start Call: :gproc_pool.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:04:51.368 [info] Application gproc started at :nonode@nohost
16:04:51.370 [info] Child :grpcbox_services_simple_sup of Supervisor :grpcbox_sup started
Pid: #PID<0.195.0>
Start Call: :grpcbox_services_simple_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:04:51.370 [info] Child :grpcbox_channel_sup of Supervisor :grpcbox_sup started
Pid: #PID<0.196.0>
Start Call: :grpcbox_channel_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:04:51.370 [info] Application grpcbox started at :nonode@nohost
16:04:51.370 [info] Application ssl_verify_fun started at :nonode@nohost
16:04:51.439 [info] Loading 162 CA(s) from :otp store
16:04:51.439 [info] Child :tls_certificate_check_shared_state of Supervisor :tls_certificate_check_sup started
Pid: #PID<0.200.0>
Start Call: :tls_certificate_check_shared_state.start_link()
Restart: :permanent
Shutdown: :infinity
Type: :worker
16:04:51.439 [info] Application tls_certificate_check started at :nonode@nohost
16:04:51.439 [info] Application opentelemetry_exporter started at :nonode@nohost
16:04:51.445 [info] Child :otel_span_ets of Supervisor :otel_span_sup started
Pid: #PID<0.208.0>
Start Call: :otel_span_ets.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:51.446 [info] Child :otel_span_sweeper of Supervisor :otel_span_sup started
Pid: #PID<0.209.0>
Start Call: :otel_span_sweeper.start_link(%{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:51.446 [info] Child :otel_span_sup of Supervisor :opentelemetry_sup started
Pid: #PID<0.207.0>
Start Call: :otel_span_sup.start_link(%{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:04:51.449 [info] Child :otel_resource_detector of Supervisor :opentelemetry_sup started
Pid: #PID<0.210.0>
Start Call: :otel_resource_detector.start_link(%{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:51.450 [info] Child :otel_tracer_provider_sup of Supervisor :opentelemetry_sup started
Pid: #PID<0.213.0>
Start Call: :otel_tracer_provider_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:04:51.452 [info] Child :otel_span_processor_sup of Supervisor #PID<0.214.0> (:otel_tracer_server_sup) started
Pid: #PID<0.215.0>
Start Call: :otel_span_processor_sup.start_link(:otel_span_processor_sup_global)
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:04:51.457 [info] Child :otel_tracer_server of Supervisor #PID<0.214.0> (:otel_tracer_server_sup) started
Pid: #PID<0.216.0>
Start Call: :otel_tracer_server.start_link(:global, :otel_tracer_provider_global, :otel_span_processor_sup_global, {:resource, :undefined, {:attributes, 128, 255, 0, %{"process.executable.name": "erl", "process.runtime.description": "Erlang/OTP 28 erts-16.1.2", "process.runtime.version": "16.1.2", "process.runtime.name": "BEAM", "service.name": "unknown_service:erl", "service.instance.id": 255560331424532665248960053565792722691, "telemetry.sdk.version": "1.6.0", "telemetry.sdk.language": "erlang", "telemetry.sdk.name": "opentelemetry"}}}, %{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:51.459 [debug] Child {:httpc, :"otel_exporter_otlp_<0.217.0>"} of Supervisor :httpc_profile_sup started
Pid: #PID<0.218.0>
Start Call: :httpc_manager.start_link(:"otel_exporter_otlp_<0.217.0>", :only_session_cookies, :inets)
Restart: :permanent
Shutdown: 4000
Type: :worker
16:04:51.463 [info] OTLP exporter successfully initialized
16:04:51.464 [info] Application opentelemetry started at :nonode@nohost
16:04:51.465 [info] Application jason started at :nonode@nohost
16:04:51.465 [info] Application logger_json started at :nonode@nohost
16:04:51.465 [info] Application nimble_ownership started at :nonode@nohost
16:04:51.468 [info] Child Mox of Supervisor Mox.Supervisor started
Pid: #PID<0.222.0>
Start Call: Mox.start_link_ownership()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:51.468 [info] Application mox started at :nonode@nohost
16:04:51.473 [info] Child DataDiode.Metrics of Supervisor DataDiode.Supervisor started
Pid: #PID<0.226.0>
Start Call: DataDiode.Metrics.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:51.473 [info] Child DataDiode.SystemMonitor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.227.0>
Start Call: DataDiode.SystemMonitor.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:51.474 [info] S1: Starting TCP Listener on port 0...
16:04:51.474 [info] Child DataDiode.S1.Listener of Supervisor DataDiode.Supervisor started
Pid: #PID<0.228.0>
Start Call: DataDiode.S1.Listener.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:51.476 [info] Child DataDiode.S1.HandlerSupervisor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.229.0>
Start Call: DataDiode.S1.HandlerSupervisor.start_link()
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:04:51.477 [warning] S1 Encapsulator: Invalid S2_PORT 0, using default 42001
16:04:51.477 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.230.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:51.478 [info] Child DataDiode.S1.Heartbeat of Supervisor DataDiode.Supervisor started
Pid: #PID<0.231.0>
Start Call: DataDiode.S1.Heartbeat.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:51.478 [info] Child DataDiode.S2.HeartbeatMonitor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.232.0>
Start Call: DataDiode.S2.HeartbeatMonitor.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:51.478 [info] Child DataDiode.DiskCleaner of Supervisor DataDiode.Supervisor started
Pid: #PID<0.233.0>
Start Call: DataDiode.DiskCleaner.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:51.478 [info] S2: Starting UDP Listener on port 0...
16:04:51.478 [info] Child DataDiode.S2.Listener of Supervisor DataDiode.Supervisor started
Pid: #PID<0.234.0>
Start Call: DataDiode.S2.Listener.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:51.478 [info] Child DataDiode.S2.TaskSupervisor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.235.0>
Start Call: Task.Supervisor.start_link([name: DataDiode.S2.TaskSupervisor, max_children: 200])
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:04:51.478 [info] Application data_diode started at :nonode@nohost
16:04:51.483 [info] Child ExUnit.Server of Supervisor ExUnit.Supervisor started
Pid: #PID<0.241.0>
Start Call: ExUnit.Server.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:51.483 [info] Child ExUnit.CaptureServer of Supervisor ExUnit.Supervisor started
Pid: #PID<0.242.0>
Start Call: ExUnit.CaptureServer.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:51.483 [info] Application ex_unit started at :nonode@nohost
Running ExUnit with seed: 484956, max_cases: 16

     warning: redefining module DataDiode.S1.EncapsulatorMock (current version defined in memory)
     │
 491 │     Module.create(name, [info | body], Macro.Env.location(__ENV__))
     │     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     │
     └─ deps/mox/lib/mox.ex:491: DataDiode.S1.EncapsulatorMock (module)

    warning: variable "c" is unused (if the variable is not meant to be used, prefix it with an underscore)
    │
 26 │     {:ok, c} = :gen_tcp.connect({127,0,0,1}, port, [:binary, active: false])
    │           ~
    │
    └─ test/long_term_robustness_test.exs:26:11: DataDiode.LongTermRobustnessTest."test TCPHandler exhaustive branch coverage"/1

    warning: variable "pid3" is unused (if the variable is not meant to be used, prefix it with an underscore)
    │
 62 │     {:ok, pid3} = TCPHandler.start_link(s3)
    │           ~~~~
    │
    └─ test/long_term_robustness_test.exs:62:11: DataDiode.LongTermRobustnessTest."test TCPHandler exhaustive branch coverage"/1

......16:04:51.578 [info] Child of Supervisor :inet_gethost_native_sup started
Pid: #PID<0.355.0>
Start Call: :inet_gethost_native.init([])
16:04:51.578 [debug] Child :inet_gethost_native_sup of Supervisor :kernel_safe_sup started
Pid: #PID<0.354.0>
Start Call: :inet_gethost_native.start_link()
Restart: :temporary
Shutdown: 1000
Type: :worker
......16:04:51.597 [error] S2: Failed to parse header: invalid_packet_size
.16:04:51.597 [error] S2: Failed to parse header: invalid_packet_size
.16:04:51.598 [error] S2: Failed to parse header: invalid_packet_size
.16:04:51.598 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 9 bytes.
16:04:51.598 [debug] S2: Successfully wrote 9 bytes to ./data_1766120691598_3_80.dat. (Simulated secure write)
.16:04:51.598 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 23 bytes.
.16:04:51.598 [debug] S2: Successfully wrote 23 bytes to ./data_1766120691598_4_51210.dat. (Simulated secure write)
16:04:51.598 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 23 bytes.
16:04:51.598 [debug] S2: Successfully wrote 23 bytes to ./data_1766120691598_5_51210.dat. (Simulated secure write)
.16:04:51.598 [info] S2: Decapsulated packet from 0.0.0.0:0. Payload size: 0 bytes.
.16:04:51.598 [debug] S2: Successfully wrote 0 bytes to ./data_1766120691598_6_0.dat. (Simulated secure write)
16:04:51.598 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 0 bytes.
.16:04:51.598 [debug] S2: Successfully wrote 0 bytes to ./data_1766120691598_7_51210.dat. (Simulated secure write)
.16:04:51.599 [warning] S1: Dropping oversized packet (1048577 bytes) from 1.2.3.4
..16:04:51.600 [debug] S1: TCPHandler received unexpected message: :accept_loop
.16:04:51.600 [error] S1: TCP error for 1.2.3.4: :econnreset
.16:04:51.600 [debug] S1: TCPHandler received unexpected message: :unknown
.16:04:51.601 [info] S1: Connection closed by 1.2.3.4:80
...16:04:51.979 [info] S1: New connection accepted.
16:04:51.981 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.38>}
16:04:51.981 [info] S1: New connection accepted.
16:04:51.981 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.41>}
16:04:51.981 [info] S1: New connection accepted.
16:04:51.981 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.43>}
16:04:51.981 [info] S1: New connection accepted.
16:04:51.981 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.45>}
16:04:51.981 [info] S1: New connection accepted.
16:04:51.981 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.46>}
.16:04:52.233 [debug] S1: TCPHandler received unexpected message: :accept_loop
..16:04:52.286 [info] S2: Starting UDP Listener on port 0...
16:04:52.286 [info] S2: Decapsulated packet from 1.2.3.4:80. Payload size: 5 bytes.
16:04:52.286 [debug] S2: Successfully wrote 5 bytes to ./data_1766120692286_13_80.dat. (Simulated secure write)
.16:04:52.296 [warning] S2: Invalid LISTEN_IP_S2 invalid, falling back to all interfaces.
..16:04:52.297 [info] S2: Starting UDP Listener on port 0...
..16:04:52.297 [info] S2: Starting UDP Listener on port 0...
.16:04:52.319 [error] S2: UDP Listener socket closed unexpectedly. Terminating.
..16:04:52.319 [info] S2: Starting UDP Listener on port 0...
16:04:52.320 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.320 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692320_14_80.dat. (Simulated secure write)
16:04:52.320 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.320 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692320_15_80.dat. (Simulated secure write)
16:04:52.320 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.320 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692320_16_80.dat. (Simulated secure write)
16:04:52.320 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.320 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.320 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692320_17_80.dat. (Simulated secure write)
16:04:52.320 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692320_18_80.dat. (Simulated secure write)
16:04:52.321 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.321 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692321_19_80.dat. (Simulated secure write)
16:04:52.321 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.321 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692321_20_80.dat. (Simulated secure write)
16:04:52.321 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.321 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692321_21_80.dat. (Simulated secure write)
16:04:52.321 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.321 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692321_22_80.dat. (Simulated secure write)
16:04:52.321 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.321 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692321_23_80.dat. (Simulated secure write)
16:04:52.322 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.322 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692322_24_80.dat. (Simulated secure write)
16:04:52.322 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.322 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692322_25_80.dat. (Simulated secure write)
16:04:52.322 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.322 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692322_26_80.dat. (Simulated secure write)
16:04:52.322 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.322 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692322_27_80.dat. (Simulated secure write)
16:04:52.322 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.322 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692322_28_80.dat. (Simulated secure write)
16:04:52.322 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.322 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692322_29_80.dat. (Simulated secure write)
16:04:52.323 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.323 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692323_30_80.dat. (Simulated secure write)
16:04:52.323 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.323 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692323_31_80.dat. (Simulated secure write)
16:04:52.323 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.323 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692323_32_80.dat. (Simulated secure write)
16:04:52.323 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.323 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692323_33_80.dat. (Simulated secure write)
16:04:52.323 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.323 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692323_34_80.dat. (Simulated secure write)
16:04:52.323 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.323 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692323_35_80.dat. (Simulated secure write)
16:04:52.323 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.323 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692323_36_80.dat. (Simulated secure write)
16:04:52.324 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.324 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692324_37_80.dat. (Simulated secure write)
16:04:52.324 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.324 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692324_38_80.dat. (Simulated secure write)
16:04:52.324 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.324 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692324_39_80.dat. (Simulated secure write)
16:04:52.324 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.324 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692324_40_80.dat. (Simulated secure write)
16:04:52.324 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.324 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692324_41_80.dat. (Simulated secure write)
16:04:52.324 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.324 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692324_42_80.dat. (Simulated secure write)
16:04:52.324 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.324 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692324_43_80.dat. (Simulated secure write)
16:04:52.324 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.324 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692324_44_80.dat. (Simulated secure write)
16:04:52.325 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.325 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692325_45_80.dat. (Simulated secure write)
16:04:52.325 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.325 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692325_46_80.dat. (Simulated secure write)
16:04:52.325 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.325 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692325_47_80.dat. (Simulated secure write)
16:04:52.325 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.325 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692325_48_80.dat. (Simulated secure write)
16:04:52.325 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.325 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692325_49_80.dat. (Simulated secure write)
16:04:52.325 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.325 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692325_50_80.dat. (Simulated secure write)
16:04:52.325 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.325 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692325_51_80.dat. (Simulated secure write)
16:04:52.325 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.325 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692325_52_80.dat. (Simulated secure write)
16:04:52.325 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.325 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692325_53_80.dat. (Simulated secure write)
16:04:52.326 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.326 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692326_54_80.dat. (Simulated secure write)
16:04:52.326 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.326 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692326_55_80.dat. (Simulated secure write)
16:04:52.326 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.326 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692326_56_80.dat. (Simulated secure write)
16:04:52.326 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.326 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692326_57_80.dat. (Simulated secure write)
16:04:52.326 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.326 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692326_58_80.dat. (Simulated secure write)
16:04:52.326 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.326 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692326_59_80.dat. (Simulated secure write)
16:04:52.327 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.327 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692327_60_80.dat. (Simulated secure write)
16:04:52.327 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.327 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692327_61_80.dat. (Simulated secure write)
16:04:52.327 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.327 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692327_62_80.dat. (Simulated secure write)
16:04:52.327 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.327 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692327_63_80.dat. (Simulated secure write)
16:04:52.327 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.327 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692327_64_80.dat. (Simulated secure write)
16:04:52.327 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.327 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692327_65_80.dat. (Simulated secure write)
16:04:52.328 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.328 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692328_66_80.dat. (Simulated secure write)
16:04:52.328 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.328 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692328_67_80.dat. (Simulated secure write)
16:04:52.328 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.328 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692328_68_80.dat. (Simulated secure write)
16:04:52.328 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.328 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692328_69_80.dat. (Simulated secure write)
16:04:52.328 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.328 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692328_70_80.dat. (Simulated secure write)
16:04:52.328 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.328 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692328_71_80.dat. (Simulated secure write)
16:04:52.328 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.328 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692328_72_80.dat. (Simulated secure write)
16:04:52.328 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.328 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692328_73_80.dat. (Simulated secure write)
16:04:52.329 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.329 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692329_74_80.dat. (Simulated secure write)
16:04:52.329 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.329 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692329_75_80.dat. (Simulated secure write)
16:04:52.329 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.329 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692329_76_80.dat. (Simulated secure write)
16:04:52.329 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.329 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692329_77_80.dat. (Simulated secure write)
16:04:52.329 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.329 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692329_78_80.dat. (Simulated secure write)
16:04:52.329 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.329 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692329_79_80.dat. (Simulated secure write)
16:04:52.329 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.330 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692330_80_80.dat. (Simulated secure write)
16:04:52.330 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.330 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692330_81_80.dat. (Simulated secure write)
16:04:52.330 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.330 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692330_82_80.dat. (Simulated secure write)
16:04:52.330 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.330 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692330_83_80.dat. (Simulated secure write)
16:04:52.330 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.330 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692330_84_80.dat. (Simulated secure write)
16:04:52.330 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.330 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692330_85_80.dat. (Simulated secure write)
16:04:52.330 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.330 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692330_86_80.dat. (Simulated secure write)
16:04:52.330 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.330 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692330_87_80.dat. (Simulated secure write)
16:04:52.330 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.330 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692330_88_80.dat. (Simulated secure write)
16:04:52.331 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.331 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692331_89_80.dat. (Simulated secure write)
16:04:52.331 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.331 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692331_90_80.dat. (Simulated secure write)
16:04:52.331 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.331 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692331_91_80.dat. (Simulated secure write)
16:04:52.331 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.331 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692331_92_80.dat. (Simulated secure write)
16:04:52.331 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.331 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692331_93_80.dat. (Simulated secure write)
16:04:52.331 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.331 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692331_94_80.dat. (Simulated secure write)
16:04:52.331 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.331 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692331_95_80.dat. (Simulated secure write)
16:04:52.332 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.332 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692332_96_80.dat. (Simulated secure write)
16:04:52.332 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.332 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692332_97_80.dat. (Simulated secure write)
16:04:52.332 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.332 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692332_98_80.dat. (Simulated secure write)
16:04:52.332 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.332 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692332_99_80.dat. (Simulated secure write)
16:04:52.332 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.332 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692332_100_80.dat. (Simulated secure write)
16:04:52.332 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.332 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692332_101_80.dat. (Simulated secure write)
16:04:52.332 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.332 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692332_102_80.dat. (Simulated secure write)
16:04:52.332 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.332 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692332_103_80.dat. (Simulated secure write)
16:04:52.333 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.333 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692333_104_80.dat. (Simulated secure write)
16:04:52.333 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.333 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692333_105_80.dat. (Simulated secure write)
16:04:52.333 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.333 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692333_106_80.dat. (Simulated secure write)
16:04:52.333 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.333 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692333_107_80.dat. (Simulated secure write)
16:04:52.333 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.333 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692333_108_80.dat. (Simulated secure write)
16:04:52.333 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.333 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692333_109_80.dat. (Simulated secure write)
16:04:52.333 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.333 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692333_110_80.dat. (Simulated secure write)
16:04:52.333 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.333 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692333_111_80.dat. (Simulated secure write)
16:04:52.334 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.334 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692334_112_80.dat. (Simulated secure write)
16:04:52.334 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:52.334 [debug] S2: Successfully wrote 7 bytes to ./data_1766120692334_113_80.dat. (Simulated secure write)
..16:04:52.936 [info] S1: Starting TCP Listener on port 0...
..16:04:52.936 [error] S1: Listener socket fatal error: :closed. Terminating.
.16:04:52.936 [info] S1: Starting TCP Listener on port 0...
16:04:53.436 [error] S1: Listener socket fatal error: :closed. Terminating.
16:04:53.436 [error] GenServer :s1_flapping_test_unique terminating
** (stop) :closed
Last message: :accept_loop
State: #Port<0.64>
16:04:53.437 [error] Process :s1_flapping_test_unique (#PID<0.633.0>) terminating
** (exit) :closed
    (stdlib 7.1) gen_server.erl:2562: :gen_server.handle_common_reply/5
    (stdlib 7.1) proc_lib.erl:333: :proc_lib.init_p_do_apply/3
Initial Call: DataDiode.S1.Listener.init/1
Ancestors: [#PID<0.632.0>]
Message Queue Length: 0
Messages: []
Links: []
Dictionary: []
Trapping Exits: false
Status: :running
Heap Size: 1598
Stack Size: 29
Reductions: 2751
...16:04:53.437 [warning] S1: Invalid LISTEN_IP invalid, using all interfaces.
.16:04:53.437 [info] S1: Starting TCP Listener on port 0...
16:04:53.939 [info] S1: New connection accepted.
..16:04:53.951 [debug] SystemMonitor: Received unexpected message: :unexp
16:04:53.953 [debug] S1: TCPHandler received unexpected message: :unexp
16:04:53.953 [info] S1: Starting TCP Listener on port 0...
16:04:53.953 [debug] S1: Listener received unexpected message: :unexp
16:04:54.487 [info] S2: Starting UDP Listener on port 0...
16:04:54.487 [warning] S2: Received unexpected message: :unexp
16:04:54.487 [error] S2: UDP Listener socket closed unexpectedly. Terminating.
16:04:54.491 [info] DiskCleaner: Low disk space detected on . (< 15%). Starting autonomous cleanup...
16:04:54.491 [warning] DiskCleaner: Simulation - would delete oldest .dat files in . now.
16:04:54.494 [info] S2: Decapsulated packet from 127.0.0.1:20480. Payload size: 7 bytes.
16:04:54.494 [debug] S2: Successfully wrote 7 bytes to /tmp/diode_test/data_1766120694494_115_20480.dat. (Simulated secure write)
16:04:54.494 [info] S2: Decapsulated packet from 127.0.0.1:0. Payload size: 9 bytes.
16:04:54.495 [debug] S1: Generating end-to-end heartbeat.
16:04:54.495 [warning] S1 Heartbeat: Received unexpected message: :unexp
16:04:54.496 [error] S2: Critical Failure! Channel heartbeat missing for > 6 minutes. The diode path may be obstructed.
16:04:54.496 [warning] S2 HeartbeatMonitor: Received unexpected message: :unexp
...16:04:54.497 [info] S1: Starting TCP Listener on port 8092...
16:04:54.497 [info] S1: New connection accepted.
16:04:54.497 [info] S1: New connection accepted.
16:04:54.497 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.79>}
16:04:54.497 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.81>}
16:04:54.497 [info] S1: New connection accepted.
16:04:54.498 [info] S1: New connection accepted.
16:04:54.498 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.83>}
16:04:54.498 [info] S1: New connection accepted.
16:04:54.498 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.85>}
16:04:54.498 [info] S1: New connection accepted.
16:04:54.498 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.87>}
16:04:54.498 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.89>}
16:04:54.498 [info] S1: New connection accepted.
16:04:54.499 [info] S1: New connection accepted.
16:04:54.499 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.91>}
16:04:54.499 [info] S1: New connection accepted.
16:04:54.499 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.93>}
16:04:54.499 [info] S1: New connection accepted.
16:04:54.499 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.95>}
16:04:54.499 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.97>}
16:04:54.499 [info] S1: New connection accepted.
16:04:54.499 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.99>}
16:04:54.499 [info] S1: New connection accepted.
16:04:54.499 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.101>}
16:04:54.500 [info] S1: New connection accepted.
16:04:54.500 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.103>}
16:04:54.500 [info] S1: New connection accepted.
16:04:54.500 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.105>}
16:04:54.500 [info] S1: New connection accepted.
16:04:54.500 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.107>}
16:04:54.500 [info] S1: New connection accepted.
16:04:54.500 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.109>}
16:04:54.500 [info] S1: New connection accepted.
16:04:54.500 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.111>}
16:04:54.500 [info] S1: New connection accepted.
16:04:54.500 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.113>}
16:04:54.500 [info] S1: New connection accepted.
16:04:54.500 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.115>}
16:04:54.501 [info] S1: New connection accepted.
16:04:54.501 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.117>}
16:04:54.501 [info] S1: New connection accepted.
16:04:54.501 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.119>}
16:04:54.501 [info] S1: New connection accepted.
16:04:54.501 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.121>}
16:04:54.501 [info] S1: New connection accepted.
16:04:54.501 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.123>}
16:04:54.501 [info] S1: New connection accepted.
16:04:54.501 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.125>}
16:04:54.501 [info] S1: New connection accepted.
16:04:54.501 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.127>}
16:04:54.501 [info] S1: New connection accepted.
16:04:54.502 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.129>}
16:04:54.502 [info] S1: New connection accepted.
16:04:54.502 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.131>}
16:04:54.502 [info] S1: New connection accepted.
16:04:54.502 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.133>}
16:04:54.502 [info] S1: New connection accepted.
16:04:54.502 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.135>}
16:04:54.502 [info] S1: New connection accepted.
16:04:54.502 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.137>}
16:04:54.502 [info] S1: New connection accepted.
16:04:54.502 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.139>}
16:04:54.502 [info] S1: New connection accepted.
16:04:54.502 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.141>}
16:04:54.502 [info] S1: New connection accepted.
16:04:54.502 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.143>}
16:04:54.503 [info] S1: New connection accepted.
16:04:54.503 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.145>}
16:04:54.503 [info] S1: New connection accepted.
16:04:54.503 [info] S1: New connection accepted.
16:04:54.503 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.147>}
16:04:54.503 [info] S1: New connection accepted.
16:04:54.503 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.149>}
16:04:54.503 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.151>}
16:04:54.503 [info] S1: New connection accepted.
16:04:54.503 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.153>}
16:04:54.503 [info] S1: New connection accepted.
16:04:54.503 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.155>}
16:04:54.503 [info] S1: New connection accepted.
16:04:54.503 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.157>}
16:04:54.504 [info] S1: New connection accepted.
16:04:54.504 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.159>}
16:04:54.504 [info] S1: New connection accepted.
16:04:54.504 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.161>}
16:04:54.504 [info] S1: New connection accepted.
16:04:54.504 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.163>}
16:04:54.504 [info] S1: New connection accepted.
16:04:54.504 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.165>}
16:04:54.504 [info] S1: New connection accepted.
16:04:54.504 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.167>}
16:04:54.504 [info] S1: New connection accepted.
16:04:54.504 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.169>}
16:04:54.505 [info] S1: New connection accepted.
16:04:54.505 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.171>}
16:04:54.505 [info] S1: New connection accepted.
16:04:54.505 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.173>}
16:04:54.505 [info] S1: New connection accepted.
16:04:54.505 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.175>}
16:04:54.505 [info] S1: New connection accepted.
16:04:54.505 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.177>}
........16:04:55.058 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.230.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:55.059 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.782.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:55.069 [warning] S1 Encapsulator: Invalid IP invalid, dropping packet.
.16:04:55.171 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.782.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:55.171 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.784.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:04:55.182 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.784.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:55.182 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.786.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:04:55.193 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.786.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:55.193 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.788.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.
Finished in 3.6 seconds (0.1s async, 3.5s sync)
1 doctest, 65 tests, 0 failures
Run 7
warning: setting :preferred_cli_env in your mix.exs "def project" is deprecated, set it inside "def cli" instead:

    def cli do
      [preferred_envs: [release: :prod, test: :test]]
    end

  (mix 1.19.4) lib/mix/cli.ex:187: Mix.CLI.preferred_cli_env/3
  (mix 1.19.4) lib/mix/cli.ex:170: Mix.CLI.maybe_change_env_and_target/2
  (mix 1.19.4) lib/mix/cli.ex:59: Mix.CLI.proceed/2
  /opt/homebrew/bin/mix:7: (file)
  (elixir 1.19.4) src/elixir_compiler.erl:81: :elixir_compiler.dispatch/4
  (elixir 1.19.4) src/elixir_compiler.erl:56: :elixir_compiler.compile/4

    warning: unused alias Decapsulator
    │
  8 │   alias DataDiode.S2.Decapsulator
    │   ~
    │
    └─ lib/data_diode/s2/listener.ex:8:3

16:04:55.721 [info] Application logger started at :nonode@nohost
16:04:55.726 [info] Child :ttb_autostart of Supervisor :runtime_tools_sup started
Pid: #PID<0.184.0>
Start Call: :ttb_autostart.start_link()
Restart: :temporary
Shutdown: 3000
Type: :worker
16:04:55.726 [info] Application runtime_tools started at :nonode@nohost
16:04:55.726 [info] Application opentelemetry_api started at :nonode@nohost
16:04:55.726 [info] Application ctx started at :nonode@nohost
16:04:55.726 [info] Application hpack started at :nonode@nohost
16:04:55.726 [info] Application chatterbox started at :nonode@nohost
16:04:55.726 [info] Application acceptor_pool started at :nonode@nohost
16:04:55.733 [info] Child :gproc of Supervisor :gproc_sup started
Pid: #PID<0.188.0>
Start Call: :gproc.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:04:55.734 [info] Child :gproc_monitor of Supervisor :gproc_sup started
Pid: #PID<0.189.0>
Start Call: :gproc_monitor.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:04:55.734 [info] Child :gproc_bcast of Supervisor :gproc_sup started
Pid: #PID<0.190.0>
Start Call: :gproc_bcast.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:04:55.735 [info] Child :gproc_pool of Supervisor :gproc_sup started
Pid: #PID<0.191.0>
Start Call: :gproc_pool.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:04:55.735 [info] Application gproc started at :nonode@nohost
16:04:55.737 [info] Child :grpcbox_services_simple_sup of Supervisor :grpcbox_sup started
Pid: #PID<0.195.0>
Start Call: :grpcbox_services_simple_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:04:55.737 [info] Child :grpcbox_channel_sup of Supervisor :grpcbox_sup started
Pid: #PID<0.196.0>
Start Call: :grpcbox_channel_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:04:55.737 [info] Application grpcbox started at :nonode@nohost
16:04:55.737 [info] Application ssl_verify_fun started at :nonode@nohost
16:04:55.802 [info] Loading 162 CA(s) from :otp store
16:04:55.802 [info] Child :tls_certificate_check_shared_state of Supervisor :tls_certificate_check_sup started
Pid: #PID<0.200.0>
Start Call: :tls_certificate_check_shared_state.start_link()
Restart: :permanent
Shutdown: :infinity
Type: :worker
16:04:55.802 [info] Application tls_certificate_check started at :nonode@nohost
16:04:55.802 [info] Application opentelemetry_exporter started at :nonode@nohost
16:04:55.807 [info] Child :otel_span_ets of Supervisor :otel_span_sup started
Pid: #PID<0.208.0>
Start Call: :otel_span_ets.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:55.808 [info] Child :otel_span_sweeper of Supervisor :otel_span_sup started
Pid: #PID<0.209.0>
Start Call: :otel_span_sweeper.start_link(%{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:55.808 [info] Child :otel_span_sup of Supervisor :opentelemetry_sup started
Pid: #PID<0.207.0>
Start Call: :otel_span_sup.start_link(%{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:04:55.810 [info] Child :otel_resource_detector of Supervisor :opentelemetry_sup started
Pid: #PID<0.210.0>
Start Call: :otel_resource_detector.start_link(%{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:55.812 [info] Child :otel_tracer_provider_sup of Supervisor :opentelemetry_sup started
Pid: #PID<0.213.0>
Start Call: :otel_tracer_provider_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:04:55.814 [info] Child :otel_span_processor_sup of Supervisor #PID<0.214.0> (:otel_tracer_server_sup) started
Pid: #PID<0.215.0>
Start Call: :otel_span_processor_sup.start_link(:otel_span_processor_sup_global)
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:04:55.819 [info] Child :otel_tracer_server of Supervisor #PID<0.214.0> (:otel_tracer_server_sup) started
Pid: #PID<0.216.0>
Start Call: :otel_tracer_server.start_link(:global, :otel_tracer_provider_global, :otel_span_processor_sup_global, {:resource, :undefined, {:attributes, 128, 255, 0, %{"process.executable.name": "erl", "process.runtime.description": "Erlang/OTP 28 erts-16.1.2", "process.runtime.version": "16.1.2", "process.runtime.name": "BEAM", "service.name": "unknown_service:erl", "service.instance.id": 299455596807287809441220769938433487518, "telemetry.sdk.version": "1.6.0", "telemetry.sdk.language": "erlang", "telemetry.sdk.name": "opentelemetry"}}}, %{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:55.821 [debug] Child {:httpc, :"otel_exporter_otlp_<0.217.0>"} of Supervisor :httpc_profile_sup started
Pid: #PID<0.218.0>
Start Call: :httpc_manager.start_link(:"otel_exporter_otlp_<0.217.0>", :only_session_cookies, :inets)
Restart: :permanent
Shutdown: 4000
Type: :worker
16:04:55.826 [info] OTLP exporter successfully initialized
16:04:55.827 [info] Application opentelemetry started at :nonode@nohost
16:04:55.828 [info] Application jason started at :nonode@nohost
16:04:55.829 [info] Application logger_json started at :nonode@nohost
16:04:55.829 [info] Application nimble_ownership started at :nonode@nohost
16:04:55.832 [info] Child Mox of Supervisor Mox.Supervisor started
Pid: #PID<0.222.0>
Start Call: Mox.start_link_ownership()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:55.832 [info] Application mox started at :nonode@nohost
16:04:55.836 [info] Child DataDiode.Metrics of Supervisor DataDiode.Supervisor started
Pid: #PID<0.226.0>
Start Call: DataDiode.Metrics.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:55.836 [info] Child DataDiode.SystemMonitor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.227.0>
Start Call: DataDiode.SystemMonitor.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:55.837 [info] S1: Starting TCP Listener on port 0...
16:04:55.837 [info] Child DataDiode.S1.Listener of Supervisor DataDiode.Supervisor started
Pid: #PID<0.228.0>
Start Call: DataDiode.S1.Listener.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:55.839 [info] Child DataDiode.S1.HandlerSupervisor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.229.0>
Start Call: DataDiode.S1.HandlerSupervisor.start_link()
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:04:55.840 [warning] S1 Encapsulator: Invalid S2_PORT 0, using default 42001
16:04:55.840 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.230.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:55.840 [info] Child DataDiode.S1.Heartbeat of Supervisor DataDiode.Supervisor started
Pid: #PID<0.231.0>
Start Call: DataDiode.S1.Heartbeat.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:55.840 [info] Child DataDiode.S2.HeartbeatMonitor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.232.0>
Start Call: DataDiode.S2.HeartbeatMonitor.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:55.840 [info] Child DataDiode.DiskCleaner of Supervisor DataDiode.Supervisor started
Pid: #PID<0.233.0>
Start Call: DataDiode.DiskCleaner.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:55.842 [info] S2: Starting UDP Listener on port 0...
16:04:55.842 [info] Child DataDiode.S2.Listener of Supervisor DataDiode.Supervisor started
Pid: #PID<0.234.0>
Start Call: DataDiode.S2.Listener.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:55.842 [info] Child DataDiode.S2.TaskSupervisor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.235.0>
Start Call: Task.Supervisor.start_link([name: DataDiode.S2.TaskSupervisor, max_children: 200])
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:04:55.842 [info] Application data_diode started at :nonode@nohost
16:04:55.847 [info] Child ExUnit.Server of Supervisor ExUnit.Supervisor started
Pid: #PID<0.241.0>
Start Call: ExUnit.Server.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:55.847 [info] Child ExUnit.CaptureServer of Supervisor ExUnit.Supervisor started
Pid: #PID<0.242.0>
Start Call: ExUnit.CaptureServer.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:55.847 [info] Application ex_unit started at :nonode@nohost
Running ExUnit with seed: 848972, max_cases: 16

    warning: variable "c" is unused (if the variable is not meant to be used, prefix it with an underscore)
    │
 26 │     {:ok, c} = :gen_tcp.connect({127,0,0,1}, port, [:binary, active: false])
    │           ~
    │
    └─ test/long_term_robustness_test.exs:26:11: DataDiode.LongTermRobustnessTest."test TCPHandler exhaustive branch coverage"/1

    warning: variable "pid3" is unused (if the variable is not meant to be used, prefix it with an underscore)
    │
 62 │     {:ok, pid3} = TCPHandler.start_link(s3)
    │           ~~~~
    │
    └─ test/long_term_robustness_test.exs:62:11: DataDiode.LongTermRobustnessTest."test TCPHandler exhaustive branch coverage"/1

16:04:55.929 [info] DiskCleaner: Low disk space detected on . (< 15%). Starting autonomous cleanup...
16:04:55.929 [warning] DiskCleaner: Simulation - would delete oldest .dat files in . now.
.     warning: redefining module DataDiode.S1.EncapsulatorMock (current version defined in memory)
     │
 491 │     Module.create(name, [info | body], Macro.Env.location(__ENV__))
     │     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     │
     └─ deps/mox/lib/mox.ex:491: DataDiode.S1.EncapsulatorMock (module)

.......16:04:55.944 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 23 bytes.
.16:04:55.944 [debug] S2: Successfully wrote 23 bytes to ./data_1766120695944_1_51210.dat. (Simulated secure write)
.16:04:55.944 [info] S2: Decapsulated packet from 0.0.0.0:0. Payload size: 0 bytes.
16:04:55.944 [debug] S2: Successfully wrote 0 bytes to ./data_1766120695944_2_0.dat. (Simulated secure write)
.16:04:55.944 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 9 bytes.
.16:04:55.944 [debug] S2: Successfully wrote 9 bytes to ./data_1766120695944_3_80.dat. (Simulated secure write)
16:04:55.947 [error] S2: Failed to parse header: invalid_packet_size
..16:04:55.947 [error] S2: Failed to parse header: invalid_packet_size
...16:04:55.948 [error] S2: Failed to parse header: invalid_packet_size
.16:04:55.948 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 23 bytes.
.16:04:55.948 [debug] S2: Successfully wrote 23 bytes to ./data_1766120695948_4_51210.dat. (Simulated secure write)
.16:04:55.948 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 0 bytes.
16:04:55.948 [debug] S2: Successfully wrote 0 bytes to ./data_1766120695948_5_51210.dat. (Simulated secure write)
16:04:55.967 [error] S1: TCP error for 1.2.3.4: :econnreset
.16:04:55.967 [debug] S1: TCPHandler received unexpected message: :unknown
.16:04:55.967 [debug] S1: TCPHandler received unexpected message: :accept_loop
.16:04:55.973 [info] Child of Supervisor :inet_gethost_native_sup started
Pid: #PID<0.388.0>
Start Call: :inet_gethost_native.init([])
16:04:55.974 [debug] Child :inet_gethost_native_sup of Supervisor :kernel_safe_sup started
Pid: #PID<0.387.0>
Start Call: :inet_gethost_native.start_link()
Restart: :temporary
Shutdown: 1000
Type: :worker
16:04:55.979 [warning] S1: Dropping oversized packet (1048577 bytes) from 1.2.3.4
.16:04:55.980 [info] S1: Forwarded 11 bytes.
..16:04:55.992 [info] S1: Connection closed by 1.2.3.4:80
.......16:04:55.996 [info] S1: Starting TCP Listener on port 8092...
16:04:55.996 [info] S1: New connection accepted.
16:04:55.997 [info] S1: New connection accepted.
16:04:56.000 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.37>}
16:04:56.000 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.39>}
16:04:56.000 [info] S1: New connection accepted.
16:04:56.000 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.46>}
16:04:56.000 [info] S1: New connection accepted.
16:04:56.001 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.47>}
16:04:56.001 [info] S1: New connection accepted.
16:04:56.001 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.48>}
16:04:56.001 [info] S1: New connection accepted.
16:04:56.001 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.49>}
16:04:56.001 [info] S1: New connection accepted.
16:04:56.001 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.50>}
16:04:56.028 [info] S1: New connection accepted.
16:04:56.029 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.51>}
16:04:56.029 [info] S1: New connection accepted.
16:04:56.029 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.53>}
16:04:56.029 [info] S1: New connection accepted.
16:04:56.029 [info] S1: New connection accepted.
16:04:56.029 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.55>}
16:04:56.029 [info] S1: New connection accepted.
16:04:56.029 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.57>}
16:04:56.030 [info] S1: New connection accepted.
16:04:56.030 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.59>}
16:04:56.030 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.61>}
16:04:56.030 [info] S1: New connection accepted.
16:04:56.030 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.63>}
16:04:56.030 [info] S1: New connection accepted.
16:04:56.030 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.65>}
16:04:56.030 [info] S1: New connection accepted.
16:04:56.030 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.67>}
16:04:56.030 [info] S1: New connection accepted.
16:04:56.030 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.69>}
16:04:56.031 [info] S1: New connection accepted.
16:04:56.031 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.71>}
16:04:56.031 [info] S1: New connection accepted.
16:04:56.031 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.73>}
16:04:56.031 [info] S1: New connection accepted.
16:04:56.031 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.75>}
16:04:56.031 [info] S1: New connection accepted.
16:04:56.031 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.77>}
16:04:56.031 [info] S1: New connection accepted.
16:04:56.031 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.79>}
16:04:56.031 [info] S1: New connection accepted.
16:04:56.031 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.81>}
16:04:56.032 [info] S1: New connection accepted.
16:04:56.032 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.83>}
16:04:56.032 [info] S1: New connection accepted.
16:04:56.032 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.85>}
16:04:56.032 [info] S1: New connection accepted.
16:04:56.032 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.87>}
16:04:56.032 [info] S1: New connection accepted.
16:04:56.032 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.89>}
16:04:56.032 [info] S1: New connection accepted.
16:04:56.032 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.91>}
16:04:56.032 [info] S1: New connection accepted.
16:04:56.032 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.93>}
16:04:56.032 [info] S1: New connection accepted.
16:04:56.032 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.95>}
16:04:56.032 [info] S1: New connection accepted.
16:04:56.032 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.97>}
16:04:56.033 [info] S1: New connection accepted.
16:04:56.033 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.99>}
16:04:56.033 [info] S1: New connection accepted.
16:04:56.033 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.101>}
16:04:56.033 [info] S1: New connection accepted.
16:04:56.033 [info] S1: New connection accepted.
16:04:56.033 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.103>}
16:04:56.033 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.105>}
16:04:56.033 [info] S1: New connection accepted.
16:04:56.033 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.107>}
16:04:56.033 [info] S1: New connection accepted.
16:04:56.033 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.109>}
16:04:56.033 [info] S1: New connection accepted.
16:04:56.033 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.111>}
16:04:56.033 [info] S1: New connection accepted.
16:04:56.033 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.113>}
16:04:56.034 [info] S1: New connection accepted.
16:04:56.034 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.115>}
16:04:56.034 [info] S1: New connection accepted.
16:04:56.034 [info] S1: New connection accepted.
16:04:56.034 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.117>}
16:04:56.034 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.119>}
16:04:56.034 [info] S1: New connection accepted.
16:04:56.034 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.121>}
16:04:56.034 [info] S1: New connection accepted.
16:04:56.034 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.123>}
16:04:56.034 [info] S1: New connection accepted.
16:04:56.034 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.125>}
16:04:56.034 [info] S1: New connection accepted.
16:04:56.034 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.127>}
16:04:56.034 [info] S1: New connection accepted.
16:04:56.034 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.129>}
16:04:56.035 [info] S1: New connection accepted.
16:04:56.035 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.131>}
16:04:56.035 [info] S1: New connection accepted.
16:04:56.035 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.133>}
16:04:56.035 [info] S1: New connection accepted.
16:04:56.035 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.135>}
..16:04:56.605 [debug] SystemMonitor: Received unexpected message: :unexp
16:04:56.610 [debug] S1: TCPHandler received unexpected message: :unexp
16:04:56.610 [info] S1: Starting TCP Listener on port 0...
16:04:56.610 [debug] S1: Listener received unexpected message: :unexp
16:04:57.341 [info] S2: Starting UDP Listener on port 0...
16:04:57.341 [warning] S2: Received unexpected message: :unexp
16:04:57.342 [error] S2: UDP Listener socket closed unexpectedly. Terminating.
16:04:57.349 [info] DiskCleaner: Low disk space detected on . (< 15%). Starting autonomous cleanup...
16:04:57.349 [warning] DiskCleaner: Simulation - would delete oldest .dat files in . now.
16:04:57.354 [info] S2: Decapsulated packet from 127.0.0.1:20480. Payload size: 7 bytes.
16:04:57.354 [debug] S2: Successfully wrote 7 bytes to /tmp/diode_test/data_1766120697354_58_20480.dat. (Simulated secure write)
16:04:57.354 [info] S2: Decapsulated packet from 127.0.0.1:0. Payload size: 9 bytes.
16:04:57.356 [debug] S1: Generating end-to-end heartbeat.
16:04:57.356 [warning] S1 Heartbeat: Received unexpected message: :unexp
16:04:57.356 [error] S2: Critical Failure! Channel heartbeat missing for > 6 minutes. The diode path may be obstructed.
16:04:57.356 [warning] S2 HeartbeatMonitor: Received unexpected message: :unexp
..16:04:57.844 [info] S1: New connection accepted.
16:04:57.844 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.149>}
16:04:57.844 [info] S1: New connection accepted.
16:04:57.844 [info] S1: New connection accepted.
16:04:57.844 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.152>}
16:04:57.844 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.153>}
16:04:57.844 [info] S1: New connection accepted.
16:04:57.844 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.155>}
16:04:57.844 [info] S1: New connection accepted.
16:04:57.844 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.157>}
...16:04:58.100 [debug] S1: TCPHandler received unexpected message: :accept_loop
.16:04:58.100 [warning] S1: Invalid LISTEN_IP invalid, using all interfaces.
.16:04:58.100 [info] S1: Starting TCP Listener on port 0...
16:04:58.602 [info] S1: New connection accepted.
.16:04:58.602 [info] S1: Starting TCP Listener on port 0...
16:04:59.103 [error] S1: Listener socket fatal error: :closed. Terminating.
16:04:59.103 [error] GenServer :s1_flapping_test_unique terminating
** (stop) :closed
Last message: :accept_loop
State: #Port<0.170>
16:04:59.103 [error] Process :s1_flapping_test_unique (#PID<0.628.0>) terminating
** (exit) :closed
    (stdlib 7.1) gen_server.erl:2562: :gen_server.handle_common_reply/5
    (stdlib 7.1) proc_lib.erl:333: :proc_lib.init_p_do_apply/3
Initial Call: DataDiode.S1.Listener.init/1
Ancestors: [#PID<0.627.0>]
Message Queue Length: 0
Messages: []
Links: []
Dictionary: []
Trapping Exits: false
Status: :running
Heap Size: 1598
Stack Size: 29
Reductions: 2746
.16:04:59.104 [error] S1: Listener socket fatal error: :closed. Terminating.
..16:04:59.605 [info] S1: Starting TCP Listener on port 0...
.....16:04:59.606 [error] S2: UDP Listener socket closed unexpectedly. Terminating.
..16:04:59.607 [info] S2: Starting UDP Listener on port 0...
..16:04:59.607 [info] S2: Starting UDP Listener on port 0...
16:04:59.607 [info] S2: Decapsulated packet from 1.2.3.4:80. Payload size: 5 bytes.
16:04:59.607 [debug] S2: Successfully wrote 5 bytes to ./data_1766120699607_65_80.dat. (Simulated secure write)
.16:04:59.618 [warning] S2: Invalid LISTEN_IP_S2 invalid, falling back to all interfaces.
..16:04:59.619 [info] S2: Starting UDP Listener on port 0...
16:04:59.619 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.619 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699619_66_80.dat. (Simulated secure write)
16:04:59.619 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.619 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699619_67_80.dat. (Simulated secure write)
16:04:59.619 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.619 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699619_68_80.dat. (Simulated secure write)
16:04:59.619 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.619 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699619_69_80.dat. (Simulated secure write)
16:04:59.619 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.619 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699619_70_80.dat. (Simulated secure write)
16:04:59.619 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.619 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699619_71_80.dat. (Simulated secure write)
16:04:59.619 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.619 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699619_72_80.dat. (Simulated secure write)
16:04:59.619 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.619 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699619_73_80.dat. (Simulated secure write)
16:04:59.619 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.619 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.620 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699619_74_80.dat. (Simulated secure write)
16:04:59.620 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699620_75_80.dat. (Simulated secure write)
16:04:59.620 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.620 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699620_76_80.dat. (Simulated secure write)
16:04:59.620 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.620 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.620 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699620_78_80.dat. (Simulated secure write)
16:04:59.620 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699620_77_80.dat. (Simulated secure write)
16:04:59.620 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.620 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699620_79_80.dat. (Simulated secure write)
16:04:59.620 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.620 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699620_80_80.dat. (Simulated secure write)
16:04:59.620 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.620 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699620_81_80.dat. (Simulated secure write)
16:04:59.620 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.620 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699620_82_80.dat. (Simulated secure write)
16:04:59.620 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.620 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699620_83_80.dat. (Simulated secure write)
16:04:59.620 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.620 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699620_84_80.dat. (Simulated secure write)
16:04:59.620 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.620 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699620_85_80.dat. (Simulated secure write)
16:04:59.620 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.620 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699620_86_80.dat. (Simulated secure write)
16:04:59.620 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.620 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699620_87_80.dat. (Simulated secure write)
16:04:59.620 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.620 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699620_88_80.dat. (Simulated secure write)
16:04:59.620 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.620 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699620_89_80.dat. (Simulated secure write)
16:04:59.620 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.620 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699620_90_80.dat. (Simulated secure write)
16:04:59.620 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.620 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699620_91_80.dat. (Simulated secure write)
16:04:59.621 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.621 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699621_92_80.dat. (Simulated secure write)
16:04:59.621 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.621 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699621_93_80.dat. (Simulated secure write)
16:04:59.621 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.621 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.621 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699621_94_80.dat. (Simulated secure write)
16:04:59.621 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.621 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699621_95_80.dat. (Simulated secure write)
16:04:59.621 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.621 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699621_96_80.dat. (Simulated secure write)
16:04:59.621 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.621 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699621_97_80.dat. (Simulated secure write)
16:04:59.621 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.621 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699621_98_80.dat. (Simulated secure write)
16:04:59.621 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.621 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699621_99_80.dat. (Simulated secure write)
16:04:59.621 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.621 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699621_100_80.dat. (Simulated secure write)
16:04:59.621 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.621 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699621_101_80.dat. (Simulated secure write)
16:04:59.621 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.621 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.621 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699621_102_80.dat. (Simulated secure write)
16:04:59.621 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699621_103_80.dat. (Simulated secure write)
16:04:59.621 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.621 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699621_104_80.dat. (Simulated secure write)
16:04:59.621 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.621 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699621_105_80.dat. (Simulated secure write)
16:04:59.621 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.621 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699621_106_80.dat. (Simulated secure write)
16:04:59.622 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.622 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699622_107_80.dat. (Simulated secure write)
16:04:59.622 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.622 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699622_108_80.dat. (Simulated secure write)
16:04:59.622 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.622 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.622 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.622 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.622 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.622 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.622 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.622 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.622 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.622 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.622 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.622 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.622 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.622 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699622_109_80.dat. (Simulated secure write)
16:04:59.622 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699622_110_80.dat. (Simulated secure write)
16:04:59.622 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.622 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.623 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.623 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.623 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.623 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.623 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.623 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.623 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.623 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.623 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.623 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699623_112_80.dat. (Simulated secure write)
16:04:59.623 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699623_117_80.dat. (Simulated secure write)
16:04:59.623 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699623_114_80.dat. (Simulated secure write)
16:04:59.623 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699623_121_80.dat. (Simulated secure write)
16:04:59.623 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699623_119_80.dat. (Simulated secure write)
16:04:59.623 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699623_115_80.dat. (Simulated secure write)
16:04:59.623 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699623_123_80.dat. (Simulated secure write)
16:04:59.623 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699623_111_80.dat. (Simulated secure write)
16:04:59.623 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699623_113_80.dat. (Simulated secure write)
16:04:59.623 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699623_116_80.dat. (Simulated secure write)
16:04:59.623 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699623_122_80.dat. (Simulated secure write)
16:04:59.623 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699623_120_80.dat. (Simulated secure write)
16:04:59.623 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.623 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699623_118_80.dat. (Simulated secure write)
16:04:59.623 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699623_127_80.dat. (Simulated secure write)
16:04:59.623 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699623_129_80.dat. (Simulated secure write)
16:04:59.623 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699623_124_80.dat. (Simulated secure write)
16:04:59.623 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699623_128_80.dat. (Simulated secure write)
16:04:59.623 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699623_126_80.dat. (Simulated secure write)
16:04:59.623 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699623_125_80.dat. (Simulated secure write)
16:04:59.623 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699623_130_80.dat. (Simulated secure write)
16:04:59.624 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.624 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699624_131_80.dat. (Simulated secure write)
16:04:59.624 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.624 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699624_132_80.dat. (Simulated secure write)
16:04:59.624 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.624 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699624_133_80.dat. (Simulated secure write)
16:04:59.624 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.624 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699624_134_80.dat. (Simulated secure write)
16:04:59.624 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.624 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699624_135_80.dat. (Simulated secure write)
16:04:59.624 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.624 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699624_137_80.dat. (Simulated secure write)
16:04:59.624 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699624_136_80.dat. (Simulated secure write)
16:04:59.624 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.624 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699624_138_80.dat. (Simulated secure write)
16:04:59.624 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699624_139_80.dat. (Simulated secure write)
16:04:59.624 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.624 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699624_140_80.dat. (Simulated secure write)
16:04:59.624 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.624 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.624 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.624 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.625 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.625 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.625 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.625 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.625 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.625 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699625_141_80.dat. (Simulated secure write)
16:04:59.625 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.625 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699625_143_80.dat. (Simulated secure write)
16:04:59.625 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699625_142_80.dat. (Simulated secure write)
16:04:59.625 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.625 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.625 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.625 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.625 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.625 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.625 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699625_144_80.dat. (Simulated secure write)
16:04:59.625 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699625_150_80.dat. (Simulated secure write)
16:04:59.625 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699625_146_80.dat. (Simulated secure write)
16:04:59.625 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699625_148_80.dat. (Simulated secure write)
16:04:59.625 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699625_145_80.dat. (Simulated secure write)
16:04:59.625 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699625_152_80.dat. (Simulated secure write)
16:04:59.625 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699625_151_80.dat. (Simulated secure write)
16:04:59.625 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699625_147_80.dat. (Simulated secure write)
16:04:59.625 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699625_149_80.dat. (Simulated secure write)
16:04:59.625 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.625 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699625_153_80.dat. (Simulated secure write)
16:04:59.626 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699626_154_80.dat. (Simulated secure write)
16:04:59.626 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699626_155_80.dat. (Simulated secure write)
16:04:59.626 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699626_157_80.dat. (Simulated secure write)
16:04:59.626 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699626_156_80.dat. (Simulated secure write)
16:04:59.626 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699626_158_80.dat. (Simulated secure write)
16:04:59.626 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.626 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699626_159_80.dat. (Simulated secure write)
16:04:59.626 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699626_160_80.dat. (Simulated secure write)
16:04:59.626 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.626 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699626_161_80.dat. (Simulated secure write)
16:04:59.626 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.626 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699626_162_80.dat. (Simulated secure write)
16:04:59.626 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.626 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699626_163_80.dat. (Simulated secure write)
16:04:59.626 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.626 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699626_164_80.dat. (Simulated secure write)
16:04:59.626 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:04:59.626 [debug] S2: Successfully wrote 7 bytes to ./data_1766120699626_165_80.dat. (Simulated secure write)
.16:04:59.727 [info] S2: Starting UDP Listener on port 0...
.16:04:59.751 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.230.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
..16:04:59.751 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.773.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:04:59.761 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.773.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:59.761 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.775.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:04:59.773 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.775.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:59.773 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.777.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:59.783 [warning] S1 Encapsulator: Invalid IP invalid, dropping packet.
.16:04:59.884 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.777.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:04:59.884 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.779.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.
Finished in 4.0 seconds (0.1s async, 3.9s sync)
1 doctest, 65 tests, 0 failures
Run 8
warning: setting :preferred_cli_env in your mix.exs "def project" is deprecated, set it inside "def cli" instead:

    def cli do
      [preferred_envs: [release: :prod, test: :test]]
    end

  (mix 1.19.4) lib/mix/cli.ex:187: Mix.CLI.preferred_cli_env/3
  (mix 1.19.4) lib/mix/cli.ex:170: Mix.CLI.maybe_change_env_and_target/2
  (mix 1.19.4) lib/mix/cli.ex:59: Mix.CLI.proceed/2
  /opt/homebrew/bin/mix:7: (file)
  (elixir 1.19.4) src/elixir_compiler.erl:81: :elixir_compiler.dispatch/4
  (elixir 1.19.4) src/elixir_compiler.erl:56: :elixir_compiler.compile/4

    warning: unused alias Decapsulator
    │
  8 │   alias DataDiode.S2.Decapsulator
    │   ~
    │
    └─ lib/data_diode/s2/listener.ex:8:3

16:05:00.688 [info] Application logger started at :nonode@nohost
16:05:00.693 [info] Child :ttb_autostart of Supervisor :runtime_tools_sup started
Pid: #PID<0.184.0>
Start Call: :ttb_autostart.start_link()
Restart: :temporary
Shutdown: 3000
Type: :worker
16:05:00.693 [info] Application runtime_tools started at :nonode@nohost
16:05:00.693 [info] Application opentelemetry_api started at :nonode@nohost
16:05:00.693 [info] Application ctx started at :nonode@nohost
16:05:00.693 [info] Application hpack started at :nonode@nohost
16:05:00.693 [info] Application chatterbox started at :nonode@nohost
16:05:00.693 [info] Application acceptor_pool started at :nonode@nohost
16:05:00.699 [info] Child :gproc of Supervisor :gproc_sup started
Pid: #PID<0.188.0>
Start Call: :gproc.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:05:00.699 [info] Child :gproc_monitor of Supervisor :gproc_sup started
Pid: #PID<0.189.0>
Start Call: :gproc_monitor.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:05:00.700 [info] Child :gproc_bcast of Supervisor :gproc_sup started
Pid: #PID<0.190.0>
Start Call: :gproc_bcast.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:05:00.701 [info] Child :gproc_pool of Supervisor :gproc_sup started
Pid: #PID<0.191.0>
Start Call: :gproc_pool.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:05:00.701 [info] Application gproc started at :nonode@nohost
16:05:00.703 [info] Child :grpcbox_services_simple_sup of Supervisor :grpcbox_sup started
Pid: #PID<0.195.0>
Start Call: :grpcbox_services_simple_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:05:00.703 [info] Child :grpcbox_channel_sup of Supervisor :grpcbox_sup started
Pid: #PID<0.196.0>
Start Call: :grpcbox_channel_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:05:00.703 [info] Application grpcbox started at :nonode@nohost
16:05:00.703 [info] Application ssl_verify_fun started at :nonode@nohost
16:05:00.784 [info] Loading 162 CA(s) from :otp store
16:05:00.784 [info] Child :tls_certificate_check_shared_state of Supervisor :tls_certificate_check_sup started
Pid: #PID<0.200.0>
Start Call: :tls_certificate_check_shared_state.start_link()
Restart: :permanent
Shutdown: :infinity
Type: :worker
16:05:00.784 [info] Application tls_certificate_check started at :nonode@nohost
16:05:00.784 [info] Application opentelemetry_exporter started at :nonode@nohost
16:05:00.788 [info] Child :otel_span_ets of Supervisor :otel_span_sup started
Pid: #PID<0.208.0>
Start Call: :otel_span_ets.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:00.789 [info] Child :otel_span_sweeper of Supervisor :otel_span_sup started
Pid: #PID<0.209.0>
Start Call: :otel_span_sweeper.start_link(%{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:00.789 [info] Child :otel_span_sup of Supervisor :opentelemetry_sup started
Pid: #PID<0.207.0>
Start Call: :otel_span_sup.start_link(%{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:05:00.791 [info] Child :otel_resource_detector of Supervisor :opentelemetry_sup started
Pid: #PID<0.210.0>
Start Call: :otel_resource_detector.start_link(%{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:00.792 [info] Child :otel_tracer_provider_sup of Supervisor :opentelemetry_sup started
Pid: #PID<0.213.0>
Start Call: :otel_tracer_provider_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:05:00.794 [info] Child :otel_span_processor_sup of Supervisor #PID<0.214.0> (:otel_tracer_server_sup) started
Pid: #PID<0.215.0>
Start Call: :otel_span_processor_sup.start_link(:otel_span_processor_sup_global)
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:05:00.799 [info] Child :otel_tracer_server of Supervisor #PID<0.214.0> (:otel_tracer_server_sup) started
Pid: #PID<0.216.0>
Start Call: :otel_tracer_server.start_link(:global, :otel_tracer_provider_global, :otel_span_processor_sup_global, {:resource, :undefined, {:attributes, 128, 255, 0, %{"process.executable.name": "erl", "process.runtime.description": "Erlang/OTP 28 erts-16.1.2", "process.runtime.version": "16.1.2", "process.runtime.name": "BEAM", "service.name": "unknown_service:erl", "service.instance.id": 173743993858153135176191699727118698631, "telemetry.sdk.version": "1.6.0", "telemetry.sdk.language": "erlang", "telemetry.sdk.name": "opentelemetry"}}}, %{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:00.801 [debug] Child {:httpc, :"otel_exporter_otlp_<0.217.0>"} of Supervisor :httpc_profile_sup started
Pid: #PID<0.218.0>
Start Call: :httpc_manager.start_link(:"otel_exporter_otlp_<0.217.0>", :only_session_cookies, :inets)
Restart: :permanent
Shutdown: 4000
Type: :worker
16:05:00.804 [info] OTLP exporter successfully initialized
16:05:00.805 [info] Application opentelemetry started at :nonode@nohost
16:05:00.806 [info] Application jason started at :nonode@nohost
16:05:00.806 [info] Application logger_json started at :nonode@nohost
16:05:00.806 [info] Application nimble_ownership started at :nonode@nohost
16:05:00.808 [info] Child Mox of Supervisor Mox.Supervisor started
Pid: #PID<0.222.0>
Start Call: Mox.start_link_ownership()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:00.808 [info] Application mox started at :nonode@nohost
16:05:00.813 [info] Child DataDiode.Metrics of Supervisor DataDiode.Supervisor started
Pid: #PID<0.226.0>
Start Call: DataDiode.Metrics.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:00.813 [info] Child DataDiode.SystemMonitor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.227.0>
Start Call: DataDiode.SystemMonitor.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:00.814 [info] S1: Starting TCP Listener on port 0...
16:05:00.814 [info] Child DataDiode.S1.Listener of Supervisor DataDiode.Supervisor started
Pid: #PID<0.228.0>
Start Call: DataDiode.S1.Listener.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:00.816 [info] Child DataDiode.S1.HandlerSupervisor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.229.0>
Start Call: DataDiode.S1.HandlerSupervisor.start_link()
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:05:00.817 [warning] S1 Encapsulator: Invalid S2_PORT 0, using default 42001
16:05:00.817 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.230.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:00.817 [info] Child DataDiode.S1.Heartbeat of Supervisor DataDiode.Supervisor started
Pid: #PID<0.231.0>
Start Call: DataDiode.S1.Heartbeat.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:00.817 [info] Child DataDiode.S2.HeartbeatMonitor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.232.0>
Start Call: DataDiode.S2.HeartbeatMonitor.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:00.817 [info] Child DataDiode.DiskCleaner of Supervisor DataDiode.Supervisor started
Pid: #PID<0.233.0>
Start Call: DataDiode.DiskCleaner.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:00.818 [info] S2: Starting UDP Listener on port 0...
16:05:00.818 [info] Child DataDiode.S2.Listener of Supervisor DataDiode.Supervisor started
Pid: #PID<0.234.0>
Start Call: DataDiode.S2.Listener.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:00.818 [info] Child DataDiode.S2.TaskSupervisor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.235.0>
Start Call: Task.Supervisor.start_link([name: DataDiode.S2.TaskSupervisor, max_children: 200])
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:05:00.818 [info] Application data_diode started at :nonode@nohost
16:05:00.822 [info] Child ExUnit.Server of Supervisor ExUnit.Supervisor started
Pid: #PID<0.241.0>
Start Call: ExUnit.Server.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:00.822 [info] Child ExUnit.CaptureServer of Supervisor ExUnit.Supervisor started
Pid: #PID<0.242.0>
Start Call: ExUnit.CaptureServer.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:00.822 [info] Application ex_unit started at :nonode@nohost
Running ExUnit with seed: 824214, max_cases: 16

    warning: variable "c" is unused (if the variable is not meant to be used, prefix it with an underscore)
    │
 26 │     {:ok, c} = :gen_tcp.connect({127,0,0,1}, port, [:binary, active: false])
    │           ~
    │
    └─ test/long_term_robustness_test.exs:26:11: DataDiode.LongTermRobustnessTest."test TCPHandler exhaustive branch coverage"/1

    warning: variable "pid3" is unused (if the variable is not meant to be used, prefix it with an underscore)
    │
 62 │     {:ok, pid3} = TCPHandler.start_link(s3)
    │           ~~~~
    │
    └─ test/long_term_robustness_test.exs:62:11: DataDiode.LongTermRobustnessTest."test TCPHandler exhaustive branch coverage"/1

........     warning: redefining module DataDiode.S1.EncapsulatorMock (current version defined in memory)
     │
 491 │     Module.create(name, [info | body], Macro.Env.location(__ENV__))
     │     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     │
     └─ deps/mox/lib/mox.ex:491: DataDiode.S1.EncapsulatorMock (module)

....16:05:00.918 [error] S2: Failed to parse header: invalid_packet_size
.16:05:00.918 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 0 bytes.
.16:05:00.918 [debug] S2: Successfully wrote 0 bytes to ./data_1766120700918_1_51210.dat. (Simulated secure write)
.16:05:00.918 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 9 bytes.
.16:05:00.918 [debug] S2: Successfully wrote 9 bytes to ./data_1766120700918_2_80.dat. (Simulated secure write)
16:05:00.918 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 23 bytes.
.16:05:00.918 [debug] S2: Successfully wrote 23 bytes to ./data_1766120700918_3_51210.dat. (Simulated secure write)
.16:05:00.919 [error] S2: Failed to parse header: invalid_packet_size
16:05:00.919 [info] S2: Decapsulated packet from 0.0.0.0:0. Payload size: 0 bytes.
.16:05:00.919 [debug] S2: Successfully wrote 0 bytes to ./data_1766120700919_4_0.dat. (Simulated secure write)
16:05:00.919 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 23 bytes.
16:05:00.919 [debug] S2: Successfully wrote 23 bytes to ./data_1766120700919_5_51210.dat. (Simulated secure write)
16:05:00.919 [error] S2: Failed to parse header: invalid_packet_size
.16:05:00.947 [info] Child of Supervisor :inet_gethost_native_sup started
Pid: #PID<0.394.0>
Start Call: :inet_gethost_native.init([])
16:05:00.947 [debug] Child :inet_gethost_native_sup of Supervisor :kernel_safe_sup started
Pid: #PID<0.393.0>
Start Call: :inet_gethost_native.start_link()
Restart: :temporary
Shutdown: 1000
Type: :worker
16:05:00.961 [warning] S1: Dropping oversized packet (1048577 bytes) from 1.2.3.4
.16:05:00.961 [info] S1: Connection closed by 1.2.3.4:80
16:05:00.961 [debug] S1: TCPHandler received unexpected message: :accept_loop
..16:05:00.962 [error] S1: TCP error for 1.2.3.4: :econnreset
.16:05:00.963 [info] S1: Forwarded 11 bytes.
.16:05:00.974 [debug] S1: TCPHandler received unexpected message: :unknown
...16:05:00.975 [info] S1: Starting TCP Listener on port 8092...
16:05:00.975 [info] S1: New connection accepted.
16:05:00.976 [info] S1: New connection accepted.
16:05:00.982 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.37>}
16:05:00.982 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.40>}
16:05:00.982 [info] S1: New connection accepted.
16:05:00.983 [info] S1: New connection accepted.
16:05:00.983 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.46>}
16:05:00.983 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.47>}
16:05:00.983 [info] S1: New connection accepted.
16:05:00.983 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.48>}
16:05:00.983 [info] S1: New connection accepted.
16:05:00.983 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.49>}
16:05:00.983 [info] S1: New connection accepted.
16:05:00.984 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.50>}
16:05:01.041 [info] S1: New connection accepted.
16:05:01.041 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.51>}
16:05:01.041 [info] S1: New connection accepted.
16:05:01.041 [info] S1: New connection accepted.
16:05:01.041 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.53>}
16:05:01.041 [info] S1: New connection accepted.
16:05:01.041 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.55>}
16:05:01.041 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.57>}
16:05:01.042 [info] S1: New connection accepted.
16:05:01.042 [info] S1: New connection accepted.
16:05:01.042 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.59>}
16:05:01.042 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.61>}
16:05:01.042 [info] S1: New connection accepted.
16:05:01.042 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.63>}
16:05:01.042 [info] S1: New connection accepted.
16:05:01.042 [info] S1: New connection accepted.
16:05:01.042 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.65>}
16:05:01.042 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.67>}
16:05:01.042 [info] S1: New connection accepted.
16:05:01.042 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.69>}
16:05:01.042 [info] S1: New connection accepted.
16:05:01.043 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.71>}
16:05:01.043 [info] S1: New connection accepted.
16:05:01.043 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.73>}
16:05:01.043 [info] S1: New connection accepted.
16:05:01.043 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.75>}
16:05:01.043 [info] S1: New connection accepted.
16:05:01.043 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.77>}
16:05:01.043 [info] S1: New connection accepted.
16:05:01.043 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.79>}
16:05:01.043 [info] S1: New connection accepted.
16:05:01.044 [info] S1: New connection accepted.
16:05:01.044 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.81>}
16:05:01.044 [info] S1: New connection accepted.
16:05:01.044 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.83>}
16:05:01.044 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.85>}
16:05:01.044 [info] S1: New connection accepted.
16:05:01.044 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.87>}
16:05:01.044 [info] S1: New connection accepted.
16:05:01.044 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.89>}
16:05:01.044 [info] S1: New connection accepted.
16:05:01.044 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.91>}
16:05:01.044 [info] S1: New connection accepted.
16:05:01.044 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.93>}
16:05:01.044 [info] S1: New connection accepted.
16:05:01.044 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.95>}
16:05:01.045 [info] S1: New connection accepted.
16:05:01.045 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.97>}
16:05:01.045 [info] S1: New connection accepted.
16:05:01.045 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.99>}
16:05:01.045 [info] S1: New connection accepted.
16:05:01.045 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.101>}
16:05:01.045 [info] S1: New connection accepted.
16:05:01.045 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.103>}
16:05:01.045 [info] S1: New connection accepted.
16:05:01.045 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.105>}
16:05:01.045 [info] S1: New connection accepted.
16:05:01.045 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.107>}
16:05:01.045 [info] S1: New connection accepted.
16:05:01.046 [info] S1: New connection accepted.
16:05:01.046 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.109>}
16:05:01.046 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.111>}
16:05:01.046 [info] S1: New connection accepted.
16:05:01.046 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.113>}
16:05:01.046 [info] S1: New connection accepted.
16:05:01.046 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.115>}
16:05:01.046 [info] S1: New connection accepted.
16:05:01.046 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.117>}
16:05:01.046 [info] S1: New connection accepted.
16:05:01.046 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.119>}
16:05:01.046 [info] S1: New connection accepted.
16:05:01.046 [info] S1: New connection accepted.
16:05:01.046 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.121>}
16:05:01.046 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.123>}
16:05:01.047 [info] S1: New connection accepted.
16:05:01.047 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.125>}
16:05:01.047 [info] S1: New connection accepted.
16:05:01.047 [info] S1: New connection accepted.
16:05:01.047 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.127>}
16:05:01.047 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.129>}
16:05:01.047 [info] S1: New connection accepted.
16:05:01.047 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.131>}
16:05:01.047 [info] S1: New connection accepted.
16:05:01.047 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.133>}
16:05:01.047 [info] S1: New connection accepted.
16:05:01.047 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.135>}
...16:05:01.817 [info] S1: New connection accepted.
16:05:01.817 [info] S1: New connection accepted.
16:05:01.817 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.141>}
16:05:01.817 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.143>}
16:05:01.817 [info] S1: New connection accepted.
16:05:01.817 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.145>}
16:05:01.818 [info] S1: New connection accepted.
16:05:01.818 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.147>}
16:05:01.818 [info] S1: New connection accepted.
16:05:01.818 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.149>}
...16:05:02.121 [debug] S1: TCPHandler received unexpected message: :accept_loop
.16:05:02.122 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.230.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:02.123 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.560.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:05:02.133 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.560.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:02.133 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.562.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:02.144 [warning] S1 Encapsulator: Invalid IP invalid, dropping packet.
.16:05:02.245 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.562.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:02.245 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.564.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:05:02.256 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.564.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:02.256 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.566.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:05:02.283 [debug] SystemMonitor: Received unexpected message: :unexp
16:05:02.287 [debug] S1: TCPHandler received unexpected message: :unexp
16:05:02.287 [info] S1: Starting TCP Listener on port 0...
16:05:02.287 [debug] S1: Listener received unexpected message: :unexp
16:05:02.820 [info] S2: Starting UDP Listener on port 0...
16:05:02.820 [warning] S2: Received unexpected message: :unexp
16:05:02.820 [error] S2: UDP Listener socket closed unexpectedly. Terminating.
16:05:02.825 [info] DiskCleaner: Low disk space detected on . (< 15%). Starting autonomous cleanup...
16:05:02.825 [warning] DiskCleaner: Simulation - would delete oldest .dat files in . now.
16:05:02.830 [info] S2: Decapsulated packet from 127.0.0.1:20480. Payload size: 7 bytes.
16:05:02.830 [debug] S2: Successfully wrote 7 bytes to /tmp/diode_test/data_1766120702830_62_20480.dat. (Simulated secure write)
16:05:02.830 [info] S2: Decapsulated packet from 127.0.0.1:0. Payload size: 9 bytes.
16:05:02.831 [debug] S1: Generating end-to-end heartbeat.
16:05:02.831 [warning] S1 Heartbeat: Received unexpected message: :unexp
16:05:02.831 [error] S2: Critical Failure! Channel heartbeat missing for > 6 minutes. The diode path may be obstructed.
16:05:02.831 [warning] S2 HeartbeatMonitor: Received unexpected message: :unexp
..16:05:02.832 [info] S2: Starting UDP Listener on port 0...
16:05:02.833 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.833 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702833_63_80.dat. (Simulated secure write)
16:05:02.833 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.833 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702833_64_80.dat. (Simulated secure write)
16:05:02.833 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.833 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702833_65_80.dat. (Simulated secure write)
16:05:02.833 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.833 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702833_66_80.dat. (Simulated secure write)
16:05:02.833 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.833 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702833_67_80.dat. (Simulated secure write)
16:05:02.833 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.833 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702833_68_80.dat. (Simulated secure write)
16:05:02.833 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.833 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702833_69_80.dat. (Simulated secure write)
16:05:02.833 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.833 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702833_70_80.dat. (Simulated secure write)
16:05:02.833 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.833 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702833_71_80.dat. (Simulated secure write)
16:05:02.833 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.833 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702833_72_80.dat. (Simulated secure write)
16:05:02.834 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.834 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702834_73_80.dat. (Simulated secure write)
16:05:02.834 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.834 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702834_74_80.dat. (Simulated secure write)
16:05:02.834 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.834 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702834_75_80.dat. (Simulated secure write)
16:05:02.834 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.834 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702834_76_80.dat. (Simulated secure write)
16:05:02.834 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.834 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702834_77_80.dat. (Simulated secure write)
16:05:02.834 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.834 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702834_78_80.dat. (Simulated secure write)
16:05:02.834 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.834 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702834_79_80.dat. (Simulated secure write)
16:05:02.834 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.834 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702834_80_80.dat. (Simulated secure write)
16:05:02.834 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.834 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702834_81_80.dat. (Simulated secure write)
16:05:02.834 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.834 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702834_82_80.dat. (Simulated secure write)
16:05:02.835 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.835 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.835 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702835_83_80.dat. (Simulated secure write)
16:05:02.835 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702835_84_80.dat. (Simulated secure write)
16:05:02.835 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.835 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702835_85_80.dat. (Simulated secure write)
16:05:02.835 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.835 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702835_86_80.dat. (Simulated secure write)
16:05:02.835 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.835 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702835_87_80.dat. (Simulated secure write)
16:05:02.835 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.835 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702835_88_80.dat. (Simulated secure write)
16:05:02.835 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.835 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702835_89_80.dat. (Simulated secure write)
16:05:02.835 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.835 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702835_90_80.dat. (Simulated secure write)
16:05:02.835 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.835 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702835_91_80.dat. (Simulated secure write)
16:05:02.835 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.835 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702835_92_80.dat. (Simulated secure write)
16:05:02.836 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.836 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702836_93_80.dat. (Simulated secure write)
16:05:02.836 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.836 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702836_94_80.dat. (Simulated secure write)
16:05:02.836 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.836 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702836_95_80.dat. (Simulated secure write)
16:05:02.836 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.836 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702836_96_80.dat. (Simulated secure write)
16:05:02.836 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.836 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702836_97_80.dat. (Simulated secure write)
16:05:02.836 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.836 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702836_98_80.dat. (Simulated secure write)
16:05:02.836 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.836 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702836_99_80.dat. (Simulated secure write)
16:05:02.836 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.836 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702836_100_80.dat. (Simulated secure write)
16:05:02.836 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.836 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702836_101_80.dat. (Simulated secure write)
16:05:02.836 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.836 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702836_102_80.dat. (Simulated secure write)
16:05:02.837 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.837 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702837_103_80.dat. (Simulated secure write)
16:05:02.837 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.837 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702837_104_80.dat. (Simulated secure write)
16:05:02.837 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.837 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702837_105_80.dat. (Simulated secure write)
16:05:02.837 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.837 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702837_106_80.dat. (Simulated secure write)
16:05:02.837 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.837 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702837_107_80.dat. (Simulated secure write)
16:05:02.837 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.837 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702837_108_80.dat. (Simulated secure write)
16:05:02.837 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.837 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702837_109_80.dat. (Simulated secure write)
16:05:02.837 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.837 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702837_110_80.dat. (Simulated secure write)
16:05:02.837 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.837 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702837_111_80.dat. (Simulated secure write)
16:05:02.837 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.837 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702837_112_80.dat. (Simulated secure write)
16:05:02.837 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.837 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702837_113_80.dat. (Simulated secure write)
16:05:02.837 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.837 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702837_114_80.dat. (Simulated secure write)
16:05:02.838 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.838 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702838_115_80.dat. (Simulated secure write)
16:05:02.838 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.838 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702838_116_80.dat. (Simulated secure write)
16:05:02.838 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.838 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702838_117_80.dat. (Simulated secure write)
16:05:02.838 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.838 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702838_118_80.dat. (Simulated secure write)
16:05:02.838 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.838 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702838_119_80.dat. (Simulated secure write)
16:05:02.838 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.838 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702838_120_80.dat. (Simulated secure write)
16:05:02.838 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.838 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702838_121_80.dat. (Simulated secure write)
16:05:02.838 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.838 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702838_122_80.dat. (Simulated secure write)
16:05:02.838 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.838 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702838_123_80.dat. (Simulated secure write)
16:05:02.838 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.838 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702838_124_80.dat. (Simulated secure write)
16:05:02.838 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.838 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702838_125_80.dat. (Simulated secure write)
16:05:02.838 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.838 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702838_126_80.dat. (Simulated secure write)
16:05:02.839 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.839 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702839_127_80.dat. (Simulated secure write)
16:05:02.839 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.839 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702839_128_80.dat. (Simulated secure write)
16:05:02.839 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.839 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702839_129_80.dat. (Simulated secure write)
16:05:02.839 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.839 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702839_130_80.dat. (Simulated secure write)
16:05:02.839 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.839 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702839_131_80.dat. (Simulated secure write)
16:05:02.839 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.839 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702839_132_80.dat. (Simulated secure write)
16:05:02.839 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.839 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702839_133_80.dat. (Simulated secure write)
16:05:02.839 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.839 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702839_134_80.dat. (Simulated secure write)
16:05:02.839 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.839 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702839_135_80.dat. (Simulated secure write)
16:05:02.839 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.839 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702839_136_80.dat. (Simulated secure write)
16:05:02.839 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.839 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702839_137_80.dat. (Simulated secure write)
16:05:02.840 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.840 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702840_138_80.dat. (Simulated secure write)
16:05:02.840 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.840 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702840_139_80.dat. (Simulated secure write)
16:05:02.840 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.840 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702840_140_80.dat. (Simulated secure write)
16:05:02.840 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.840 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702840_141_80.dat. (Simulated secure write)
16:05:02.840 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.840 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702840_142_80.dat. (Simulated secure write)
16:05:02.840 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.840 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702840_143_80.dat. (Simulated secure write)
16:05:02.840 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.840 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702840_144_80.dat. (Simulated secure write)
16:05:02.840 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.840 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702840_145_80.dat. (Simulated secure write)
16:05:02.840 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.840 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702840_146_80.dat. (Simulated secure write)
16:05:02.840 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.840 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702840_147_80.dat. (Simulated secure write)
16:05:02.840 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.840 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702840_148_80.dat. (Simulated secure write)
16:05:02.840 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.841 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702841_149_80.dat. (Simulated secure write)
16:05:02.841 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.841 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702841_150_80.dat. (Simulated secure write)
16:05:02.841 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.841 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702841_151_80.dat. (Simulated secure write)
16:05:02.841 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.841 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702841_152_80.dat. (Simulated secure write)
16:05:02.841 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.841 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702841_153_80.dat. (Simulated secure write)
16:05:02.841 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.841 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702841_154_80.dat. (Simulated secure write)
16:05:02.841 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.841 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702841_155_80.dat. (Simulated secure write)
16:05:02.841 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.841 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702841_156_80.dat. (Simulated secure write)
16:05:02.841 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.841 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702841_157_80.dat. (Simulated secure write)
16:05:02.841 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.841 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702841_158_80.dat. (Simulated secure write)
16:05:02.841 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.841 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702841_159_80.dat. (Simulated secure write)
16:05:02.841 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.841 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702841_160_80.dat. (Simulated secure write)
16:05:02.841 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.841 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702841_161_80.dat. (Simulated secure write)
16:05:02.841 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:02.841 [debug] S2: Successfully wrote 7 bytes to ./data_1766120702841_162_80.dat. (Simulated secure write)
.16:05:02.942 [info] S2: Starting UDP Listener on port 0...
.16:05:02.942 [error] S2: UDP Listener socket closed unexpectedly. Terminating.
.16:05:02.943 [info] S2: Starting UDP Listener on port 0...
.16:05:02.972 [warning] S2: Invalid LISTEN_IP_S2 invalid, falling back to all interfaces.
...16:05:02.973 [info] S2: Starting UDP Listener on port 0...
16:05:02.974 [info] S2: Decapsulated packet from 1.2.3.4:80. Payload size: 5 bytes.
16:05:02.974 [debug] S2: Successfully wrote 5 bytes to ./data_1766120702974_163_80.dat. (Simulated secure write)
........16:05:02.987 [error] S1: Listener socket fatal error: :closed. Terminating.
..16:05:02.987 [info] S1: Starting TCP Listener on port 0...
16:05:03.488 [error] S1: Listener socket fatal error: :closed. Terminating.
16:05:03.488 [error] GenServer :s1_flapping_test_unique terminating
** (stop) :closed
Last message: :accept_loop
State: #Port<0.183>
16:05:03.488 [error] Process :s1_flapping_test_unique (#PID<0.774.0>) terminating
** (exit) :closed
    (stdlib 7.1) gen_server.erl:2562: :gen_server.handle_common_reply/5
    (stdlib 7.1) proc_lib.erl:333: :proc_lib.init_p_do_apply/3
Initial Call: DataDiode.S1.Listener.init/1
Ancestors: [#PID<0.773.0>]
Message Queue Length: 0
Messages: []
Links: []
Dictionary: []
Trapping Exits: false
Status: :running
Heap Size: 1598
Stack Size: 29
Reductions: 2750
.16:05:03.488 [warning] S1: Invalid LISTEN_IP invalid, using all interfaces.
..16:05:03.489 [info] S1: Starting TCP Listener on port 0...
.16:05:03.489 [info] S1: Starting TCP Listener on port 0...
16:05:03.990 [info] S1: New connection accepted.
....
Finished in 3.6 seconds (0.1s async, 3.5s sync)
1 doctest, 65 tests, 0 failures
Run 9
warning: setting :preferred_cli_env in your mix.exs "def project" is deprecated, set it inside "def cli" instead:

    def cli do
      [preferred_envs: [release: :prod, test: :test]]
    end

  (mix 1.19.4) lib/mix/cli.ex:187: Mix.CLI.preferred_cli_env/3
  (mix 1.19.4) lib/mix/cli.ex:170: Mix.CLI.maybe_change_env_and_target/2
  (mix 1.19.4) lib/mix/cli.ex:59: Mix.CLI.proceed/2
  /opt/homebrew/bin/mix:7: (file)
  (elixir 1.19.4) src/elixir_compiler.erl:81: :elixir_compiler.dispatch/4
  (elixir 1.19.4) src/elixir_compiler.erl:56: :elixir_compiler.compile/4

    warning: unused alias Decapsulator
    │
  8 │   alias DataDiode.S2.Decapsulator
    │   ~
    │
    └─ lib/data_diode/s2/listener.ex:8:3

16:05:04.981 [info] Application logger started at :nonode@nohost
16:05:04.985 [info] Child :ttb_autostart of Supervisor :runtime_tools_sup started
Pid: #PID<0.184.0>
Start Call: :ttb_autostart.start_link()
Restart: :temporary
Shutdown: 3000
Type: :worker
16:05:04.986 [info] Application runtime_tools started at :nonode@nohost
16:05:04.986 [info] Application opentelemetry_api started at :nonode@nohost
16:05:04.986 [info] Application ctx started at :nonode@nohost
16:05:04.986 [info] Application hpack started at :nonode@nohost
16:05:04.986 [info] Application chatterbox started at :nonode@nohost
16:05:04.986 [info] Application acceptor_pool started at :nonode@nohost
16:05:04.991 [info] Child :gproc of Supervisor :gproc_sup started
Pid: #PID<0.188.0>
Start Call: :gproc.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:05:04.991 [info] Child :gproc_monitor of Supervisor :gproc_sup started
Pid: #PID<0.189.0>
Start Call: :gproc_monitor.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:05:04.992 [info] Child :gproc_bcast of Supervisor :gproc_sup started
Pid: #PID<0.190.0>
Start Call: :gproc_bcast.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:05:04.994 [info] Child :gproc_pool of Supervisor :gproc_sup started
Pid: #PID<0.191.0>
Start Call: :gproc_pool.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:05:04.994 [info] Application gproc started at :nonode@nohost
16:05:05.003 [info] Child :grpcbox_services_simple_sup of Supervisor :grpcbox_sup started
Pid: #PID<0.195.0>
Start Call: :grpcbox_services_simple_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:05:05.003 [info] Child :grpcbox_channel_sup of Supervisor :grpcbox_sup started
Pid: #PID<0.196.0>
Start Call: :grpcbox_channel_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:05:05.003 [info] Application grpcbox started at :nonode@nohost
16:05:05.004 [info] Application ssl_verify_fun started at :nonode@nohost
16:05:05.087 [info] Loading 162 CA(s) from :otp store
16:05:05.087 [info] Child :tls_certificate_check_shared_state of Supervisor :tls_certificate_check_sup started
Pid: #PID<0.200.0>
Start Call: :tls_certificate_check_shared_state.start_link()
Restart: :permanent
Shutdown: :infinity
Type: :worker
16:05:05.087 [info] Application tls_certificate_check started at :nonode@nohost
16:05:05.087 [info] Application opentelemetry_exporter started at :nonode@nohost
16:05:05.092 [info] Child :otel_span_ets of Supervisor :otel_span_sup started
Pid: #PID<0.208.0>
Start Call: :otel_span_ets.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:05.093 [info] Child :otel_span_sweeper of Supervisor :otel_span_sup started
Pid: #PID<0.209.0>
Start Call: :otel_span_sweeper.start_link(%{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:05.093 [info] Child :otel_span_sup of Supervisor :opentelemetry_sup started
Pid: #PID<0.207.0>
Start Call: :otel_span_sup.start_link(%{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:05:05.096 [info] Child :otel_resource_detector of Supervisor :opentelemetry_sup started
Pid: #PID<0.210.0>
Start Call: :otel_resource_detector.start_link(%{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:05.097 [info] Child :otel_tracer_provider_sup of Supervisor :opentelemetry_sup started
Pid: #PID<0.213.0>
Start Call: :otel_tracer_provider_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:05:05.099 [info] Child :otel_span_processor_sup of Supervisor #PID<0.214.0> (:otel_tracer_server_sup) started
Pid: #PID<0.215.0>
Start Call: :otel_span_processor_sup.start_link(:otel_span_processor_sup_global)
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:05:05.104 [info] Child :otel_tracer_server of Supervisor #PID<0.214.0> (:otel_tracer_server_sup) started
Pid: #PID<0.216.0>
Start Call: :otel_tracer_server.start_link(:global, :otel_tracer_provider_global, :otel_span_processor_sup_global, {:resource, :undefined, {:attributes, 128, 255, 0, %{"process.executable.name": "erl", "process.runtime.description": "Erlang/OTP 28 erts-16.1.2", "process.runtime.version": "16.1.2", "process.runtime.name": "BEAM", "service.name": "unknown_service:erl", "service.instance.id": 26193575528582734469001841355302748639, "telemetry.sdk.version": "1.6.0", "telemetry.sdk.language": "erlang", "telemetry.sdk.name": "opentelemetry"}}}, %{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:05.108 [debug] Child {:httpc, :"otel_exporter_otlp_<0.217.0>"} of Supervisor :httpc_profile_sup started
Pid: #PID<0.218.0>
Start Call: :httpc_manager.start_link(:"otel_exporter_otlp_<0.217.0>", :only_session_cookies, :inets)
Restart: :permanent
Shutdown: 4000
Type: :worker
16:05:05.112 [info] Application opentelemetry started at :nonode@nohost
16:05:05.113 [info] OTLP exporter successfully initialized
16:05:05.114 [info] Application jason started at :nonode@nohost
16:05:05.114 [info] Application logger_json started at :nonode@nohost
16:05:05.114 [info] Application nimble_ownership started at :nonode@nohost
16:05:05.117 [info] Child Mox of Supervisor Mox.Supervisor started
Pid: #PID<0.222.0>
Start Call: Mox.start_link_ownership()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:05.117 [info] Application mox started at :nonode@nohost
16:05:05.122 [info] Child DataDiode.Metrics of Supervisor DataDiode.Supervisor started
Pid: #PID<0.226.0>
Start Call: DataDiode.Metrics.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:05.122 [info] Child DataDiode.SystemMonitor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.227.0>
Start Call: DataDiode.SystemMonitor.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:05.123 [info] S1: Starting TCP Listener on port 0...
16:05:05.123 [info] Child DataDiode.S1.Listener of Supervisor DataDiode.Supervisor started
Pid: #PID<0.228.0>
Start Call: DataDiode.S1.Listener.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:05.126 [info] Child DataDiode.S1.HandlerSupervisor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.229.0>
Start Call: DataDiode.S1.HandlerSupervisor.start_link()
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:05:05.128 [warning] S1 Encapsulator: Invalid S2_PORT 0, using default 42001
16:05:05.128 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.230.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:05.128 [info] Child DataDiode.S1.Heartbeat of Supervisor DataDiode.Supervisor started
Pid: #PID<0.231.0>
Start Call: DataDiode.S1.Heartbeat.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:05.128 [info] Child DataDiode.S2.HeartbeatMonitor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.232.0>
Start Call: DataDiode.S2.HeartbeatMonitor.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:05.129 [info] Child DataDiode.DiskCleaner of Supervisor DataDiode.Supervisor started
Pid: #PID<0.233.0>
Start Call: DataDiode.DiskCleaner.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:05.130 [info] S2: Starting UDP Listener on port 0...
16:05:05.130 [info] Child DataDiode.S2.Listener of Supervisor DataDiode.Supervisor started
Pid: #PID<0.234.0>
Start Call: DataDiode.S2.Listener.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:05.131 [info] Child DataDiode.S2.TaskSupervisor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.235.0>
Start Call: Task.Supervisor.start_link([name: DataDiode.S2.TaskSupervisor, max_children: 200])
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:05:05.131 [info] Application data_diode started at :nonode@nohost
16:05:05.137 [info] Child ExUnit.Server of Supervisor ExUnit.Supervisor started
Pid: #PID<0.241.0>
Start Call: ExUnit.Server.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:05.137 [info] Child ExUnit.CaptureServer of Supervisor ExUnit.Supervisor started
Pid: #PID<0.242.0>
Start Call: ExUnit.CaptureServer.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:05.137 [info] Application ex_unit started at :nonode@nohost
Running ExUnit with seed: 138909, max_cases: 16

     warning: redefining module DataDiode.S1.EncapsulatorMock (current version defined in memory)
     │
 491 │     Module.create(name, [info | body], Macro.Env.location(__ENV__))
     │     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     │
     └─ deps/mox/lib/mox.ex:491: DataDiode.S1.EncapsulatorMock (module)

    warning: variable "c" is unused (if the variable is not meant to be used, prefix it with an underscore)
    │
 26 │     {:ok, c} = :gen_tcp.connect({127,0,0,1}, port, [:binary, active: false])
    │           ~
    │
    └─ test/long_term_robustness_test.exs:26:11: DataDiode.LongTermRobustnessTest."test TCPHandler exhaustive branch coverage"/1

    warning: variable "pid3" is unused (if the variable is not meant to be used, prefix it with an underscore)
    │
 62 │     {:ok, pid3} = TCPHandler.start_link(s3)
    │           ~~~~
    │
    └─ test/long_term_robustness_test.exs:62:11: DataDiode.LongTermRobustnessTest."test TCPHandler exhaustive branch coverage"/1

..16:05:05.375 [warning] S1: Dropping oversized packet (1048577 bytes) from 1.2.3.4
.16:05:05.375 [debug] S1: TCPHandler received unexpected message: :unknown
.16:05:05.375 [info] S1: Connection closed by 1.2.3.4:80
...............16:05:05.405 [error] S2: Failed to parse header: invalid_packet_size
.16:05:05.406 [info] S2: Decapsulated packet from 0.0.0.0:0. Payload size: 0 bytes.
.16:05:05.406 [debug] S2: Successfully wrote 0 bytes to ./data_1766120705406_3_0.dat. (Simulated secure write)
.16:05:05.406 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 0 bytes.
.16:05:05.406 [debug] S2: Successfully wrote 0 bytes to ./data_1766120705406_4_51210.dat. (Simulated secure write)
.16:05:05.406 [error] S2: Failed to parse header: invalid_packet_size
.16:05:05.406 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 23 bytes.
16:05:05.406 [debug] S2: Successfully wrote 23 bytes to ./data_1766120705406_5_51210.dat. (Simulated secure write)
16:05:05.406 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 9 bytes.
16:05:05.407 [debug] S2: Successfully wrote 9 bytes to ./data_1766120705407_6_80.dat. (Simulated secure write)
16:05:05.407 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 23 bytes.
16:05:05.407 [debug] S2: Successfully wrote 23 bytes to ./data_1766120705407_7_51210.dat. (Simulated secure write)
.16:05:05.408 [error] S2: Failed to parse header: invalid_packet_size
......16:05:05.425 [info] S1: Starting TCP Listener on port 8092...
.16:05:05.425 [info] S1: New connection accepted.
16:05:05.425 [info] S1: New connection accepted.
16:05:05.429 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.37>}
16:05:05.429 [info] S1: New connection accepted.
16:05:05.429 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.39>}
16:05:05.429 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.46>}
16:05:05.430 [info] S1: New connection accepted.
16:05:05.430 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.47>}
16:05:05.430 [info] S1: New connection accepted.
16:05:05.430 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.48>}
16:05:05.430 [info] S1: New connection accepted.
16:05:05.430 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.49>}
16:05:05.430 [info] S1: New connection accepted.
16:05:05.430 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.50>}
16:05:05.458 [info] S1: New connection accepted.
16:05:05.458 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.51>}
16:05:05.458 [info] S1: New connection accepted.
16:05:05.458 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.53>}
16:05:05.458 [info] S1: New connection accepted.
16:05:05.458 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.55>}
16:05:05.458 [info] S1: New connection accepted.
16:05:05.458 [info] S1: New connection accepted.
16:05:05.458 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.57>}
16:05:05.458 [info] S1: New connection accepted.
16:05:05.458 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.59>}
16:05:05.459 [info] S1: New connection accepted.
16:05:05.459 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.61>}
16:05:05.459 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.63>}
16:05:05.459 [info] S1: New connection accepted.
16:05:05.459 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.65>}
16:05:05.459 [info] S1: New connection accepted.
16:05:05.459 [info] S1: New connection accepted.
16:05:05.459 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.67>}
16:05:05.459 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.69>}
16:05:05.459 [info] S1: New connection accepted.
16:05:05.459 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.71>}
16:05:05.459 [info] S1: New connection accepted.
16:05:05.459 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.73>}
16:05:05.459 [info] S1: New connection accepted.
16:05:05.460 [info] S1: New connection accepted.
16:05:05.460 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.75>}
16:05:05.460 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.77>}
16:05:05.460 [info] S1: New connection accepted.
16:05:05.460 [info] S1: New connection accepted.
16:05:05.460 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.80>}
16:05:05.460 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.81>}
16:05:05.460 [info] S1: New connection accepted.
16:05:05.460 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.83>}
16:05:05.460 [info] S1: New connection accepted.
16:05:05.460 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.85>}
16:05:05.461 [info] S1: New connection accepted.
16:05:05.461 [info] S1: New connection accepted.
16:05:05.461 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.87>}
16:05:05.461 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.89>}
16:05:05.461 [info] S1: New connection accepted.
16:05:05.461 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.91>}
16:05:05.461 [info] S1: New connection accepted.
16:05:05.461 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.93>}
16:05:05.461 [info] S1: New connection accepted.
16:05:05.461 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.95>}
16:05:05.461 [info] S1: New connection accepted.
16:05:05.462 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.97>}
16:05:05.462 [info] S1: New connection accepted.
16:05:05.462 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.99>}
16:05:05.462 [info] S1: New connection accepted.
16:05:05.462 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.101>}
16:05:05.462 [info] S1: New connection accepted.
16:05:05.462 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.103>}
16:05:05.462 [info] S1: New connection accepted.
16:05:05.462 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.105>}
16:05:05.462 [info] S1: New connection accepted.
16:05:05.462 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.107>}
16:05:05.462 [info] S1: New connection accepted.
16:05:05.462 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.109>}
16:05:05.463 [info] S1: New connection accepted.
16:05:05.463 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.111>}
16:05:05.463 [info] S1: New connection accepted.
16:05:05.463 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.113>}
16:05:05.463 [info] S1: New connection accepted.
16:05:05.463 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.115>}
16:05:05.463 [info] S1: New connection accepted.
16:05:05.463 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.117>}
16:05:05.463 [info] S1: New connection accepted.
16:05:05.463 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.119>}
16:05:05.463 [info] S1: New connection accepted.
16:05:05.463 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.121>}
16:05:05.464 [info] S1: New connection accepted.
16:05:05.464 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.123>}
16:05:05.464 [info] S1: New connection accepted.
16:05:05.464 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.125>}
16:05:05.464 [info] S1: New connection accepted.
16:05:05.464 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.127>}
16:05:05.464 [info] S1: New connection accepted.
16:05:05.464 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.129>}
16:05:05.464 [info] S1: New connection accepted.
16:05:05.464 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.131>}
16:05:05.465 [info] S1: New connection accepted.
16:05:05.465 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.133>}
16:05:05.465 [info] S1: New connection accepted.
16:05:05.465 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.135>}
.....16:05:06.128 [info] S1: New connection accepted.
16:05:06.128 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.142>}
16:05:06.128 [info] S1: New connection accepted.
16:05:06.128 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.145>}
16:05:06.128 [info] S1: New connection accepted.
16:05:06.128 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.147>}
16:05:06.128 [info] S1: New connection accepted.
16:05:06.128 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.148>}
16:05:06.129 [info] S1: New connection accepted.
16:05:06.129 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.150>}
.16:05:06.376 [debug] S1: TCPHandler received unexpected message: :accept_loop
.16:05:06.377 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.230.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:06.377 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.579.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:05:06.387 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.579.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:06.388 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.581.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:05:06.398 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.581.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:06.399 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.583.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:06.409 [warning] S1 Encapsulator: Invalid IP invalid, dropping packet.
.16:05:06.510 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.583.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:06.511 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.585.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
...16:05:06.522 [info] S2: Starting UDP Listener on port 0...
16:05:06.522 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.522 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.522 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706522_64_80.dat. (Simulated secure write)
16:05:06.522 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706522_63_80.dat. (Simulated secure write)
16:05:06.522 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.522 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706522_65_80.dat. (Simulated secure write)
16:05:06.522 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.522 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706522_66_80.dat. (Simulated secure write)
16:05:06.522 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.522 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706522_67_80.dat. (Simulated secure write)
16:05:06.522 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.522 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706522_68_80.dat. (Simulated secure write)
16:05:06.522 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.522 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706522_69_80.dat. (Simulated secure write)
16:05:06.522 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.522 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706522_70_80.dat. (Simulated secure write)
16:05:06.522 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.523 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.523 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706523_71_80.dat. (Simulated secure write)
16:05:06.523 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706523_72_80.dat. (Simulated secure write)
16:05:06.523 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.523 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706523_73_80.dat. (Simulated secure write)
16:05:06.523 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.523 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706523_74_80.dat. (Simulated secure write)
16:05:06.523 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.523 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706523_75_80.dat. (Simulated secure write)
16:05:06.523 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.523 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706523_76_80.dat. (Simulated secure write)
16:05:06.523 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.523 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706523_77_80.dat. (Simulated secure write)
16:05:06.523 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.523 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706523_78_80.dat. (Simulated secure write)
16:05:06.523 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.523 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706523_79_80.dat. (Simulated secure write)
16:05:06.523 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.523 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706523_80_80.dat. (Simulated secure write)
16:05:06.523 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.523 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706523_81_80.dat. (Simulated secure write)
16:05:06.523 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.523 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706523_82_80.dat. (Simulated secure write)
16:05:06.523 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.523 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706523_83_80.dat. (Simulated secure write)
16:05:06.523 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.523 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706523_84_80.dat. (Simulated secure write)
16:05:06.523 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.523 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706523_85_80.dat. (Simulated secure write)
16:05:06.523 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.523 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706523_86_80.dat. (Simulated secure write)
16:05:06.523 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.523 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706523_87_80.dat. (Simulated secure write)
16:05:06.524 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.524 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706524_88_80.dat. (Simulated secure write)
16:05:06.524 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.524 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706524_89_80.dat. (Simulated secure write)
16:05:06.524 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.524 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706524_90_80.dat. (Simulated secure write)
16:05:06.524 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.524 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706524_91_80.dat. (Simulated secure write)
16:05:06.524 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.524 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706524_92_80.dat. (Simulated secure write)
16:05:06.524 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.524 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706524_93_80.dat. (Simulated secure write)
16:05:06.524 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.524 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706524_94_80.dat. (Simulated secure write)
16:05:06.524 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.524 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706524_95_80.dat. (Simulated secure write)
16:05:06.524 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.524 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706524_96_80.dat. (Simulated secure write)
16:05:06.524 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.524 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706524_97_80.dat. (Simulated secure write)
16:05:06.525 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.525 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706525_98_80.dat. (Simulated secure write)
16:05:06.526 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.526 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706526_99_80.dat. (Simulated secure write)
16:05:06.526 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.526 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706526_100_80.dat. (Simulated secure write)
16:05:06.526 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.526 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706526_101_80.dat. (Simulated secure write)
16:05:06.527 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.527 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706527_102_80.dat. (Simulated secure write)
16:05:06.527 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.527 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706527_103_80.dat. (Simulated secure write)
16:05:06.527 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.527 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706527_104_80.dat. (Simulated secure write)
16:05:06.527 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.527 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706527_105_80.dat. (Simulated secure write)
16:05:06.527 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.527 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706527_106_80.dat. (Simulated secure write)
16:05:06.527 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.528 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706527_107_80.dat. (Simulated secure write)
16:05:06.528 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.528 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706528_108_80.dat. (Simulated secure write)
16:05:06.528 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.528 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706528_109_80.dat. (Simulated secure write)
16:05:06.528 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.528 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706528_110_80.dat. (Simulated secure write)
16:05:06.528 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.528 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706528_111_80.dat. (Simulated secure write)
16:05:06.528 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.528 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706528_112_80.dat. (Simulated secure write)
16:05:06.528 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.529 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.529 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706529_113_80.dat. (Simulated secure write)
16:05:06.529 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706529_114_80.dat. (Simulated secure write)
16:05:06.529 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.529 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706529_115_80.dat. (Simulated secure write)
16:05:06.529 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.529 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.529 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.529 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.529 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.529 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.529 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.529 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.529 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.529 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.529 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.529 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.529 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.529 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.530 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.530 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.530 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.530 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.530 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.530 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.530 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.530 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.530 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.530 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.530 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.530 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.531 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.531 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.531 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.531 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.531 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.531 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.531 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.531 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.531 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.531 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.531 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.531 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.531 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.531 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.531 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.531 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.531 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.531 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.531 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.531 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.531 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:06.532 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706532_116_80.dat. (Simulated secure write)
16:05:06.532 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706532_123_80.dat. (Simulated secure write)
16:05:06.532 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706532_117_80.dat. (Simulated secure write)
16:05:06.532 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706532_118_80.dat. (Simulated secure write)
16:05:06.532 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706532_119_80.dat. (Simulated secure write)
16:05:06.532 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706532_120_80.dat. (Simulated secure write)
16:05:06.532 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706532_121_80.dat. (Simulated secure write)
16:05:06.532 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706532_122_80.dat. (Simulated secure write)
16:05:06.532 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706532_124_80.dat. (Simulated secure write)
16:05:06.532 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706532_129_80.dat. (Simulated secure write)
16:05:06.532 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706532_125_80.dat. (Simulated secure write)
16:05:06.532 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706532_126_80.dat. (Simulated secure write)
16:05:06.532 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706532_128_80.dat. (Simulated secure write)
16:05:06.532 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706532_127_80.dat. (Simulated secure write)
16:05:06.532 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706532_131_80.dat. (Simulated secure write)
16:05:06.532 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706532_132_80.dat. (Simulated secure write)
16:05:06.532 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706532_134_80.dat. (Simulated secure write)
16:05:06.532 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706532_139_80.dat. (Simulated secure write)
16:05:06.532 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706532_135_80.dat. (Simulated secure write)
16:05:06.532 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706532_137_80.dat. (Simulated secure write)
16:05:06.532 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706532_140_80.dat. (Simulated secure write)
16:05:06.532 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706532_130_80.dat. (Simulated secure write)
16:05:06.532 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706532_136_80.dat. (Simulated secure write)
16:05:06.532 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706532_133_80.dat. (Simulated secure write)
16:05:06.532 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706532_143_80.dat. (Simulated secure write)
16:05:06.532 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706532_138_80.dat. (Simulated secure write)
16:05:06.532 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706532_141_80.dat. (Simulated secure write)
16:05:06.532 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706532_142_80.dat. (Simulated secure write)
16:05:06.532 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706532_145_80.dat. (Simulated secure write)
16:05:06.532 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706532_144_80.dat. (Simulated secure write)
16:05:06.532 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706532_146_80.dat. (Simulated secure write)
16:05:06.533 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706533_149_80.dat. (Simulated secure write)
16:05:06.533 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706533_148_80.dat. (Simulated secure write)
16:05:06.533 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706533_151_80.dat. (Simulated secure write)
16:05:06.533 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706533_150_80.dat. (Simulated secure write)
16:05:06.533 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706533_153_80.dat. (Simulated secure write)
16:05:06.533 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706533_147_80.dat. (Simulated secure write)
16:05:06.533 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706533_152_80.dat. (Simulated secure write)
16:05:06.533 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706533_155_80.dat. (Simulated secure write)
16:05:06.533 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706533_154_80.dat. (Simulated secure write)
16:05:06.533 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706533_156_80.dat. (Simulated secure write)
16:05:06.533 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706533_157_80.dat. (Simulated secure write)
16:05:06.533 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706533_159_80.dat. (Simulated secure write)
16:05:06.533 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706533_161_80.dat. (Simulated secure write)
16:05:06.533 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706533_162_80.dat. (Simulated secure write)
16:05:06.533 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706533_158_80.dat. (Simulated secure write)
16:05:06.533 [debug] S2: Successfully wrote 7 bytes to ./data_1766120706533_160_80.dat. (Simulated secure write)
.16:05:06.632 [warning] S2: Invalid LISTEN_IP_S2 invalid, falling back to all interfaces.
.16:05:06.632 [error] S2: UDP Listener socket closed unexpectedly. Terminating.
.16:05:06.633 [info] S2: Starting UDP Listener on port 0...
..16:05:06.633 [info] S2: Starting UDP Listener on port 0...
.16:05:06.654 [info] S2: Starting UDP Listener on port 0...
16:05:06.655 [info] S2: Decapsulated packet from 1.2.3.4:80. Payload size: 5 bytes.
16:05:06.655 [debug] S2: Successfully wrote 5 bytes to ./data_1766120706655_163_80.dat. (Simulated secure write)
...16:05:06.673 [debug] SystemMonitor: Received unexpected message: :unexp
16:05:06.676 [debug] S1: TCPHandler received unexpected message: :unexp
16:05:06.676 [info] S1: Starting TCP Listener on port 0...
16:05:06.676 [debug] S1: Listener received unexpected message: :unexp
16:05:07.632 [info] S2: Starting UDP Listener on port 0...
16:05:07.632 [warning] S2: Received unexpected message: :unexp
16:05:07.632 [error] S2: UDP Listener socket closed unexpectedly. Terminating.
16:05:07.638 [info] DiskCleaner: Low disk space detected on . (< 15%). Starting autonomous cleanup...
16:05:07.638 [warning] DiskCleaner: Simulation - would delete oldest .dat files in . now.
16:05:07.643 [info] S2: Decapsulated packet from 127.0.0.1:20480. Payload size: 7 bytes.
16:05:07.643 [debug] S2: Successfully wrote 7 bytes to /tmp/diode_test/data_1766120707643_165_20480.dat. (Simulated secure write)
16:05:07.643 [info] S2: Decapsulated packet from 127.0.0.1:0. Payload size: 9 bytes.
16:05:07.645 [debug] S1: Generating end-to-end heartbeat.
16:05:07.645 [warning] S1 Heartbeat: Received unexpected message: :unexp
16:05:07.645 [error] S2: Critical Failure! Channel heartbeat missing for > 6 minutes. The diode path may be obstructed.
16:05:07.645 [warning] S2 HeartbeatMonitor: Received unexpected message: :unexp
..16:05:07.647 [error] S1: Listener socket fatal error: :closed. Terminating.
.16:05:07.647 [info] S1: Starting TCP Listener on port 0...
16:05:08.149 [info] S1: New connection accepted.
..16:05:08.150 [info] S1: Starting TCP Listener on port 0...
.16:05:08.150 [warning] S1: Invalid LISTEN_IP invalid, using all interfaces.
.16:05:08.151 [info] S1: Starting TCP Listener on port 0...
16:05:08.651 [error] S1: Listener socket fatal error: :closed. Terminating.
16:05:08.651 [error] GenServer :s1_flapping_test_unique terminating
** (stop) :closed
Last message: :accept_loop
State: #Port<0.187>
16:05:08.651 [error] Process :s1_flapping_test_unique (#PID<0.798.0>) terminating
** (exit) :closed
    (stdlib 7.1) gen_server.erl:2562: :gen_server.handle_common_reply/5
    (stdlib 7.1) proc_lib.erl:333: :proc_lib.init_p_do_apply/3
Initial Call: DataDiode.S1.Listener.init/1
Ancestors: [#PID<0.797.0>]
Message Queue Length: 0
Messages: []
Links: []
Dictionary: []
Trapping Exits: false
Status: :running
Heap Size: 1598
Stack Size: 29
Reductions: 2746
....
Finished in 3.9 seconds (0.2s async, 3.7s sync)
1 doctest, 65 tests, 0 failures
Run 10
warning: setting :preferred_cli_env in your mix.exs "def project" is deprecated, set it inside "def cli" instead:

    def cli do
      [preferred_envs: [release: :prod, test: :test]]
    end

  (mix 1.19.4) lib/mix/cli.ex:187: Mix.CLI.preferred_cli_env/3
  (mix 1.19.4) lib/mix/cli.ex:170: Mix.CLI.maybe_change_env_and_target/2
  (mix 1.19.4) lib/mix/cli.ex:59: Mix.CLI.proceed/2
  /opt/homebrew/bin/mix:7: (file)
  (elixir 1.19.4) src/elixir_compiler.erl:81: :elixir_compiler.dispatch/4
  (elixir 1.19.4) src/elixir_compiler.erl:56: :elixir_compiler.compile/4

    warning: unused alias Decapsulator
    │
  8 │   alias DataDiode.S2.Decapsulator
    │   ~
    │
    └─ lib/data_diode/s2/listener.ex:8:3

16:05:09.651 [info] Application logger started at :nonode@nohost
16:05:09.657 [info] Child :ttb_autostart of Supervisor :runtime_tools_sup started
Pid: #PID<0.184.0>
Start Call: :ttb_autostart.start_link()
Restart: :temporary
Shutdown: 3000
Type: :worker
16:05:09.657 [info] Application runtime_tools started at :nonode@nohost
16:05:09.657 [info] Application opentelemetry_api started at :nonode@nohost
16:05:09.657 [info] Application ctx started at :nonode@nohost
16:05:09.657 [info] Application hpack started at :nonode@nohost
16:05:09.657 [info] Application chatterbox started at :nonode@nohost
16:05:09.657 [info] Application acceptor_pool started at :nonode@nohost
16:05:09.664 [info] Child :gproc of Supervisor :gproc_sup started
Pid: #PID<0.188.0>
Start Call: :gproc.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:05:09.664 [info] Child :gproc_monitor of Supervisor :gproc_sup started
Pid: #PID<0.189.0>
Start Call: :gproc_monitor.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:05:09.665 [info] Child :gproc_bcast of Supervisor :gproc_sup started
Pid: #PID<0.190.0>
Start Call: :gproc_bcast.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:05:09.667 [info] Child :gproc_pool of Supervisor :gproc_sup started
Pid: #PID<0.191.0>
Start Call: :gproc_pool.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:05:09.667 [info] Application gproc started at :nonode@nohost
16:05:09.668 [info] Child :grpcbox_services_simple_sup of Supervisor :grpcbox_sup started
Pid: #PID<0.195.0>
Start Call: :grpcbox_services_simple_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:05:09.668 [info] Child :grpcbox_channel_sup of Supervisor :grpcbox_sup started
Pid: #PID<0.196.0>
Start Call: :grpcbox_channel_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:05:09.668 [info] Application grpcbox started at :nonode@nohost
16:05:09.669 [info] Application ssl_verify_fun started at :nonode@nohost
16:05:09.729 [info] Loading 162 CA(s) from :otp store
16:05:09.729 [info] Child :tls_certificate_check_shared_state of Supervisor :tls_certificate_check_sup started
Pid: #PID<0.200.0>
Start Call: :tls_certificate_check_shared_state.start_link()
Restart: :permanent
Shutdown: :infinity
Type: :worker
16:05:09.729 [info] Application tls_certificate_check started at :nonode@nohost
16:05:09.729 [info] Application opentelemetry_exporter started at :nonode@nohost
16:05:09.746 [info] Child :otel_span_ets of Supervisor :otel_span_sup started
Pid: #PID<0.208.0>
Start Call: :otel_span_ets.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:09.747 [info] Child :otel_span_sweeper of Supervisor :otel_span_sup started
Pid: #PID<0.209.0>
Start Call: :otel_span_sweeper.start_link(%{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:09.747 [info] Child :otel_span_sup of Supervisor :opentelemetry_sup started
Pid: #PID<0.207.0>
Start Call: :otel_span_sup.start_link(%{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:05:09.750 [info] Child :otel_resource_detector of Supervisor :opentelemetry_sup started
Pid: #PID<0.210.0>
Start Call: :otel_resource_detector.start_link(%{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:09.751 [info] Child :otel_tracer_provider_sup of Supervisor :opentelemetry_sup started
Pid: #PID<0.213.0>
Start Call: :otel_tracer_provider_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:05:09.753 [info] Child :otel_span_processor_sup of Supervisor #PID<0.214.0> (:otel_tracer_server_sup) started
Pid: #PID<0.215.0>
Start Call: :otel_span_processor_sup.start_link(:otel_span_processor_sup_global)
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:05:09.758 [info] Child :otel_tracer_server of Supervisor #PID<0.214.0> (:otel_tracer_server_sup) started
Pid: #PID<0.216.0>
Start Call: :otel_tracer_server.start_link(:global, :otel_tracer_provider_global, :otel_span_processor_sup_global, {:resource, :undefined, {:attributes, 128, 255, 0, %{"process.executable.name": "erl", "process.runtime.description": "Erlang/OTP 28 erts-16.1.2", "process.runtime.version": "16.1.2", "process.runtime.name": "BEAM", "service.name": "unknown_service:erl", "service.instance.id": 82710871341887969620576413934253247049, "telemetry.sdk.version": "1.6.0", "telemetry.sdk.language": "erlang", "telemetry.sdk.name": "opentelemetry"}}}, %{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:09.760 [debug] Child {:httpc, :"otel_exporter_otlp_<0.217.0>"} of Supervisor :httpc_profile_sup started
Pid: #PID<0.218.0>
Start Call: :httpc_manager.start_link(:"otel_exporter_otlp_<0.217.0>", :only_session_cookies, :inets)
Restart: :permanent
Shutdown: 4000
Type: :worker
16:05:09.764 [info] OTLP exporter successfully initialized
16:05:09.764 [info] Application opentelemetry started at :nonode@nohost
16:05:09.765 [info] Application jason started at :nonode@nohost
16:05:09.765 [info] Application logger_json started at :nonode@nohost
16:05:09.766 [info] Application nimble_ownership started at :nonode@nohost
16:05:09.768 [info] Child Mox of Supervisor Mox.Supervisor started
Pid: #PID<0.222.0>
Start Call: Mox.start_link_ownership()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:09.768 [info] Application mox started at :nonode@nohost
16:05:09.772 [info] Child DataDiode.Metrics of Supervisor DataDiode.Supervisor started
Pid: #PID<0.226.0>
Start Call: DataDiode.Metrics.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:09.772 [info] Child DataDiode.SystemMonitor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.227.0>
Start Call: DataDiode.SystemMonitor.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:09.773 [info] S1: Starting TCP Listener on port 0...
16:05:09.773 [info] Child DataDiode.S1.Listener of Supervisor DataDiode.Supervisor started
Pid: #PID<0.228.0>
Start Call: DataDiode.S1.Listener.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:09.775 [info] Child DataDiode.S1.HandlerSupervisor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.229.0>
Start Call: DataDiode.S1.HandlerSupervisor.start_link()
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:05:09.776 [warning] S1 Encapsulator: Invalid S2_PORT 0, using default 42001
16:05:09.776 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.230.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:09.776 [info] Child DataDiode.S1.Heartbeat of Supervisor DataDiode.Supervisor started
Pid: #PID<0.231.0>
Start Call: DataDiode.S1.Heartbeat.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:09.776 [info] Child DataDiode.S2.HeartbeatMonitor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.232.0>
Start Call: DataDiode.S2.HeartbeatMonitor.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:09.776 [info] Child DataDiode.DiskCleaner of Supervisor DataDiode.Supervisor started
Pid: #PID<0.233.0>
Start Call: DataDiode.DiskCleaner.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:09.777 [info] S2: Starting UDP Listener on port 0...
16:05:09.777 [info] Child DataDiode.S2.Listener of Supervisor DataDiode.Supervisor started
Pid: #PID<0.234.0>
Start Call: DataDiode.S2.Listener.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:09.777 [info] Child DataDiode.S2.TaskSupervisor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.235.0>
Start Call: Task.Supervisor.start_link([name: DataDiode.S2.TaskSupervisor, max_children: 200])
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:05:09.777 [info] Application data_diode started at :nonode@nohost
16:05:09.782 [info] Child ExUnit.Server of Supervisor ExUnit.Supervisor started
Pid: #PID<0.241.0>
Start Call: ExUnit.Server.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:09.782 [info] Child ExUnit.CaptureServer of Supervisor ExUnit.Supervisor started
Pid: #PID<0.242.0>
Start Call: ExUnit.CaptureServer.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:09.782 [info] Application ex_unit started at :nonode@nohost
Running ExUnit with seed: 783777, max_cases: 16

     warning: redefining module DataDiode.S1.EncapsulatorMock (current version defined in memory)
     │
 491 │     Module.create(name, [info | body], Macro.Env.location(__ENV__))
     │     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     │
     └─ deps/mox/lib/mox.ex:491: DataDiode.S1.EncapsulatorMock (module)

    warning: variable "c" is unused (if the variable is not meant to be used, prefix it with an underscore)
    │
 26 │     {:ok, c} = :gen_tcp.connect({127,0,0,1}, port, [:binary, active: false])
    │           ~
    │
    └─ test/long_term_robustness_test.exs:26:11: DataDiode.LongTermRobustnessTest."test TCPHandler exhaustive branch coverage"/1

    warning: variable "pid3" is unused (if the variable is not meant to be used, prefix it with an underscore)
    │
 62 │     {:ok, pid3} = TCPHandler.start_link(s3)
    │           ~~~~
    │
    └─ test/long_term_robustness_test.exs:62:11: DataDiode.LongTermRobustnessTest."test TCPHandler exhaustive branch coverage"/1

.............16:05:09.871 [info] S1: Forwarded 11 bytes.
16:05:09.874 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 23 bytes.
16:05:09.874 [debug] S2: Successfully wrote 23 bytes to ./data_1766120709874_3_51210.dat. (Simulated secure write)
...16:05:09.876 [error] S2: Failed to parse header: invalid_packet_size
.16:05:09.876 [info] S2: Decapsulated packet from 0.0.0.0:0. Payload size: 0 bytes.
.16:05:09.876 [debug] S2: Successfully wrote 0 bytes to ./data_1766120709876_4_0.dat. (Simulated secure write)
16:05:09.876 [error] S2: Failed to parse header: invalid_packet_size
.16:05:09.876 [error] S2: Failed to parse header: invalid_packet_size
.16:05:09.876 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 9 bytes.
.16:05:09.876 [debug] S2: Successfully wrote 9 bytes to ./data_1766120709876_5_80.dat. (Simulated secure write)
16:05:09.877 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 23 bytes.
.16:05:09.877 [debug] S2: Successfully wrote 23 bytes to ./data_1766120709877_6_51210.dat. (Simulated secure write)
.16:05:09.877 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 0 bytes.
16:05:09.877 [debug] S2: Successfully wrote 0 bytes to ./data_1766120709877_7_51210.dat. (Simulated secure write)
.16:05:09.883 [debug] S1: TCPHandler received unexpected message: :accept_loop
.16:05:09.883 [error] S1: TCP error for 1.2.3.4: :econnreset
.16:05:09.883 [info] S1: Connection closed by 1.2.3.4:80
........16:05:09.966 [debug] S1: TCPHandler received unexpected message: :accept_loop
....16:05:10.275 [info] S1: New connection accepted.
16:05:10.277 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.45>}
16:05:10.277 [info] S1: New connection accepted.
16:05:10.277 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.50>}
16:05:10.277 [info] S1: New connection accepted.
16:05:10.277 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.51>}
16:05:10.277 [info] S1: New connection accepted.
16:05:10.277 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.52>}
16:05:10.277 [info] S1: New connection accepted.
16:05:10.277 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.53>}
...16:05:10.980 [info] S1: Starting TCP Listener on port 0...
16:05:11.481 [info] S1: New connection accepted.
.16:05:11.481 [error] S1: Listener socket fatal error: :closed. Terminating.
.16:05:11.481 [info] S1: Starting TCP Listener on port 0...
...16:05:11.482 [info] S1: Starting TCP Listener on port 0...
16:05:11.982 [error] S1: Listener socket fatal error: :closed. Terminating.
16:05:11.982 [error] GenServer :s1_flapping_test_unique terminating
** (stop) :closed
Last message: :accept_loop
State: #Port<0.60>
16:05:11.982 [error] Process :s1_flapping_test_unique (#PID<0.540.0>) terminating
** (exit) :closed
    (stdlib 7.1) gen_server.erl:2562: :gen_server.handle_common_reply/5
    (stdlib 7.1) proc_lib.erl:333: :proc_lib.init_p_do_apply/3
Initial Call: DataDiode.S1.Listener.init/1
Ancestors: [#PID<0.539.0>]
Message Queue Length: 0
Messages: []
Links: []
Dictionary: []
Trapping Exits: false
Status: :running
Heap Size: 1598
Stack Size: 29
Reductions: 2751
.16:05:11.983 [warning] S1: Invalid LISTEN_IP invalid, using all interfaces.
....16:05:12.034 [info] S1: Starting TCP Listener on port 8092...
16:05:12.035 [info] S1: New connection accepted.
16:05:12.035 [info] S1: New connection accepted.
16:05:12.035 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.66>}
16:05:12.035 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.68>}
16:05:12.035 [info] S1: New connection accepted.
16:05:12.035 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.70>}
16:05:12.035 [info] S1: New connection accepted.
16:05:12.035 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.72>}
16:05:12.036 [info] S1: New connection accepted.
16:05:12.036 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.74>}
16:05:12.036 [info] S1: New connection accepted.
16:05:12.036 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.76>}
16:05:12.036 [info] S1: New connection accepted.
16:05:12.036 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.78>}
16:05:12.036 [info] S1: New connection accepted.
16:05:12.036 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.80>}
16:05:12.036 [info] S1: New connection accepted.
16:05:12.036 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.82>}
16:05:12.036 [info] S1: New connection accepted.
16:05:12.036 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.84>}
16:05:12.037 [info] S1: New connection accepted.
16:05:12.037 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.86>}
16:05:12.037 [info] S1: New connection accepted.
16:05:12.037 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.88>}
16:05:12.037 [info] S1: New connection accepted.
16:05:12.037 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.90>}
16:05:12.037 [info] S1: New connection accepted.
16:05:12.037 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.92>}
16:05:12.037 [info] S1: New connection accepted.
16:05:12.037 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.94>}
16:05:12.037 [info] S1: New connection accepted.
16:05:12.037 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.96>}
16:05:12.037 [info] S1: New connection accepted.
16:05:12.038 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.98>}
16:05:12.038 [info] S1: New connection accepted.
16:05:12.038 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.100>}
16:05:12.038 [info] S1: New connection accepted.
16:05:12.038 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.102>}
16:05:12.038 [info] S1: New connection accepted.
16:05:12.038 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.104>}
16:05:12.038 [info] S1: New connection accepted.
16:05:12.038 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.106>}
16:05:12.038 [info] S1: New connection accepted.
16:05:12.038 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.108>}
16:05:12.038 [info] S1: New connection accepted.
16:05:12.039 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.110>}
16:05:12.039 [info] S1: New connection accepted.
16:05:12.039 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.112>}
16:05:12.039 [info] S1: New connection accepted.
16:05:12.039 [info] S1: New connection accepted.
16:05:12.039 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.114>}
16:05:12.039 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.116>}
16:05:12.039 [info] S1: New connection accepted.
16:05:12.039 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.118>}
16:05:12.039 [info] S1: New connection accepted.
16:05:12.039 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.120>}
16:05:12.040 [info] S1: New connection accepted.
16:05:12.040 [info] S1: New connection accepted.
16:05:12.040 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.122>}
16:05:12.040 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.124>}
16:05:12.040 [info] S1: New connection accepted.
16:05:12.040 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.126>}
16:05:12.040 [info] S1: New connection accepted.
16:05:12.040 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.128>}
16:05:12.040 [info] S1: New connection accepted.
16:05:12.040 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.130>}
16:05:12.040 [info] S1: New connection accepted.
16:05:12.040 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.132>}
16:05:12.041 [info] S1: New connection accepted.
16:05:12.041 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.134>}
16:05:12.041 [info] S1: New connection accepted.
16:05:12.041 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.136>}
16:05:12.041 [info] S1: New connection accepted.
16:05:12.041 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.138>}
16:05:12.041 [info] S1: New connection accepted.
16:05:12.041 [info] S1: New connection accepted.
16:05:12.041 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.140>}
16:05:12.041 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.142>}
16:05:12.041 [info] S1: New connection accepted.
16:05:12.041 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.144>}
16:05:12.041 [info] S1: New connection accepted.
16:05:12.041 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.146>}
16:05:12.042 [info] S1: New connection accepted.
16:05:12.042 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.148>}
16:05:12.042 [info] S1: New connection accepted.
16:05:12.042 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.150>}
16:05:12.042 [info] S1: New connection accepted.
16:05:12.042 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.152>}
16:05:12.042 [info] S1: New connection accepted.
16:05:12.042 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.154>}
16:05:12.042 [info] S1: New connection accepted.
16:05:12.042 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.156>}
16:05:12.042 [info] S1: New connection accepted.
16:05:12.042 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.158>}
16:05:12.042 [info] S1: New connection accepted.
16:05:12.042 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.160>}
16:05:12.043 [info] S1: New connection accepted.
16:05:12.043 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.162>}
16:05:12.043 [info] S1: New connection accepted.
16:05:12.043 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.164>}
.16:05:12.557 [debug] SystemMonitor: Received unexpected message: :unexp
16:05:12.561 [debug] S1: TCPHandler received unexpected message: :unexp
16:05:12.561 [info] S1: Starting TCP Listener on port 0...
16:05:12.561 [debug] S1: Listener received unexpected message: :unexp
16:05:13.283 [info] S2: Starting UDP Listener on port 0...
16:05:13.284 [warning] S2: Received unexpected message: :unexp
16:05:13.284 [error] S2: UDP Listener socket closed unexpectedly. Terminating.
16:05:13.290 [info] DiskCleaner: Low disk space detected on . (< 15%). Starting autonomous cleanup...
16:05:13.290 [warning] DiskCleaner: Simulation - would delete oldest .dat files in . now.
16:05:13.296 [info] S2: Decapsulated packet from 127.0.0.1:20480. Payload size: 7 bytes.
16:05:13.296 [debug] S2: Successfully wrote 7 bytes to /tmp/diode_test/data_1766120713296_64_20480.dat. (Simulated secure write)
16:05:13.296 [info] S2: Decapsulated packet from 127.0.0.1:0. Payload size: 9 bytes.
16:05:13.297 [debug] S1: Generating end-to-end heartbeat.
16:05:13.297 [warning] S1 Heartbeat: Received unexpected message: :unexp
16:05:13.297 [error] S2: Critical Failure! Channel heartbeat missing for > 6 minutes. The diode path may be obstructed.
16:05:13.297 [warning] S2 HeartbeatMonitor: Received unexpected message: :unexp
.16:05:13.299 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.230.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:13.299 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.673.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:05:13.309 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.673.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:13.310 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.675.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:05:13.320 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.675.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:13.320 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.677.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:05:13.331 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.677.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:13.332 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.679.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:05:13.342 [warning] S1 Encapsulator: Invalid IP invalid, dropping packet.
..16:05:13.444 [info] S2: Starting UDP Listener on port 0...
16:05:13.444 [info] S2: Decapsulated packet from 1.2.3.4:80. Payload size: 5 bytes.
16:05:13.444 [debug] S2: Successfully wrote 5 bytes to ./data_1766120713444_65_80.dat. (Simulated secure write)
...16:05:13.456 [warning] S2: Invalid LISTEN_IP_S2 invalid, falling back to all interfaces.
.16:05:13.456 [info] S2: Starting UDP Listener on port 0...
.16:05:13.478 [info] S2: Starting UDP Listener on port 0...
.16:05:13.478 [error] S2: UDP Listener socket closed unexpectedly. Terminating.
.16:05:13.478 [info] S2: Starting UDP Listener on port 0...
16:05:13.478 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.478 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713478_66_80.dat. (Simulated secure write)
16:05:13.478 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.479 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713478_67_80.dat. (Simulated secure write)
16:05:13.479 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.479 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713479_68_80.dat. (Simulated secure write)
16:05:13.479 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.479 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713479_69_80.dat. (Simulated secure write)
16:05:13.479 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.479 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713479_70_80.dat. (Simulated secure write)
16:05:13.479 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.479 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713479_71_80.dat. (Simulated secure write)
16:05:13.479 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.479 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713479_72_80.dat. (Simulated secure write)
16:05:13.479 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.479 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713479_73_80.dat. (Simulated secure write)
16:05:13.479 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.480 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713480_74_80.dat. (Simulated secure write)
16:05:13.480 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.480 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713480_75_80.dat. (Simulated secure write)
16:05:13.480 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.480 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713480_76_80.dat. (Simulated secure write)
16:05:13.480 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.480 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713480_77_80.dat. (Simulated secure write)
16:05:13.480 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.480 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713480_78_80.dat. (Simulated secure write)
16:05:13.480 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.480 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713480_79_80.dat. (Simulated secure write)
16:05:13.480 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.480 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713480_80_80.dat. (Simulated secure write)
16:05:13.480 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.480 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713480_81_80.dat. (Simulated secure write)
16:05:13.481 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.481 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713481_82_80.dat. (Simulated secure write)
16:05:13.481 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.481 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713481_83_80.dat. (Simulated secure write)
16:05:13.481 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.481 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713481_84_80.dat. (Simulated secure write)
16:05:13.481 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.481 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713481_85_80.dat. (Simulated secure write)
16:05:13.481 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.481 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713481_86_80.dat. (Simulated secure write)
16:05:13.481 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.481 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713481_87_80.dat. (Simulated secure write)
16:05:13.481 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.481 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713481_88_80.dat. (Simulated secure write)
16:05:13.482 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.482 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713482_89_80.dat. (Simulated secure write)
16:05:13.482 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.482 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713482_90_80.dat. (Simulated secure write)
16:05:13.482 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.482 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713482_91_80.dat. (Simulated secure write)
16:05:13.482 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.482 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713482_92_80.dat. (Simulated secure write)
16:05:13.482 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.482 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713482_93_80.dat. (Simulated secure write)
16:05:13.482 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.482 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713482_94_80.dat. (Simulated secure write)
16:05:13.482 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.483 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713483_95_80.dat. (Simulated secure write)
16:05:13.483 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.483 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713483_96_80.dat. (Simulated secure write)
16:05:13.483 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.483 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713483_97_80.dat. (Simulated secure write)
16:05:13.483 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.483 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713483_98_80.dat. (Simulated secure write)
16:05:13.483 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.483 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713483_99_80.dat. (Simulated secure write)
16:05:13.483 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.483 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713483_100_80.dat. (Simulated secure write)
16:05:13.484 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.484 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713484_101_80.dat. (Simulated secure write)
16:05:13.484 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.484 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713484_102_80.dat. (Simulated secure write)
16:05:13.484 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.484 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713484_103_80.dat. (Simulated secure write)
16:05:13.484 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.484 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713484_104_80.dat. (Simulated secure write)
16:05:13.484 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.484 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713484_105_80.dat. (Simulated secure write)
16:05:13.484 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.484 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713484_106_80.dat. (Simulated secure write)
16:05:13.484 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.484 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713484_107_80.dat. (Simulated secure write)
16:05:13.485 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.485 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713485_108_80.dat. (Simulated secure write)
16:05:13.485 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.485 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713485_109_80.dat. (Simulated secure write)
16:05:13.485 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.485 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713485_110_80.dat. (Simulated secure write)
16:05:13.485 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.485 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713485_111_80.dat. (Simulated secure write)
16:05:13.485 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.485 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713485_112_80.dat. (Simulated secure write)
16:05:13.485 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.485 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713485_113_80.dat. (Simulated secure write)
16:05:13.485 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.485 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713485_114_80.dat. (Simulated secure write)
16:05:13.485 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.485 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713485_115_80.dat. (Simulated secure write)
16:05:13.486 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.486 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713486_116_80.dat. (Simulated secure write)
16:05:13.486 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.486 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713486_117_80.dat. (Simulated secure write)
16:05:13.486 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.486 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713486_118_80.dat. (Simulated secure write)
16:05:13.486 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.486 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713486_119_80.dat. (Simulated secure write)
16:05:13.486 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.486 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713486_120_80.dat. (Simulated secure write)
16:05:13.486 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.486 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713486_121_80.dat. (Simulated secure write)
16:05:13.486 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.486 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713486_122_80.dat. (Simulated secure write)
16:05:13.486 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.487 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.487 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713487_123_80.dat. (Simulated secure write)
16:05:13.487 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.487 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713487_124_80.dat. (Simulated secure write)
16:05:13.487 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.487 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713487_125_80.dat. (Simulated secure write)
16:05:13.487 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.487 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713487_126_80.dat. (Simulated secure write)
16:05:13.487 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.487 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713487_127_80.dat. (Simulated secure write)
16:05:13.487 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.487 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713487_128_80.dat. (Simulated secure write)
16:05:13.487 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.487 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713487_129_80.dat. (Simulated secure write)
16:05:13.487 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.487 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713487_130_80.dat. (Simulated secure write)
16:05:13.487 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.487 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713487_131_80.dat. (Simulated secure write)
16:05:13.487 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.487 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713487_132_80.dat. (Simulated secure write)
16:05:13.487 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.487 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713487_133_80.dat. (Simulated secure write)
16:05:13.488 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713488_134_80.dat. (Simulated secure write)
16:05:13.488 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.488 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713488_135_80.dat. (Simulated secure write)
16:05:13.488 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.488 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713488_136_80.dat. (Simulated secure write)
16:05:13.488 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.488 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713488_137_80.dat. (Simulated secure write)
16:05:13.488 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.488 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713488_138_80.dat. (Simulated secure write)
16:05:13.488 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.488 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713488_139_80.dat. (Simulated secure write)
16:05:13.488 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.488 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713488_140_80.dat. (Simulated secure write)
16:05:13.488 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.488 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713488_141_80.dat. (Simulated secure write)
16:05:13.488 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.488 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713488_142_80.dat. (Simulated secure write)
16:05:13.488 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.488 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713488_143_80.dat. (Simulated secure write)
16:05:13.488 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.488 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713488_144_80.dat. (Simulated secure write)
16:05:13.488 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.488 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713488_145_80.dat. (Simulated secure write)
16:05:13.489 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.489 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713489_146_80.dat. (Simulated secure write)
16:05:13.489 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.489 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.489 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.489 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.489 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.489 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.489 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.489 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.489 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.489 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.489 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.490 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.490 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713490_147_80.dat. (Simulated secure write)
16:05:13.490 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.490 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713490_148_80.dat. (Simulated secure write)
16:05:13.490 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713490_149_80.dat. (Simulated secure write)
16:05:13.490 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713490_150_80.dat. (Simulated secure write)
16:05:13.490 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713490_155_80.dat. (Simulated secure write)
16:05:13.490 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713490_152_80.dat. (Simulated secure write)
16:05:13.490 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713490_153_80.dat. (Simulated secure write)
16:05:13.490 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713490_151_80.dat. (Simulated secure write)
16:05:13.490 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713490_154_80.dat. (Simulated secure write)
16:05:13.490 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713490_156_80.dat. (Simulated secure write)
16:05:13.490 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.490 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.490 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713490_158_80.dat. (Simulated secure write)
16:05:13.490 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713490_157_80.dat. (Simulated secure write)
16:05:13.490 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.490 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713490_159_80.dat. (Simulated secure write)
16:05:13.490 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.490 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713490_160_80.dat. (Simulated secure write)
16:05:13.490 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.490 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713490_161_80.dat. (Simulated secure write)
16:05:13.490 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:05:13.490 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713490_162_80.dat. (Simulated secure write)
16:05:13.490 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713490_163_80.dat. (Simulated secure write)
16:05:13.491 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713491_165_80.dat. (Simulated secure write)
16:05:13.491 [debug] S2: Successfully wrote 7 bytes to ./data_1766120713491_164_80.dat. (Simulated secure write)
.
Finished in 3.7 seconds (0.1s async, 3.6s sync)
1 doctest, 65 tests, 0 failures
