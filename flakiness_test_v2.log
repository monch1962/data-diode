Run 1
warning: setting :preferred_cli_env in your mix.exs "def project" is deprecated, set it inside "def cli" instead:

    def cli do
      [preferred_envs: [release: :prod, test: :test]]
    end

  (mix 1.19.4) lib/mix/cli.ex:187: Mix.CLI.preferred_cli_env/3
  (mix 1.19.4) lib/mix/cli.ex:170: Mix.CLI.maybe_change_env_and_target/2
  (mix 1.19.4) lib/mix/cli.ex:59: Mix.CLI.proceed/2
  /opt/homebrew/bin/mix:7: (file)
  (elixir 1.19.4) src/elixir_compiler.erl:81: :elixir_compiler.dispatch/4
  (elixir 1.19.4) src/elixir_compiler.erl:56: :elixir_compiler.compile/4

Compiling 1 file (.ex)
Generated data_diode app
16:01:13.403 [info] Application logger started at :nonode@nohost
16:01:13.408 [info] Child :ttb_autostart of Supervisor :runtime_tools_sup started
Pid: #PID<0.197.0>
Start Call: :ttb_autostart.start_link()
Restart: :temporary
Shutdown: 3000
Type: :worker
16:01:13.408 [info] Application runtime_tools started at :nonode@nohost
16:01:13.408 [info] Application opentelemetry_api started at :nonode@nohost
16:01:13.408 [info] Application ctx started at :nonode@nohost
16:01:13.408 [info] Application hpack started at :nonode@nohost
16:01:13.408 [info] Application chatterbox started at :nonode@nohost
16:01:13.408 [info] Application acceptor_pool started at :nonode@nohost
16:01:13.413 [info] Child :gproc of Supervisor :gproc_sup started
Pid: #PID<0.201.0>
Start Call: :gproc.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:01:13.414 [info] Child :gproc_monitor of Supervisor :gproc_sup started
Pid: #PID<0.202.0>
Start Call: :gproc_monitor.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:01:13.415 [info] Child :gproc_bcast of Supervisor :gproc_sup started
Pid: #PID<0.203.0>
Start Call: :gproc_bcast.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:01:13.416 [info] Child :gproc_pool of Supervisor :gproc_sup started
Pid: #PID<0.204.0>
Start Call: :gproc_pool.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:01:13.416 [info] Application gproc started at :nonode@nohost
16:01:13.418 [info] Child :grpcbox_services_simple_sup of Supervisor :grpcbox_sup started
Pid: #PID<0.208.0>
Start Call: :grpcbox_services_simple_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:01:13.418 [info] Child :grpcbox_channel_sup of Supervisor :grpcbox_sup started
Pid: #PID<0.209.0>
Start Call: :grpcbox_channel_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:01:13.418 [info] Application grpcbox started at :nonode@nohost
16:01:13.418 [info] Application ssl_verify_fun started at :nonode@nohost
16:01:13.497 [info] Loading 162 CA(s) from :otp store
16:01:13.497 [info] Child :tls_certificate_check_shared_state of Supervisor :tls_certificate_check_sup started
Pid: #PID<0.213.0>
Start Call: :tls_certificate_check_shared_state.start_link()
Restart: :permanent
Shutdown: :infinity
Type: :worker
16:01:13.498 [info] Application tls_certificate_check started at :nonode@nohost
16:01:13.498 [info] Application opentelemetry_exporter started at :nonode@nohost
16:01:13.523 [info] Child :otel_span_ets of Supervisor :otel_span_sup started
Pid: #PID<0.221.0>
Start Call: :otel_span_ets.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:13.524 [info] Child :otel_span_sweeper of Supervisor :otel_span_sup started
Pid: #PID<0.222.0>
Start Call: :otel_span_sweeper.start_link(%{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:13.525 [info] Child :otel_span_sup of Supervisor :opentelemetry_sup started
Pid: #PID<0.220.0>
Start Call: :otel_span_sup.start_link(%{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:01:13.530 [info] Child :otel_resource_detector of Supervisor :opentelemetry_sup started
Pid: #PID<0.223.0>
Start Call: :otel_resource_detector.start_link(%{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:13.534 [info] Child :otel_tracer_provider_sup of Supervisor :opentelemetry_sup started
Pid: #PID<0.226.0>
Start Call: :otel_tracer_provider_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:01:13.537 [info] Child :otel_span_processor_sup of Supervisor #PID<0.227.0> (:otel_tracer_server_sup) started
Pid: #PID<0.228.0>
Start Call: :otel_span_processor_sup.start_link(:otel_span_processor_sup_global)
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:01:13.545 [info] Child :otel_tracer_server of Supervisor #PID<0.227.0> (:otel_tracer_server_sup) started
Pid: #PID<0.229.0>
Start Call: :otel_tracer_server.start_link(:global, :otel_tracer_provider_global, :otel_span_processor_sup_global, {:resource, :undefined, {:attributes, 128, 255, 0, %{"process.executable.name": "erl", "process.runtime.description": "Erlang/OTP 28 erts-16.1.2", "process.runtime.version": "16.1.2", "process.runtime.name": "BEAM", "service.name": "unknown_service:erl", "service.instance.id": 321133895440813592448703483599509202015, "telemetry.sdk.version": "1.6.0", "telemetry.sdk.language": "erlang", "telemetry.sdk.name": "opentelemetry"}}}, %{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:13.549 [debug] Child {:httpc, :"otel_exporter_otlp_<0.230.0>"} of Supervisor :httpc_profile_sup started
Pid: #PID<0.231.0>
Start Call: :httpc_manager.start_link(:"otel_exporter_otlp_<0.230.0>", :only_session_cookies, :inets)
Restart: :permanent
Shutdown: 4000
Type: :worker
16:01:13.554 [info] OTLP exporter successfully initialized
16:01:13.555 [info] Application opentelemetry started at :nonode@nohost
16:01:13.556 [info] Application jason started at :nonode@nohost
16:01:13.556 [info] Application logger_json started at :nonode@nohost
16:01:13.556 [info] Application nimble_ownership started at :nonode@nohost
16:01:13.560 [info] Child Mox of Supervisor Mox.Supervisor started
Pid: #PID<0.235.0>
Start Call: Mox.start_link_ownership()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:13.560 [info] Application mox started at :nonode@nohost
16:01:13.566 [info] Child DataDiode.Metrics of Supervisor DataDiode.Supervisor started
Pid: #PID<0.239.0>
Start Call: DataDiode.Metrics.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:13.566 [info] Child DataDiode.SystemMonitor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.240.0>
Start Call: DataDiode.SystemMonitor.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:13.567 [info] S1: Starting TCP Listener on port 0...
16:01:13.567 [info] Child DataDiode.S1.Listener of Supervisor DataDiode.Supervisor started
Pid: #PID<0.241.0>
Start Call: DataDiode.S1.Listener.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:13.569 [info] Child DataDiode.S1.HandlerSupervisor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.242.0>
Start Call: DataDiode.S1.HandlerSupervisor.start_link()
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:01:13.571 [warning] S1 Encapsulator: Invalid S2_PORT 0, using default 42001
16:01:13.571 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.243.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:13.571 [info] Child DataDiode.S1.Heartbeat of Supervisor DataDiode.Supervisor started
Pid: #PID<0.244.0>
Start Call: DataDiode.S1.Heartbeat.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:13.571 [info] Child DataDiode.S2.HeartbeatMonitor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.245.0>
Start Call: DataDiode.S2.HeartbeatMonitor.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:13.571 [info] Child DataDiode.DiskCleaner of Supervisor DataDiode.Supervisor started
Pid: #PID<0.246.0>
Start Call: DataDiode.DiskCleaner.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:13.572 [info] S2: Starting UDP Listener on port 0...
16:01:13.572 [info] Child DataDiode.S2.Listener of Supervisor DataDiode.Supervisor started
Pid: #PID<0.247.0>
Start Call: DataDiode.S2.Listener.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:13.572 [info] Child DataDiode.S2.TaskSupervisor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.248.0>
Start Call: Task.Supervisor.start_link([name: DataDiode.S2.TaskSupervisor, max_children: 200])
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:01:13.572 [info] Application data_diode started at :nonode@nohost
16:01:13.577 [info] Child ExUnit.Server of Supervisor ExUnit.Supervisor started
Pid: #PID<0.254.0>
Start Call: ExUnit.Server.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:13.577 [info] Child ExUnit.CaptureServer of Supervisor ExUnit.Supervisor started
Pid: #PID<0.255.0>
Start Call: ExUnit.CaptureServer.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:13.577 [info] Application ex_unit started at :nonode@nohost
    warning: variable "c" is unused (if the variable is not meant to be used, prefix it with an underscore)
    │
 26 │     {:ok, c} = :gen_tcp.connect({127,0,0,1}, port, [:binary, active: false])
    │           ~
    │
    └─ test/long_term_robustness_test.exs:26:11: DataDiode.LongTermRobustnessTest."test TCPHandler exhaustive branch coverage"/1

    warning: variable "pid3" is unused (if the variable is not meant to be used, prefix it with an underscore)
    │
 62 │     {:ok, pid3} = TCPHandler.start_link(s3)
    │           ~~~~
    │
    └─ test/long_term_robustness_test.exs:62:11: DataDiode.LongTermRobustnessTest."test TCPHandler exhaustive branch coverage"/1

Running ExUnit with seed: 579544, max_cases: 16

.....     warning: redefining module DataDiode.S1.EncapsulatorMock (current version defined in memory)
     │
 491 │     Module.create(name, [info | body], Macro.Env.location(__ENV__))
     │     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     │
     └─ deps/mox/lib/mox.ex:491: DataDiode.S1.EncapsulatorMock (module)

..16:01:13.677 [info] DiskCleaner: Low disk space detected on . (< 15%). Starting autonomous cleanup...
.16:01:13.677 [warning] DiskCleaner: Simulation - would delete oldest .dat files in . now.
....16:01:13.693 [error] S2: Failed to parse header: invalid_packet_size
.16:01:13.693 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 9 bytes.
.16:01:13.693 [debug] S2: Successfully wrote 9 bytes to ./data_1766120473693_1_80.dat. (Simulated secure write)
.16:01:13.693 [info] S2: Decapsulated packet from 0.0.0.0:0. Payload size: 0 bytes.
.16:01:13.693 [debug] S2: Successfully wrote 0 bytes to ./data_1766120473693_2_0.dat. (Simulated secure write)
.16:01:13.693 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 23 bytes.
16:01:13.693 [debug] S2: Successfully wrote 23 bytes to ./data_1766120473693_3_51210.dat. (Simulated secure write)
.16:01:13.693 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 0 bytes.
.16:01:13.693 [debug] S2: Successfully wrote 0 bytes to ./data_1766120473693_4_51210.dat. (Simulated secure write)
.16:01:13.694 [error] S2: Failed to parse header: invalid_packet_size
16:01:13.694 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 23 bytes.
16:01:13.694 [debug] S2: Successfully wrote 23 bytes to ./data_1766120473694_5_51210.dat. (Simulated secure write)
16:01:13.694 [error] S2: Failed to parse header: invalid_packet_size
16:01:13.718 [info] Child of Supervisor :inet_gethost_native_sup started
Pid: #PID<0.395.0>
Start Call: :inet_gethost_native.init([])
16:01:13.718 [debug] Child :inet_gethost_native_sup of Supervisor :kernel_safe_sup started
Pid: #PID<0.394.0>
Start Call: :inet_gethost_native.start_link()
Restart: :temporary
Shutdown: 1000
Type: :worker
16:01:13.726 [warning] S1: Dropping oversized packet (1048577 bytes) from 1.2.3.4
.16:01:13.726 [debug] S1: TCPHandler received unexpected message: :accept_loop
.16:01:13.727 [debug] S1: TCPHandler received unexpected message: :unknown
.16:01:13.728 [info] S1: Connection closed by 1.2.3.4:80
..16:01:13.728 [info] S1: Forwarded 11 bytes.
.16:01:13.739 [error] S1: TCP error for 1.2.3.4: :econnreset
.........16:01:14.069 [info] S1: New connection accepted.
16:01:14.069 [info] S1: New connection accepted.
16:01:14.073 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.56>}
16:01:14.073 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.58>}
16:01:14.073 [info] S1: New connection accepted.
16:01:14.073 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.62>}
16:01:14.073 [info] S1: New connection accepted.
16:01:14.073 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.63>}
16:01:14.073 [info] S1: New connection accepted.
16:01:14.073 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.64>}
..16:01:14.374 [debug] S1: TCPHandler received unexpected message: :accept_loop
..16:01:14.387 [debug] SystemMonitor: Received unexpected message: :unexp
16:01:14.391 [debug] S1: TCPHandler received unexpected message: :unexp
16:01:14.391 [info] S1: Starting TCP Listener on port 0...
16:01:14.391 [debug] S1: Listener received unexpected message: :unexp
16:01:15.075 [info] S2: Starting UDP Listener on port 0...
16:01:15.075 [warning] S2: Received unexpected message: :unexp
16:01:15.075 [error] S2: UDP Listener socket closed unexpectedly. Terminating.
16:01:15.081 [info] DiskCleaner: Low disk space detected on . (< 15%). Starting autonomous cleanup...
16:01:15.081 [warning] DiskCleaner: Simulation - would delete oldest .dat files in . now.
16:01:15.086 [info] S2: Decapsulated packet from 127.0.0.1:20480. Payload size: 7 bytes.
16:01:15.086 [debug] S2: Successfully wrote 7 bytes to /tmp/diode_test/data_1766120475086_12_20480.dat. (Simulated secure write)
16:01:15.086 [info] S2: Decapsulated packet from 127.0.0.1:0. Payload size: 9 bytes.
16:01:15.087 [debug] S1: Generating end-to-end heartbeat.
16:01:15.087 [warning] S1 Heartbeat: Received unexpected message: :unexp
16:01:15.087 [error] S2: Critical Failure! Channel heartbeat missing for > 6 minutes. The diode path may be obstructed.
16:01:15.087 [warning] S2 HeartbeatMonitor: Received unexpected message: :unexp
..16:01:15.089 [info] S2: Starting UDP Listener on port 0...
...16:01:15.089 [info] S2: Starting UDP Listener on port 0...
16:01:15.089 [info] S2: Decapsulated packet from 127.0.0.1:1234. Payload size: 12 bytes.
16:01:15.089 [debug] S2: Successfully wrote 12 bytes to ./data_1766120475089_13_1234.dat. (Simulated secure write)
16:01:15.114 [info] S2: Starting UDP Listener on port 0...
16:01:15.114 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.114 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475114_14_80.dat. (Simulated secure write)
16:01:15.114 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.114 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475114_15_80.dat. (Simulated secure write)
16:01:15.114 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.114 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475114_16_80.dat. (Simulated secure write)
16:01:15.115 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.115 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475115_17_80.dat. (Simulated secure write)
16:01:15.115 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.115 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475115_18_80.dat. (Simulated secure write)
16:01:15.115 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.115 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475115_19_80.dat. (Simulated secure write)
16:01:15.115 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.115 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475115_20_80.dat. (Simulated secure write)
16:01:15.115 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.115 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475115_21_80.dat. (Simulated secure write)
16:01:15.115 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.115 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475115_22_80.dat. (Simulated secure write)
16:01:15.115 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.115 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475115_23_80.dat. (Simulated secure write)
16:01:15.116 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.116 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475116_24_80.dat. (Simulated secure write)
16:01:15.116 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.116 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475116_25_80.dat. (Simulated secure write)
16:01:15.116 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.116 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475116_26_80.dat. (Simulated secure write)
16:01:15.116 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.116 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475116_27_80.dat. (Simulated secure write)
16:01:15.116 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.116 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475116_28_80.dat. (Simulated secure write)
16:01:15.116 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.116 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475116_29_80.dat. (Simulated secure write)
16:01:15.117 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.117 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.117 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475117_30_80.dat. (Simulated secure write)
16:01:15.117 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475117_31_80.dat. (Simulated secure write)
16:01:15.117 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.117 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475117_32_80.dat. (Simulated secure write)
16:01:15.117 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.117 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475117_33_80.dat. (Simulated secure write)
16:01:15.117 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.117 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475117_34_80.dat. (Simulated secure write)
16:01:15.117 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.117 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475117_35_80.dat. (Simulated secure write)
16:01:15.117 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.117 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475117_36_80.dat. (Simulated secure write)
16:01:15.117 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.117 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475117_37_80.dat. (Simulated secure write)
16:01:15.117 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.117 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475117_38_80.dat. (Simulated secure write)
16:01:15.118 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.118 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475118_39_80.dat. (Simulated secure write)
16:01:15.118 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.118 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475118_40_80.dat. (Simulated secure write)
16:01:15.118 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.118 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.118 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475118_41_80.dat. (Simulated secure write)
16:01:15.118 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475118_42_80.dat. (Simulated secure write)
16:01:15.118 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.118 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475118_43_80.dat. (Simulated secure write)
16:01:15.118 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.118 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475118_44_80.dat. (Simulated secure write)
16:01:15.118 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.118 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475118_45_80.dat. (Simulated secure write)
16:01:15.119 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.119 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475119_46_80.dat. (Simulated secure write)
16:01:15.119 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.119 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475119_47_80.dat. (Simulated secure write)
16:01:15.119 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.119 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475119_48_80.dat. (Simulated secure write)
16:01:15.119 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.119 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475119_49_80.dat. (Simulated secure write)
16:01:15.119 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.119 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475119_50_80.dat. (Simulated secure write)
16:01:15.119 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.119 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475119_51_80.dat. (Simulated secure write)
16:01:15.120 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.120 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475120_52_80.dat. (Simulated secure write)
16:01:15.120 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.120 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475120_53_80.dat. (Simulated secure write)


16:01:15.120 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
  1) test UDP listener receives packet and delegates to Decapsulator (DataDiode.S2.ListenerTest)
     test/s2_listener_test.exs:116
     ** (Mox.VerificationError) error while verifying mocks for #PID<0.590.0>:

       * expected DataDiode.S2.DecapsulatorMock.process_packet/1 to be invoked once but it was invoked 0 times
     code: verify!()
     stacktrace:
       (mox 1.2.0) lib/mox.ex:862: Mox.__verify_mock_or_all__/2
       test/s2_listener_test.exs:140: (test)

16:01:15.120 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475120_54_80.dat. (Simulated secure write)
16:01:15.120 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.120 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.120 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475120_56_80.dat. (Simulated secure write)
16:01:15.120 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475120_55_80.dat. (Simulated secure write)
16:01:15.120 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.120 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475120_57_80.dat. (Simulated secure write)
16:01:15.120 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.120 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475120_58_80.dat. (Simulated secure write)
16:01:15.120 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.120 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475120_59_80.dat. (Simulated secure write)
16:01:15.120 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.120 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475120_60_80.dat. (Simulated secure write)
16:01:15.121 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.121 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475121_61_80.dat. (Simulated secure write)
16:01:15.121 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.121 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475121_62_80.dat. (Simulated secure write)
16:01:15.121 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.121 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.121 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.121 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475121_63_80.dat. (Simulated secure write)
16:01:15.121 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.121 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475121_64_80.dat. (Simulated secure write)
16:01:15.121 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.121 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475121_65_80.dat. (Simulated secure write)
16:01:15.121 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.121 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475121_66_80.dat. (Simulated secure write)
16:01:15.121 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.121 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475121_67_80.dat. (Simulated secure write)
16:01:15.122 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.122 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475122_68_80.dat. (Simulated secure write)
16:01:15.122 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.122 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475122_69_80.dat. (Simulated secure write)
16:01:15.122 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.122 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475122_70_80.dat. (Simulated secure write)
16:01:15.122 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.122 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475122_71_80.dat. (Simulated secure write)
16:01:15.122 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.122 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475122_72_80.dat. (Simulated secure write)
16:01:15.122 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475122_73_80.dat. (Simulated secure write)
16:01:15.122 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475122_74_80.dat. (Simulated secure write)
16:01:15.122 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.122 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475122_75_80.dat. (Simulated secure write)
16:01:15.122 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.122 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475122_76_80.dat. (Simulated secure write)
16:01:15.122 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.122 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475122_77_80.dat. (Simulated secure write)
16:01:15.122 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.122 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475122_78_80.dat. (Simulated secure write)
16:01:15.122 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.122 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475122_79_80.dat. (Simulated secure write)
16:01:15.122 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.122 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475122_80_80.dat. (Simulated secure write)
16:01:15.122 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.123 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475123_81_80.dat. (Simulated secure write)
16:01:15.123 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.123 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475123_82_80.dat. (Simulated secure write)
16:01:15.123 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.123 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475123_83_80.dat. (Simulated secure write)
16:01:15.123 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.123 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475123_84_80.dat. (Simulated secure write)
16:01:15.123 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.123 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475123_85_80.dat. (Simulated secure write)
16:01:15.123 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.123 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475123_86_80.dat. (Simulated secure write)
16:01:15.123 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.123 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.123 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475123_87_80.dat. (Simulated secure write)
16:01:15.123 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.123 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475123_88_80.dat. (Simulated secure write)
16:01:15.123 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.123 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475123_89_80.dat. (Simulated secure write)
16:01:15.123 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.123 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475123_90_80.dat. (Simulated secure write)
16:01:15.123 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.123 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475123_91_80.dat. (Simulated secure write)
16:01:15.123 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.123 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475123_92_80.dat. (Simulated secure write)
16:01:15.124 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.124 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475124_93_80.dat. (Simulated secure write)
16:01:15.124 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.124 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475124_94_80.dat. (Simulated secure write)
16:01:15.124 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.124 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475124_95_80.dat. (Simulated secure write)
16:01:15.124 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.124 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475124_96_80.dat. (Simulated secure write)
16:01:15.124 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.124 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475124_97_80.dat. (Simulated secure write)
16:01:15.124 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.124 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475124_98_80.dat. (Simulated secure write)
16:01:15.124 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.124 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475124_99_80.dat. (Simulated secure write)
16:01:15.124 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.124 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475124_100_80.dat. (Simulated secure write)
16:01:15.124 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.124 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.124 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475124_101_80.dat. (Simulated secure write)
16:01:15.124 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475124_102_80.dat. (Simulated secure write)
16:01:15.124 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.124 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475124_103_80.dat. (Simulated secure write)
16:01:15.125 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.125 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.125 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.125 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.125 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.125 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.125 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.125 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.125 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:15.125 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475125_105_80.dat. (Simulated secure write)
16:01:15.125 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475125_104_80.dat. (Simulated secure write)
16:01:15.125 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475125_106_80.dat. (Simulated secure write)
16:01:15.126 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475126_107_80.dat. (Simulated secure write)
16:01:15.126 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475126_109_80.dat. (Simulated secure write)
16:01:15.126 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475126_111_80.dat. (Simulated secure write)
16:01:15.126 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475126_113_80.dat. (Simulated secure write)
16:01:15.126 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475126_108_80.dat. (Simulated secure write)
16:01:15.126 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475126_110_80.dat. (Simulated secure write)
16:01:15.126 [debug] S2: Successfully wrote 7 bytes to ./data_1766120475126_112_80.dat. (Simulated secure write)
.16:01:15.226 [warning] S2: Invalid LISTEN_IP_S2 invalid, falling back to all interfaces.
.16:01:15.226 [error] S2: UDP Listener socket closed unexpectedly. Terminating.
.16:01:15.226 [info] S2: Starting UDP Listener on port 0...
16:01:15.227 [info] S2: Decapsulated packet from 1.2.3.4:80. Payload size: 5 bytes.
16:01:15.227 [debug] S2: Successfully wrote 5 bytes to ./data_1766120475227_114_80.dat. (Simulated secure write)
...16:01:15.289 [info] S1: Starting TCP Listener on port 8092...
16:01:15.290 [info] S1: New connection accepted.
16:01:15.290 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.94>}
16:01:15.290 [info] S1: New connection accepted.
16:01:15.290 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.96>}
16:01:15.290 [info] S1: New connection accepted.
16:01:15.290 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.98>}
16:01:15.290 [info] S1: New connection accepted.
16:01:15.290 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.100>}
16:01:15.291 [info] S1: New connection accepted.
16:01:15.291 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.102>}
16:01:15.291 [info] S1: New connection accepted.
16:01:15.291 [info] S1: New connection accepted.
16:01:15.291 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.104>}
16:01:15.291 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.106>}
16:01:15.291 [info] S1: New connection accepted.
16:01:15.291 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.108>}
16:01:15.292 [info] S1: New connection accepted.
16:01:15.292 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.110>}
16:01:15.292 [info] S1: New connection accepted.
16:01:15.292 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.112>}
16:01:15.292 [info] S1: New connection accepted.
16:01:15.292 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.114>}
16:01:15.292 [info] S1: New connection accepted.
16:01:15.292 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.116>}
16:01:15.292 [info] S1: New connection accepted.
16:01:15.293 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.118>}
16:01:15.293 [info] S1: New connection accepted.
16:01:15.293 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.120>}
16:01:15.293 [info] S1: New connection accepted.
16:01:15.293 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.122>}
16:01:15.293 [info] S1: New connection accepted.
16:01:15.293 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.124>}
16:01:15.293 [info] S1: New connection accepted.
16:01:15.294 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.126>}
16:01:15.294 [info] S1: New connection accepted.
16:01:15.294 [info] S1: New connection accepted.
16:01:15.294 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.128>}
16:01:15.294 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.130>}
16:01:15.294 [info] S1: New connection accepted.
16:01:15.294 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.132>}
16:01:15.294 [info] S1: New connection accepted.
16:01:15.294 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.134>}
16:01:15.295 [info] S1: New connection accepted.
16:01:15.295 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.136>}
16:01:15.295 [info] S1: New connection accepted.
16:01:15.295 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.138>}
16:01:15.295 [info] S1: New connection accepted.
16:01:15.295 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.140>}
16:01:15.295 [info] S1: New connection accepted.
16:01:15.295 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.142>}
16:01:15.296 [info] S1: New connection accepted.
16:01:15.296 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.144>}
16:01:15.296 [info] S1: New connection accepted.
16:01:15.296 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.146>}
16:01:15.296 [info] S1: New connection accepted.
16:01:15.296 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.148>}
16:01:15.296 [info] S1: New connection accepted.
16:01:15.296 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.150>}
16:01:15.297 [info] S1: New connection accepted.
16:01:15.297 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.152>}
16:01:15.297 [info] S1: New connection accepted.
16:01:15.297 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.154>}
16:01:15.297 [info] S1: New connection accepted.
16:01:15.297 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.156>}
16:01:15.297 [info] S1: New connection accepted.
16:01:15.297 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.158>}
16:01:15.297 [info] S1: New connection accepted.
16:01:15.297 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.160>}
16:01:15.298 [info] S1: New connection accepted.
16:01:15.298 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.162>}
16:01:15.298 [info] S1: New connection accepted.
16:01:15.298 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.164>}
16:01:15.298 [info] S1: New connection accepted.
16:01:15.298 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.166>}
16:01:15.298 [info] S1: New connection accepted.
16:01:15.298 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.168>}
16:01:15.298 [info] S1: New connection accepted.
16:01:15.298 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.170>}
16:01:15.299 [info] S1: New connection accepted.
16:01:15.299 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.172>}
16:01:15.299 [info] S1: New connection accepted.
16:01:15.299 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.174>}
16:01:15.299 [info] S1: New connection accepted.
16:01:15.299 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.176>}
16:01:15.299 [info] S1: New connection accepted.
16:01:15.299 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.178>}
16:01:15.299 [info] S1: New connection accepted.
16:01:15.299 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.180>}
16:01:15.300 [info] S1: New connection accepted.
16:01:15.300 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.182>}
16:01:15.300 [info] S1: New connection accepted.
16:01:15.300 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.184>}
16:01:15.300 [info] S1: New connection accepted.
16:01:15.300 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.186>}
16:01:15.300 [info] S1: New connection accepted.
16:01:15.300 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.188>}
16:01:15.300 [info] S1: New connection accepted.
16:01:15.300 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.190>}
16:01:15.301 [info] S1: New connection accepted.
16:01:15.301 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.192>}
.16:01:15.802 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.243.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:15.803 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.763.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:01:15.813 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.763.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:15.813 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.765.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:01:15.824 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.765.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:15.824 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.767.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:01:15.835 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.767.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:15.835 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.769.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:15.846 [warning] S1 Encapsulator: Invalid IP invalid, dropping packet.
.16:01:15.948 [error] S1: Listener socket fatal error: :closed. Terminating.
.16:01:15.948 [info] S1: Starting TCP Listener on port 0...
16:01:16.449 [error] S1: Listener socket fatal error: :closed. Terminating.
16:01:16.449 [error] GenServer :s1_flapping_test_unique terminating
** (stop) :closed
Last message: :accept_loop
State: #Port<0.202>
16:01:16.449 [error] Process :s1_flapping_test_unique (#PID<0.774.0>) terminating
** (exit) :closed
    (stdlib 7.1) gen_server.erl:2562: :gen_server.handle_common_reply/5
    (stdlib 7.1) proc_lib.erl:333: :proc_lib.init_p_do_apply/3
Initial Call: DataDiode.S1.Listener.init/1
Ancestors: [#PID<0.773.0>]
Message Queue Length: 0
Messages: []
Links: []
Dictionary: []
Trapping Exits: false
Status: :running
Heap Size: 1598
Stack Size: 29
Reductions: 2754
.16:01:16.450 [info] S1: Starting TCP Listener on port 0...
16:01:16.951 [info] S1: New connection accepted.
.....16:01:16.952 [info] S1: Starting TCP Listener on port 0...
.16:01:16.952 [warning] S1: Invalid LISTEN_IP invalid, using all interfaces.
..
Finished in 3.8 seconds (0.1s async, 3.6s sync)
1 doctest, 65 tests, 1 failure
Run 1 FAILED
Run 2
warning: setting :preferred_cli_env in your mix.exs "def project" is deprecated, set it inside "def cli" instead:

    def cli do
      [preferred_envs: [release: :prod, test: :test]]
    end

  (mix 1.19.4) lib/mix/cli.ex:187: Mix.CLI.preferred_cli_env/3
  (mix 1.19.4) lib/mix/cli.ex:170: Mix.CLI.maybe_change_env_and_target/2
  (mix 1.19.4) lib/mix/cli.ex:59: Mix.CLI.proceed/2
  /opt/homebrew/bin/mix:7: (file)
  (elixir 1.19.4) src/elixir_compiler.erl:81: :elixir_compiler.dispatch/4
  (elixir 1.19.4) src/elixir_compiler.erl:56: :elixir_compiler.compile/4

16:01:17.940 [info] Application logger started at :nonode@nohost
16:01:17.944 [info] Child :ttb_autostart of Supervisor :runtime_tools_sup started
Pid: #PID<0.183.0>
Start Call: :ttb_autostart.start_link()
Restart: :temporary
Shutdown: 3000
Type: :worker
16:01:17.944 [info] Application runtime_tools started at :nonode@nohost
16:01:17.944 [info] Application opentelemetry_api started at :nonode@nohost
16:01:17.944 [info] Application ctx started at :nonode@nohost
16:01:17.944 [info] Application hpack started at :nonode@nohost
16:01:17.944 [info] Application chatterbox started at :nonode@nohost
16:01:17.944 [info] Application acceptor_pool started at :nonode@nohost
16:01:17.949 [info] Child :gproc of Supervisor :gproc_sup started
Pid: #PID<0.187.0>
Start Call: :gproc.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:01:17.950 [info] Child :gproc_monitor of Supervisor :gproc_sup started
Pid: #PID<0.188.0>
Start Call: :gproc_monitor.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:01:17.950 [info] Child :gproc_bcast of Supervisor :gproc_sup started
Pid: #PID<0.189.0>
Start Call: :gproc_bcast.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:01:17.952 [info] Child :gproc_pool of Supervisor :gproc_sup started
Pid: #PID<0.190.0>
Start Call: :gproc_pool.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:01:17.952 [info] Application gproc started at :nonode@nohost
16:01:17.953 [info] Child :grpcbox_services_simple_sup of Supervisor :grpcbox_sup started
Pid: #PID<0.194.0>
Start Call: :grpcbox_services_simple_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:01:17.954 [info] Child :grpcbox_channel_sup of Supervisor :grpcbox_sup started
Pid: #PID<0.195.0>
Start Call: :grpcbox_channel_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:01:17.954 [info] Application grpcbox started at :nonode@nohost
16:01:17.954 [info] Application ssl_verify_fun started at :nonode@nohost
16:01:18.011 [info] Loading 162 CA(s) from :otp store
16:01:18.011 [info] Child :tls_certificate_check_shared_state of Supervisor :tls_certificate_check_sup started
Pid: #PID<0.199.0>
Start Call: :tls_certificate_check_shared_state.start_link()
Restart: :permanent
Shutdown: :infinity
Type: :worker
16:01:18.011 [info] Application tls_certificate_check started at :nonode@nohost
16:01:18.011 [info] Application opentelemetry_exporter started at :nonode@nohost
16:01:18.016 [info] Child :otel_span_ets of Supervisor :otel_span_sup started
Pid: #PID<0.207.0>
Start Call: :otel_span_ets.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:18.017 [info] Child :otel_span_sweeper of Supervisor :otel_span_sup started
Pid: #PID<0.208.0>
Start Call: :otel_span_sweeper.start_link(%{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:18.017 [info] Child :otel_span_sup of Supervisor :opentelemetry_sup started
Pid: #PID<0.206.0>
Start Call: :otel_span_sup.start_link(%{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:01:18.019 [info] Child :otel_resource_detector of Supervisor :opentelemetry_sup started
Pid: #PID<0.209.0>
Start Call: :otel_resource_detector.start_link(%{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:18.020 [info] Child :otel_tracer_provider_sup of Supervisor :opentelemetry_sup started
Pid: #PID<0.212.0>
Start Call: :otel_tracer_provider_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:01:18.022 [info] Child :otel_span_processor_sup of Supervisor #PID<0.213.0> (:otel_tracer_server_sup) started
Pid: #PID<0.214.0>
Start Call: :otel_span_processor_sup.start_link(:otel_span_processor_sup_global)
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:01:18.027 [info] Child :otel_tracer_server of Supervisor #PID<0.213.0> (:otel_tracer_server_sup) started
Pid: #PID<0.215.0>
Start Call: :otel_tracer_server.start_link(:global, :otel_tracer_provider_global, :otel_span_processor_sup_global, {:resource, :undefined, {:attributes, 128, 255, 0, %{"process.executable.name": "erl", "process.runtime.description": "Erlang/OTP 28 erts-16.1.2", "process.runtime.version": "16.1.2", "process.runtime.name": "BEAM", "service.name": "unknown_service:erl", "service.instance.id": 89267893792707964077329069363384198937, "telemetry.sdk.version": "1.6.0", "telemetry.sdk.language": "erlang", "telemetry.sdk.name": "opentelemetry"}}}, %{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:18.030 [debug] Child {:httpc, :"otel_exporter_otlp_<0.216.0>"} of Supervisor :httpc_profile_sup started
Pid: #PID<0.217.0>
Start Call: :httpc_manager.start_link(:"otel_exporter_otlp_<0.216.0>", :only_session_cookies, :inets)
Restart: :permanent
Shutdown: 4000
Type: :worker
16:01:18.033 [info] OTLP exporter successfully initialized
16:01:18.033 [info] Application opentelemetry started at :nonode@nohost
16:01:18.034 [info] Application jason started at :nonode@nohost
16:01:18.034 [info] Application logger_json started at :nonode@nohost
16:01:18.034 [info] Application nimble_ownership started at :nonode@nohost
16:01:18.037 [info] Child Mox of Supervisor Mox.Supervisor started
Pid: #PID<0.221.0>
Start Call: Mox.start_link_ownership()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:18.037 [info] Application mox started at :nonode@nohost
16:01:18.041 [info] Child DataDiode.Metrics of Supervisor DataDiode.Supervisor started
Pid: #PID<0.225.0>
Start Call: DataDiode.Metrics.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:18.041 [info] Child DataDiode.SystemMonitor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.226.0>
Start Call: DataDiode.SystemMonitor.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:18.042 [info] S1: Starting TCP Listener on port 0...
16:01:18.042 [info] Child DataDiode.S1.Listener of Supervisor DataDiode.Supervisor started
Pid: #PID<0.227.0>
Start Call: DataDiode.S1.Listener.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:18.043 [info] Child DataDiode.S1.HandlerSupervisor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.228.0>
Start Call: DataDiode.S1.HandlerSupervisor.start_link()
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:01:18.045 [warning] S1 Encapsulator: Invalid S2_PORT 0, using default 42001
16:01:18.045 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.229.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:18.045 [info] Child DataDiode.S1.Heartbeat of Supervisor DataDiode.Supervisor started
Pid: #PID<0.230.0>
Start Call: DataDiode.S1.Heartbeat.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:18.045 [info] Child DataDiode.S2.HeartbeatMonitor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.231.0>
Start Call: DataDiode.S2.HeartbeatMonitor.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:18.045 [info] Child DataDiode.DiskCleaner of Supervisor DataDiode.Supervisor started
Pid: #PID<0.232.0>
Start Call: DataDiode.DiskCleaner.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:18.045 [info] S2: Starting UDP Listener on port 0...
16:01:18.045 [info] Child DataDiode.S2.Listener of Supervisor DataDiode.Supervisor started
Pid: #PID<0.233.0>
Start Call: DataDiode.S2.Listener.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:18.045 [info] Child DataDiode.S2.TaskSupervisor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.234.0>
Start Call: Task.Supervisor.start_link([name: DataDiode.S2.TaskSupervisor, max_children: 200])
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:01:18.046 [info] Application data_diode started at :nonode@nohost
16:01:18.050 [info] Child ExUnit.Server of Supervisor ExUnit.Supervisor started
Pid: #PID<0.240.0>
Start Call: ExUnit.Server.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:18.050 [info] Child ExUnit.CaptureServer of Supervisor ExUnit.Supervisor started
Pid: #PID<0.241.0>
Start Call: ExUnit.CaptureServer.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:18.050 [info] Application ex_unit started at :nonode@nohost
Running ExUnit with seed: 51877, max_cases: 16

    warning: variable "c" is unused (if the variable is not meant to be used, prefix it with an underscore)
    │
 26 │     {:ok, c} = :gen_tcp.connect({127,0,0,1}, port, [:binary, active: false])
    │           ~
    │
    └─ test/long_term_robustness_test.exs:26:11: DataDiode.LongTermRobustnessTest."test TCPHandler exhaustive branch coverage"/1

    warning: variable "pid3" is unused (if the variable is not meant to be used, prefix it with an underscore)
    │
 62 │     {:ok, pid3} = TCPHandler.start_link(s3)
    │           ~~~~
    │
    └─ test/long_term_robustness_test.exs:62:11: DataDiode.LongTermRobustnessTest."test TCPHandler exhaustive branch coverage"/1

....     warning: redefining module DataDiode.S1.EncapsulatorMock (current version defined in memory)
     │
 491 │     Module.create(name, [info | body], Macro.Env.location(__ENV__))
     │     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     │
     └─ deps/mox/lib/mox.ex:491: DataDiode.S1.EncapsulatorMock (module)

........16:01:18.140 [error] S2: Failed to parse header: invalid_packet_size
.16:01:18.140 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 23 bytes.
.16:01:18.140 [debug] S2: Successfully wrote 23 bytes to ./data_1766120478140_1_51210.dat. (Simulated secure write)
.16:01:18.140 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 0 bytes.
.16:01:18.140 [debug] S2: Successfully wrote 0 bytes to ./data_1766120478140_2_51210.dat. (Simulated secure write)
.16:01:18.140 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 23 bytes.
16:01:18.140 [debug] S2: Successfully wrote 23 bytes to ./data_1766120478140_3_51210.dat. (Simulated secure write)
.16:01:18.141 [error] S2: Failed to parse header: invalid_packet_size
16:01:18.141 [info] S2: Decapsulated packet from 0.0.0.0:0. Payload size: 0 bytes.
16:01:18.141 [debug] S2: Successfully wrote 0 bytes to ./data_1766120478141_4_0.dat. (Simulated secure write)
16:01:18.141 [error] S2: Failed to parse header: invalid_packet_size
.16:01:18.141 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 9 bytes.
.16:01:18.141 [debug] S2: Successfully wrote 9 bytes to ./data_1766120478141_5_80.dat. (Simulated secure write)
16:01:18.162 [info] Child of Supervisor :inet_gethost_native_sup started
Pid: #PID<0.387.0>
Start Call: :inet_gethost_native.init([])
16:01:18.162 [debug] Child :inet_gethost_native_sup of Supervisor :kernel_safe_sup started
Pid: #PID<0.386.0>
Start Call: :inet_gethost_native.start_link()
Restart: :temporary
Shutdown: 1000
Type: :worker
.16:01:18.169 [info] S1: Connection closed by 1.2.3.4:80
..16:01:18.169 [error] S1: TCP error for 1.2.3.4: :econnreset
16:01:18.170 [info] S1: Forwarded 11 bytes.
.16:01:18.181 [debug] S1: TCPHandler received unexpected message: :unknown
.16:01:18.182 [warning] S1: Dropping oversized packet (1048577 bytes) from 1.2.3.4
.16:01:18.183 [debug] S1: TCPHandler received unexpected message: :accept_loop
....16:01:18.235 [info] S1: Starting TCP Listener on port 8092...
16:01:18.235 [info] S1: New connection accepted.
16:01:18.235 [info] S1: New connection accepted.
16:01:18.236 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.40>}
16:01:18.236 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.42>}
16:01:18.236 [info] S1: New connection accepted.
16:01:18.236 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.49>}
16:01:18.236 [info] S1: New connection accepted.
16:01:18.236 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.50>}
16:01:18.236 [info] S1: New connection accepted.
16:01:18.236 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.51>}
16:01:18.236 [info] S1: New connection accepted.
16:01:18.236 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.52>}
16:01:18.236 [info] S1: New connection accepted.
16:01:18.237 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.53>}
16:01:18.319 [info] S1: New connection accepted.
16:01:18.319 [info] S1: New connection accepted.
16:01:18.319 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.54>}
16:01:18.319 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.56>}
16:01:18.319 [info] S1: New connection accepted.
16:01:18.319 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.58>}
16:01:18.320 [info] S1: New connection accepted.
16:01:18.320 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.60>}
16:01:18.320 [info] S1: New connection accepted.
16:01:18.320 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.62>}
16:01:18.320 [info] S1: New connection accepted.
16:01:18.320 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.64>}
16:01:18.320 [info] S1: New connection accepted.
16:01:18.320 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.66>}
16:01:18.320 [info] S1: New connection accepted.
16:01:18.320 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.68>}
16:01:18.321 [info] S1: New connection accepted.
16:01:18.321 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.70>}
16:01:18.321 [info] S1: New connection accepted.
16:01:18.321 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.72>}
16:01:18.321 [info] S1: New connection accepted.
16:01:18.321 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.74>}
16:01:18.321 [info] S1: New connection accepted.
16:01:18.321 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.76>}
16:01:18.321 [info] S1: New connection accepted.
16:01:18.321 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.78>}
16:01:18.322 [info] S1: New connection accepted.
16:01:18.322 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.80>}
16:01:18.322 [info] S1: New connection accepted.
16:01:18.322 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.82>}
16:01:18.322 [info] S1: New connection accepted.
16:01:18.322 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.84>}
16:01:18.322 [info] S1: New connection accepted.
16:01:18.322 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.86>}
16:01:18.322 [info] S1: New connection accepted.
16:01:18.322 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.88>}
16:01:18.322 [info] S1: New connection accepted.
16:01:18.322 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.90>}
16:01:18.323 [info] S1: New connection accepted.
16:01:18.323 [info] S1: New connection accepted.
16:01:18.323 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.92>}
16:01:18.323 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.94>}
16:01:18.323 [info] S1: New connection accepted.
16:01:18.323 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.96>}
16:01:18.323 [info] S1: New connection accepted.
16:01:18.323 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.98>}
16:01:18.323 [info] S1: New connection accepted.
16:01:18.323 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.100>}
16:01:18.324 [info] S1: New connection accepted.
16:01:18.324 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.102>}
16:01:18.324 [info] S1: New connection accepted.
16:01:18.324 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.104>}
16:01:18.324 [info] S1: New connection accepted.
16:01:18.324 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.106>}
16:01:18.324 [info] S1: New connection accepted.
16:01:18.324 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.108>}
16:01:18.324 [info] S1: New connection accepted.
16:01:18.324 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.110>}
16:01:18.324 [info] S1: New connection accepted.
16:01:18.324 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.112>}
16:01:18.324 [info] S1: New connection accepted.
16:01:18.324 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.114>}
16:01:18.325 [info] S1: New connection accepted.
16:01:18.325 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.116>}
16:01:18.325 [info] S1: New connection accepted.
16:01:18.325 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.118>}
16:01:18.325 [info] S1: New connection accepted.
16:01:18.325 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.120>}
16:01:18.325 [info] S1: New connection accepted.
16:01:18.325 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.122>}
16:01:18.325 [info] S1: New connection accepted.
16:01:18.325 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.124>}
16:01:18.326 [info] S1: New connection accepted.
16:01:18.326 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.126>}
16:01:18.326 [info] S1: New connection accepted.
16:01:18.326 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.128>}
16:01:18.326 [info] S1: New connection accepted.
16:01:18.326 [info] S1: New connection accepted.
16:01:18.326 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.130>}
16:01:18.326 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.132>}
16:01:18.326 [info] S1: New connection accepted.
16:01:18.326 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.134>}
16:01:18.326 [info] S1: New connection accepted.
16:01:18.326 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.136>}
16:01:18.326 [info] S1: New connection accepted.
16:01:18.327 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.138>}
.......16:01:18.834 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.229.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:18.834 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.468.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:01:18.845 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.468.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:18.845 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.470.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:18.855 [warning] S1 Encapsulator: Invalid IP invalid, dropping packet.
.16:01:18.956 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.470.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:18.957 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.472.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:01:18.968 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.472.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:18.968 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.474.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:01:19.024 [debug] S1: TCPHandler received unexpected message: :accept_loop
....16:01:19.547 [info] S1: New connection accepted.
16:01:19.547 [info] S1: New connection accepted.
16:01:19.547 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.157>}
16:01:19.547 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.159>}
16:01:19.547 [info] S1: New connection accepted.
16:01:19.548 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.162>}
16:01:19.548 [info] S1: New connection accepted.
16:01:19.548 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.163>}
16:01:19.548 [info] S1: New connection accepted.
16:01:19.548 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.165>}
..16:01:20.251 [warning] S1: Invalid LISTEN_IP invalid, using all interfaces.
.16:01:20.251 [info] S1: Starting TCP Listener on port 0...
...16:01:20.252 [info] S1: Starting TCP Listener on port 0...
16:01:20.753 [info] S1: New connection accepted.
.16:01:20.754 [error] S1: Listener socket fatal error: :closed. Terminating.
..16:01:20.754 [info] S1: Starting TCP Listener on port 0...
16:01:21.255 [error] S1: Listener socket fatal error: :closed. Terminating.
16:01:21.256 [error] GenServer :s1_flapping_test_unique terminating
** (stop) :closed
Last message: :accept_loop
State: #Port<0.172>
16:01:21.256 [error] Process :s1_flapping_test_unique (#PID<0.589.0>) terminating
** (exit) :closed
    (stdlib 7.1) gen_server.erl:2562: :gen_server.handle_common_reply/5
    (stdlib 7.1) proc_lib.erl:333: :proc_lib.init_p_do_apply/3
Initial Call: DataDiode.S1.Listener.init/1
Ancestors: [#PID<0.588.0>]
Message Queue Length: 0
Messages: []
Links: []
Dictionary: []
Trapping Exits: false
Status: :running
Heap Size: 1598
Stack Size: 29
Reductions: 2746
..16:01:21.273 [debug] SystemMonitor: Received unexpected message: :unexp
16:01:21.279 [debug] S1: TCPHandler received unexpected message: :unexp
16:01:21.280 [info] S1: Starting TCP Listener on port 0...
16:01:21.280 [debug] S1: Listener received unexpected message: :unexp
16:01:22.053 [info] S2: Starting UDP Listener on port 0...
16:01:22.054 [warning] S2: Received unexpected message: :unexp
16:01:22.054 [error] S2: UDP Listener socket closed unexpectedly. Terminating.
16:01:22.062 [info] DiskCleaner: Low disk space detected on . (< 15%). Starting autonomous cleanup...
16:01:22.062 [warning] DiskCleaner: Simulation - would delete oldest .dat files in . now.
16:01:22.065 [info] S2: Decapsulated packet from 127.0.0.1:20480. Payload size: 7 bytes.
16:01:22.065 [debug] S2: Successfully wrote 7 bytes to /tmp/diode_test/data_1766120482065_64_20480.dat. (Simulated secure write)
16:01:22.065 [info] S2: Decapsulated packet from 127.0.0.1:0. Payload size: 9 bytes.
16:01:22.066 [debug] S1: Generating end-to-end heartbeat.
16:01:22.066 [warning] S1 Heartbeat: Received unexpected message: :unexp
16:01:22.066 [error] S2: Critical Failure! Channel heartbeat missing for > 6 minutes. The diode path may be obstructed.
16:01:22.066 [warning] S2 HeartbeatMonitor: Received unexpected message: :unexp
.16:01:22.067 [info] S2: Starting UDP Listener on port 0...
16:01:22.067 [info] S2: Decapsulated packet from 1.2.3.4:80. Payload size: 5 bytes.
16:01:22.067 [debug] S2: Successfully wrote 5 bytes to ./data_1766120482067_65_80.dat. (Simulated secure write)
..16:01:22.077 [info] S2: Starting UDP Listener on port 0...
16:01:22.078 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.078 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482078_66_80.dat. (Simulated secure write)
16:01:22.078 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.078 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482078_67_80.dat. (Simulated secure write)
16:01:22.078 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.078 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482078_68_80.dat. (Simulated secure write)
16:01:22.078 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.078 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482078_69_80.dat. (Simulated secure write)
16:01:22.078 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.078 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482078_70_80.dat. (Simulated secure write)
16:01:22.078 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.078 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482078_71_80.dat. (Simulated secure write)
16:01:22.078 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.078 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482078_72_80.dat. (Simulated secure write)
16:01:22.078 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.078 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482078_73_80.dat. (Simulated secure write)
16:01:22.078 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.078 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482078_74_80.dat. (Simulated secure write)
16:01:22.079 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.079 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482079_75_80.dat. (Simulated secure write)
16:01:22.079 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.079 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482079_76_80.dat. (Simulated secure write)
16:01:22.079 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.079 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482079_77_80.dat. (Simulated secure write)
16:01:22.079 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.079 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482079_78_80.dat. (Simulated secure write)
16:01:22.079 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.079 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482079_79_80.dat. (Simulated secure write)
16:01:22.079 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.079 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482079_80_80.dat. (Simulated secure write)
16:01:22.079 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.079 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482079_81_80.dat. (Simulated secure write)
16:01:22.079 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.079 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482079_82_80.dat. (Simulated secure write)
16:01:22.079 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.079 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482079_83_80.dat. (Simulated secure write)
16:01:22.080 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.080 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482080_84_80.dat. (Simulated secure write)
16:01:22.080 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.080 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482080_85_80.dat. (Simulated secure write)
16:01:22.080 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.080 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482080_86_80.dat. (Simulated secure write)
16:01:22.080 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.080 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482080_87_80.dat. (Simulated secure write)
16:01:22.080 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.080 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482080_88_80.dat. (Simulated secure write)
16:01:22.080 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.080 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482080_89_80.dat. (Simulated secure write)
16:01:22.080 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.080 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482080_90_80.dat. (Simulated secure write)
16:01:22.080 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.080 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482080_91_80.dat. (Simulated secure write)
16:01:22.081 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.081 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482081_92_80.dat. (Simulated secure write)
16:01:22.081 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.081 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482081_93_80.dat. (Simulated secure write)
16:01:22.081 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.081 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482081_94_80.dat. (Simulated secure write)
16:01:22.081 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.081 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.081 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482081_95_80.dat. (Simulated secure write)
16:01:22.081 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.081 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482081_96_80.dat. (Simulated secure write)
16:01:22.081 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.081 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482081_97_80.dat. (Simulated secure write)
16:01:22.081 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.082 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482081_98_80.dat. (Simulated secure write)
16:01:22.082 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.082 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482082_99_80.dat. (Simulated secure write)
16:01:22.082 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.082 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482082_100_80.dat. (Simulated secure write)
16:01:22.082 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.082 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482082_101_80.dat. (Simulated secure write)
16:01:22.082 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.082 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482082_102_80.dat. (Simulated secure write)
16:01:22.082 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.082 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482082_103_80.dat. (Simulated secure write)
16:01:22.082 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.082 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482082_104_80.dat. (Simulated secure write)
16:01:22.082 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482082_105_80.dat. (Simulated secure write)
16:01:22.083 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.083 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482083_106_80.dat. (Simulated secure write)
16:01:22.083 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.083 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482083_107_80.dat. (Simulated secure write)
16:01:22.083 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.083 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482083_108_80.dat. (Simulated secure write)
16:01:22.083 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.083 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482083_109_80.dat. (Simulated secure write)
16:01:22.083 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.083 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482083_110_80.dat. (Simulated secure write)
16:01:22.083 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.083 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482083_111_80.dat. (Simulated secure write)
16:01:22.084 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.084 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482084_112_80.dat. (Simulated secure write)
16:01:22.084 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.084 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482084_113_80.dat. (Simulated secure write)
16:01:22.084 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.084 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482084_114_80.dat. (Simulated secure write)
16:01:22.084 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.084 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482084_115_80.dat. (Simulated secure write)
16:01:22.084 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.084 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482084_116_80.dat. (Simulated secure write)
16:01:22.084 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.085 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.085 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482085_117_80.dat. (Simulated secure write)
16:01:22.085 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.085 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482085_118_80.dat. (Simulated secure write)
16:01:22.085 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.085 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482085_119_80.dat. (Simulated secure write)
16:01:22.085 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.085 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482085_120_80.dat. (Simulated secure write)
16:01:22.085 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.085 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482085_121_80.dat. (Simulated secure write)
16:01:22.085 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.086 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482086_122_80.dat. (Simulated secure write)
16:01:22.086 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.086 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482086_123_80.dat. (Simulated secure write)
16:01:22.086 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.086 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482086_124_80.dat. (Simulated secure write)
16:01:22.086 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.086 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482086_125_80.dat. (Simulated secure write)
16:01:22.086 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.086 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482086_126_80.dat. (Simulated secure write)
16:01:22.086 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.086 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482086_127_80.dat. (Simulated secure write)
16:01:22.087 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.087 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.087 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482087_128_80.dat. (Simulated secure write)
16:01:22.087 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.087 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482087_129_80.dat. (Simulated secure write)
16:01:22.087 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.087 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482087_130_80.dat. (Simulated secure write)
16:01:22.087 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.087 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482087_131_80.dat. (Simulated secure write)
16:01:22.087 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.087 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482087_132_80.dat. (Simulated secure write)
16:01:22.087 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.087 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482087_133_80.dat. (Simulated secure write)
16:01:22.087 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.087 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482087_134_80.dat. (Simulated secure write)
16:01:22.088 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.088 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482088_135_80.dat. (Simulated secure write)
16:01:22.088 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.088 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482088_136_80.dat. (Simulated secure write)
16:01:22.088 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.088 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482088_137_80.dat. (Simulated secure write)
16:01:22.088 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.088 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482088_138_80.dat. (Simulated secure write)
16:01:22.088 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.088 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482088_139_80.dat. (Simulated secure write)
16:01:22.088 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482088_140_80.dat. (Simulated secure write)
16:01:22.088 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482088_141_80.dat. (Simulated secure write)
16:01:22.088 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.088 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482088_142_80.dat. (Simulated secure write)
16:01:22.088 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.088 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.089 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.089 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.089 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.089 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.089 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.089 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.089 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.089 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.089 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.090 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.090 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.090 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482090_143_80.dat. (Simulated secure write)
16:01:22.090 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482090_144_80.dat. (Simulated secure write)
16:01:22.090 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482090_145_80.dat. (Simulated secure write)
16:01:22.090 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482090_149_80.dat. (Simulated secure write)
16:01:22.090 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482090_146_80.dat. (Simulated secure write)
16:01:22.090 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482090_151_80.dat. (Simulated secure write)
16:01:22.090 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482090_148_80.dat. (Simulated secure write)
16:01:22.090 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482090_150_80.dat. (Simulated secure write)
16:01:22.090 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482090_147_80.dat. (Simulated secure write)
16:01:22.090 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.090 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482090_152_80.dat. (Simulated secure write)
16:01:22.090 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.090 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482090_153_80.dat. (Simulated secure write)
16:01:22.090 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.090 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482090_154_80.dat. (Simulated secure write)
16:01:22.090 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.090 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482090_155_80.dat. (Simulated secure write)
16:01:22.091 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.091 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482091_156_80.dat. (Simulated secure write)
16:01:22.091 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.091 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482091_157_80.dat. (Simulated secure write)
16:01:22.091 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.091 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482091_158_80.dat. (Simulated secure write)
16:01:22.091 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.091 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482091_159_80.dat. (Simulated secure write)
16:01:22.091 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.091 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482091_160_80.dat. (Simulated secure write)
16:01:22.091 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:22.091 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482091_161_80.dat. (Simulated secure write)
16:01:22.091 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482091_162_80.dat. (Simulated secure write)
16:01:22.091 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482091_163_80.dat. (Simulated secure write)
16:01:22.092 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482092_164_80.dat. (Simulated secure write)
16:01:22.092 [debug] S2: Successfully wrote 7 bytes to ./data_1766120482092_165_80.dat. (Simulated secure write)
.16:01:22.192 [error] S2: UDP Listener socket closed unexpectedly. Terminating.
.16:01:22.193 [warning] S2: Invalid LISTEN_IP_S2 invalid, falling back to all interfaces.
...16:01:22.193 [info] S2: Starting UDP Listener on port 0...
16:01:22.194 [info] S2: Decapsulated packet from 127.0.0.1:1234. Payload size: 12 bytes.
16:01:22.194 [debug] S2: Successfully wrote 12 bytes to ./data_1766120482194_166_1234.dat. (Simulated secure write)
16:01:22.217 [info] S2: Starting UDP Listener on port 0...


  1) test UDP listener receives packet and delegates to Decapsulator (DataDiode.S2.ListenerTest)
     test/s2_listener_test.exs:116
     ** (Mox.VerificationError) error while verifying mocks for #PID<0.779.0>:

       * expected DataDiode.S2.DecapsulatorMock.process_packet/1 to be invoked once but it was invoked 0 times
     code: verify!()
     stacktrace:
       (mox 1.2.0) lib/mox.ex:862: Mox.__verify_mock_or_all__/2
       test/s2_listener_test.exs:140: (test)

.
Finished in 4.1 seconds (0.1s async, 4.0s sync)
1 doctest, 65 tests, 1 failure
Run 2 FAILED
Run 3
warning: setting :preferred_cli_env in your mix.exs "def project" is deprecated, set it inside "def cli" instead:

    def cli do
      [preferred_envs: [release: :prod, test: :test]]
    end

  (mix 1.19.4) lib/mix/cli.ex:187: Mix.CLI.preferred_cli_env/3
  (mix 1.19.4) lib/mix/cli.ex:170: Mix.CLI.maybe_change_env_and_target/2
  (mix 1.19.4) lib/mix/cli.ex:59: Mix.CLI.proceed/2
  /opt/homebrew/bin/mix:7: (file)
  (elixir 1.19.4) src/elixir_compiler.erl:81: :elixir_compiler.dispatch/4
  (elixir 1.19.4) src/elixir_compiler.erl:56: :elixir_compiler.compile/4

16:01:22.706 [info] Application logger started at :nonode@nohost
16:01:22.712 [info] Child :ttb_autostart of Supervisor :runtime_tools_sup started
Pid: #PID<0.183.0>
Start Call: :ttb_autostart.start_link()
Restart: :temporary
Shutdown: 3000
Type: :worker
16:01:22.712 [info] Application runtime_tools started at :nonode@nohost
16:01:22.712 [info] Application opentelemetry_api started at :nonode@nohost
16:01:22.712 [info] Application ctx started at :nonode@nohost
16:01:22.712 [info] Application hpack started at :nonode@nohost
16:01:22.712 [info] Application chatterbox started at :nonode@nohost
16:01:22.712 [info] Application acceptor_pool started at :nonode@nohost
16:01:22.718 [info] Child :gproc of Supervisor :gproc_sup started
Pid: #PID<0.187.0>
Start Call: :gproc.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:01:22.719 [info] Child :gproc_monitor of Supervisor :gproc_sup started
Pid: #PID<0.188.0>
Start Call: :gproc_monitor.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:01:22.720 [info] Child :gproc_bcast of Supervisor :gproc_sup started
Pid: #PID<0.189.0>
Start Call: :gproc_bcast.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:01:22.721 [info] Child :gproc_pool of Supervisor :gproc_sup started
Pid: #PID<0.190.0>
Start Call: :gproc_pool.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:01:22.721 [info] Application gproc started at :nonode@nohost
16:01:22.723 [info] Child :grpcbox_services_simple_sup of Supervisor :grpcbox_sup started
Pid: #PID<0.194.0>
Start Call: :grpcbox_services_simple_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:01:22.723 [info] Child :grpcbox_channel_sup of Supervisor :grpcbox_sup started
Pid: #PID<0.195.0>
Start Call: :grpcbox_channel_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:01:22.723 [info] Application grpcbox started at :nonode@nohost
16:01:22.724 [info] Application ssl_verify_fun started at :nonode@nohost
16:01:22.819 [info] Loading 162 CA(s) from :otp store
16:01:22.819 [info] Child :tls_certificate_check_shared_state of Supervisor :tls_certificate_check_sup started
Pid: #PID<0.199.0>
Start Call: :tls_certificate_check_shared_state.start_link()
Restart: :permanent
Shutdown: :infinity
Type: :worker
16:01:22.819 [info] Application tls_certificate_check started at :nonode@nohost
16:01:22.819 [info] Application opentelemetry_exporter started at :nonode@nohost
16:01:22.831 [info] Child :otel_span_ets of Supervisor :otel_span_sup started
Pid: #PID<0.207.0>
Start Call: :otel_span_ets.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:22.832 [info] Child :otel_span_sweeper of Supervisor :otel_span_sup started
Pid: #PID<0.208.0>
Start Call: :otel_span_sweeper.start_link(%{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:22.832 [info] Child :otel_span_sup of Supervisor :opentelemetry_sup started
Pid: #PID<0.206.0>
Start Call: :otel_span_sup.start_link(%{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:01:22.834 [info] Child :otel_resource_detector of Supervisor :opentelemetry_sup started
Pid: #PID<0.209.0>
Start Call: :otel_resource_detector.start_link(%{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:22.836 [info] Child :otel_tracer_provider_sup of Supervisor :opentelemetry_sup started
Pid: #PID<0.212.0>
Start Call: :otel_tracer_provider_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:01:22.838 [info] Child :otel_span_processor_sup of Supervisor #PID<0.213.0> (:otel_tracer_server_sup) started
Pid: #PID<0.214.0>
Start Call: :otel_span_processor_sup.start_link(:otel_span_processor_sup_global)
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:01:22.849 [info] Child :otel_tracer_server of Supervisor #PID<0.213.0> (:otel_tracer_server_sup) started
Pid: #PID<0.215.0>
Start Call: :otel_tracer_server.start_link(:global, :otel_tracer_provider_global, :otel_span_processor_sup_global, {:resource, :undefined, {:attributes, 128, 255, 0, %{"process.executable.name": "erl", "process.runtime.description": "Erlang/OTP 28 erts-16.1.2", "process.runtime.version": "16.1.2", "process.runtime.name": "BEAM", "service.name": "unknown_service:erl", "service.instance.id": 67397798558499329632503619299432075526, "telemetry.sdk.version": "1.6.0", "telemetry.sdk.language": "erlang", "telemetry.sdk.name": "opentelemetry"}}}, %{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:22.854 [debug] Child {:httpc, :"otel_exporter_otlp_<0.216.0>"} of Supervisor :httpc_profile_sup started
Pid: #PID<0.217.0>
Start Call: :httpc_manager.start_link(:"otel_exporter_otlp_<0.216.0>", :only_session_cookies, :inets)
Restart: :permanent
Shutdown: 4000
Type: :worker
16:01:22.856 [info] Application opentelemetry started at :nonode@nohost
16:01:22.859 [info] OTLP exporter successfully initialized
16:01:22.862 [info] Application jason started at :nonode@nohost
16:01:22.862 [info] Application logger_json started at :nonode@nohost
16:01:22.862 [info] Application nimble_ownership started at :nonode@nohost
16:01:22.866 [info] Child Mox of Supervisor Mox.Supervisor started
Pid: #PID<0.221.0>
Start Call: Mox.start_link_ownership()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:22.867 [info] Application mox started at :nonode@nohost
16:01:22.871 [info] Child DataDiode.Metrics of Supervisor DataDiode.Supervisor started
Pid: #PID<0.225.0>
Start Call: DataDiode.Metrics.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:22.872 [info] Child DataDiode.SystemMonitor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.226.0>
Start Call: DataDiode.SystemMonitor.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:22.873 [info] S1: Starting TCP Listener on port 0...
16:01:22.873 [info] Child DataDiode.S1.Listener of Supervisor DataDiode.Supervisor started
Pid: #PID<0.227.0>
Start Call: DataDiode.S1.Listener.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:22.875 [info] Child DataDiode.S1.HandlerSupervisor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.228.0>
Start Call: DataDiode.S1.HandlerSupervisor.start_link()
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:01:22.878 [warning] S1 Encapsulator: Invalid S2_PORT 0, using default 42001
16:01:22.878 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.229.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:22.878 [info] Child DataDiode.S1.Heartbeat of Supervisor DataDiode.Supervisor started
Pid: #PID<0.230.0>
Start Call: DataDiode.S1.Heartbeat.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:22.878 [info] Child DataDiode.S2.HeartbeatMonitor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.231.0>
Start Call: DataDiode.S2.HeartbeatMonitor.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:22.878 [info] Child DataDiode.DiskCleaner of Supervisor DataDiode.Supervisor started
Pid: #PID<0.232.0>
Start Call: DataDiode.DiskCleaner.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:22.879 [info] S2: Starting UDP Listener on port 0...
16:01:22.880 [info] Child DataDiode.S2.Listener of Supervisor DataDiode.Supervisor started
Pid: #PID<0.233.0>
Start Call: DataDiode.S2.Listener.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:22.880 [info] Child DataDiode.S2.TaskSupervisor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.234.0>
Start Call: Task.Supervisor.start_link([name: DataDiode.S2.TaskSupervisor, max_children: 200])
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:01:22.880 [info] Application data_diode started at :nonode@nohost
16:01:22.893 [info] Child ExUnit.Server of Supervisor ExUnit.Supervisor started
Pid: #PID<0.240.0>
Start Call: ExUnit.Server.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:22.893 [info] Child ExUnit.CaptureServer of Supervisor ExUnit.Supervisor started
Pid: #PID<0.241.0>
Start Call: ExUnit.CaptureServer.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:22.893 [info] Application ex_unit started at :nonode@nohost
Running ExUnit with seed: 897063, max_cases: 16

     warning: redefining module DataDiode.S1.EncapsulatorMock (current version defined in memory)
     │
 491 │     Module.create(name, [info | body], Macro.Env.location(__ENV__))
     │     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     │
     └─ deps/mox/lib/mox.ex:491: DataDiode.S1.EncapsulatorMock (module)

    warning: variable "c" is unused (if the variable is not meant to be used, prefix it with an underscore)
    │
 26 │     {:ok, c} = :gen_tcp.connect({127,0,0,1}, port, [:binary, active: false])
    │           ~
    │
    └─ test/long_term_robustness_test.exs:26:11: DataDiode.LongTermRobustnessTest."test TCPHandler exhaustive branch coverage"/1

    warning: variable "pid3" is unused (if the variable is not meant to be used, prefix it with an underscore)
    │
 62 │     {:ok, pid3} = TCPHandler.start_link(s3)
    │           ~~~~
    │
    └─ test/long_term_robustness_test.exs:62:11: DataDiode.LongTermRobustnessTest."test TCPHandler exhaustive branch coverage"/1

...........16:01:23.089 [info] S1: Forwarded 11 bytes.
...16:01:23.095 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 0 bytes.
.16:01:23.095 [debug] S2: Successfully wrote 0 bytes to ./data_1766120483095_3_51210.dat. (Simulated secure write)
16:01:23.095 [info] S2: Decapsulated packet from 0.0.0.0:0. Payload size: 0 bytes.
16:01:23.095 [debug] S2: Successfully wrote 0 bytes to ./data_1766120483095_4_0.dat. (Simulated secure write)
.16:01:23.097 [error] S2: Failed to parse header: invalid_packet_size
.16:01:23.097 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 9 bytes.
.16:01:23.097 [debug] S2: Successfully wrote 9 bytes to ./data_1766120483097_5_80.dat. (Simulated secure write)
.16:01:23.097 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 23 bytes.
.16:01:23.097 [debug] S2: Successfully wrote 23 bytes to ./data_1766120483097_6_51210.dat. (Simulated secure write)
.16:01:23.098 [error] S2: Failed to parse header: invalid_packet_size
16:01:23.098 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 23 bytes.
16:01:23.098 [debug] S2: Successfully wrote 23 bytes to ./data_1766120483098_7_51210.dat. (Simulated secure write)
16:01:23.098 [error] S2: Failed to parse header: invalid_packet_size
..16:01:23.099 [debug] S1: TCPHandler received unexpected message: :accept_loop
..16:01:23.101 [warning] S1: Dropping oversized packet (1048577 bytes) from 1.2.3.4
.16:01:23.101 [error] S1: TCP error for 1.2.3.4: :econnreset
........16:01:23.169 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.229.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:23.169 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.418.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:01:23.181 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.418.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:23.181 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.420.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:23.192 [warning] S1 Encapsulator: Invalid IP invalid, dropping packet.
.16:01:23.293 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.420.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:23.293 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.422.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:01:23.295 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.422.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:23.295 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.424.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:01:23.315 [debug] SystemMonitor: Received unexpected message: :unexp
16:01:23.318 [debug] S1: TCPHandler received unexpected message: :unexp
16:01:23.319 [info] S1: Starting TCP Listener on port 0...
16:01:23.319 [debug] S1: Listener received unexpected message: :unexp
16:01:23.874 [info] S2: Starting UDP Listener on port 0...
16:01:23.874 [warning] S2: Received unexpected message: :unexp
16:01:23.874 [error] S2: UDP Listener socket closed unexpectedly. Terminating.
16:01:23.878 [info] DiskCleaner: Low disk space detected on . (< 15%). Starting autonomous cleanup...
16:01:23.878 [warning] DiskCleaner: Simulation - would delete oldest .dat files in . now.
16:01:23.881 [info] S2: Decapsulated packet from 127.0.0.1:20480. Payload size: 7 bytes.
16:01:23.881 [debug] S2: Successfully wrote 7 bytes to /tmp/diode_test/data_1766120483881_9_20480.dat. (Simulated secure write)
16:01:23.881 [info] S2: Decapsulated packet from 127.0.0.1:0. Payload size: 9 bytes.
16:01:23.883 [debug] S1: Generating end-to-end heartbeat.
16:01:23.883 [warning] S1 Heartbeat: Received unexpected message: :unexp
16:01:23.883 [error] S2: Critical Failure! Channel heartbeat missing for > 6 minutes. The diode path may be obstructed.
16:01:23.883 [warning] S2 HeartbeatMonitor: Received unexpected message: :unexp
.16:01:23.884 [info] S1: Starting TCP Listener on port 8092...
16:01:23.884 [info] S1: New connection accepted.
16:01:23.885 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.54>}
16:01:23.885 [info] S1: New connection accepted.
16:01:23.885 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.61>}
16:01:23.885 [info] S1: New connection accepted.
16:01:23.885 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.62>}
16:01:23.885 [info] S1: New connection accepted.
16:01:23.886 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.63>}
16:01:23.886 [info] S1: New connection accepted.
16:01:23.886 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.64>}
16:01:23.886 [info] S1: New connection accepted.
16:01:23.886 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.65>}
16:01:23.917 [info] S1: New connection accepted.
16:01:23.917 [info] S1: New connection accepted.
16:01:23.917 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.66>}
16:01:23.917 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.68>}
16:01:23.917 [info] S1: New connection accepted.
16:01:23.917 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.70>}
16:01:23.917 [info] S1: New connection accepted.
16:01:23.917 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.72>}
16:01:23.917 [info] S1: New connection accepted.
16:01:23.917 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.74>}
16:01:23.918 [info] S1: New connection accepted.
16:01:23.918 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.76>}
16:01:23.918 [info] S1: New connection accepted.
16:01:23.918 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.78>}
16:01:23.918 [info] S1: New connection accepted.
16:01:23.918 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.80>}
16:01:23.918 [info] S1: New connection accepted.
16:01:23.918 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.82>}
16:01:23.918 [info] S1: New connection accepted.
16:01:23.918 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.84>}
16:01:23.918 [info] S1: New connection accepted.
16:01:23.918 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.86>}
16:01:23.918 [info] S1: New connection accepted.
16:01:23.919 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.88>}
16:01:23.919 [info] S1: New connection accepted.
16:01:23.919 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.90>}
16:01:23.919 [info] S1: New connection accepted.
16:01:23.919 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.92>}
16:01:23.919 [info] S1: New connection accepted.
16:01:23.919 [info] S1: New connection accepted.
16:01:23.919 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.94>}
16:01:23.919 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.96>}
16:01:23.919 [info] S1: New connection accepted.
16:01:23.920 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.98>}
16:01:23.920 [info] S1: New connection accepted.
16:01:23.920 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.100>}
16:01:23.920 [info] S1: New connection accepted.
16:01:23.920 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.102>}
16:01:23.920 [info] S1: New connection accepted.
16:01:23.920 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.104>}
16:01:23.920 [info] S1: New connection accepted.
16:01:23.920 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.106>}
16:01:23.920 [info] S1: New connection accepted.
16:01:23.921 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.108>}
16:01:23.921 [info] S1: New connection accepted.
16:01:23.921 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.110>}
16:01:23.921 [info] S1: New connection accepted.
16:01:23.921 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.112>}
16:01:23.921 [info] S1: New connection accepted.
16:01:23.921 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.114>}
16:01:23.921 [info] S1: New connection accepted.
16:01:23.921 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.116>}
16:01:23.922 [info] S1: New connection accepted.
16:01:23.922 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.118>}
16:01:23.922 [info] S1: New connection accepted.
16:01:23.922 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.120>}
16:01:23.922 [info] S1: New connection accepted.
16:01:23.922 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.122>}
16:01:23.922 [info] S1: New connection accepted.
16:01:23.922 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.124>}
16:01:23.922 [info] S1: New connection accepted.
16:01:23.922 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.126>}
16:01:23.923 [info] S1: New connection accepted.
16:01:23.923 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.128>}
16:01:23.923 [info] S1: New connection accepted.
16:01:23.923 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.130>}
16:01:23.923 [info] S1: New connection accepted.
16:01:23.923 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.132>}
16:01:23.923 [info] S1: New connection accepted.
16:01:23.923 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.134>}
16:01:23.923 [info] S1: New connection accepted.
16:01:23.923 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.136>}
16:01:23.924 [info] S1: New connection accepted.
16:01:23.924 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.138>}
16:01:23.924 [info] S1: New connection accepted.
16:01:23.924 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.140>}
16:01:23.924 [info] S1: New connection accepted.
16:01:23.924 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.142>}
16:01:23.924 [info] S1: New connection accepted.
16:01:23.924 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.144>}
16:01:23.925 [info] S1: New connection accepted.
16:01:23.925 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.146>}
16:01:23.925 [info] S1: New connection accepted.
16:01:23.925 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.148>}
16:01:23.925 [info] S1: New connection accepted.
16:01:23.925 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.150>}
16:01:23.925 [info] S1: New connection accepted.
16:01:23.925 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.152>}
.16:01:24.479 [info] S1: Connection closed by 127.0.0.1:57494
....16:01:24.877 [info] S1: New connection accepted.
16:01:24.877 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.158>}
16:01:24.877 [info] S1: New connection accepted.
16:01:24.877 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.160>}
16:01:24.877 [info] S1: New connection accepted.
16:01:24.877 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.162>}
16:01:24.877 [info] S1: New connection accepted.
16:01:24.878 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.164>}
16:01:24.878 [info] S1: New connection accepted.
16:01:24.878 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.166>}
.16:01:25.127 [debug] S1: TCPHandler received unexpected message: :accept_loop
....16:01:25.128 [info] S1: Starting TCP Listener on port 0...
16:01:25.630 [info] S1: New connection accepted.
.16:01:25.630 [info] S1: Starting TCP Listener on port 0...
.16:01:25.631 [info] S1: Starting TCP Listener on port 0...
16:01:26.132 [error] S1: Listener socket fatal error: :closed. Terminating.
16:01:26.132 [error] GenServer :s1_flapping_test_unique terminating
** (stop) :closed
Last message: :accept_loop
State: #Port<0.179>
16:01:26.132 [error] Process :s1_flapping_test_unique (#PID<0.656.0>) terminating
** (exit) :closed
    (stdlib 7.1) gen_server.erl:2562: :gen_server.handle_common_reply/5
    (stdlib 7.1) proc_lib.erl:333: :proc_lib.init_p_do_apply/3
Initial Call: DataDiode.S1.Listener.init/1
Ancestors: [#PID<0.655.0>]
Message Queue Length: 0
Messages: []
Links: []
Dictionary: []
Trapping Exits: false
Status: :running
Heap Size: 1598
Stack Size: 29
Reductions: 2746
...16:01:26.133 [error] S1: Listener socket fatal error: :closed. Terminating.
.16:01:26.133 [warning] S1: Invalid LISTEN_IP invalid, using all interfaces.
..16:01:26.634 [info] S2: Starting UDP Listener on port 0...
16:01:26.634 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.634 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486634_67_80.dat. (Simulated secure write)
16:01:26.635 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.635 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486635_68_80.dat. (Simulated secure write)
16:01:26.635 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.635 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486635_69_80.dat. (Simulated secure write)
16:01:26.635 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.635 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486635_70_80.dat. (Simulated secure write)
16:01:26.635 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.635 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486635_71_80.dat. (Simulated secure write)
16:01:26.635 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.635 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486635_72_80.dat. (Simulated secure write)
16:01:26.635 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.636 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.636 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486635_73_80.dat. (Simulated secure write)
16:01:26.636 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486636_74_80.dat. (Simulated secure write)
16:01:26.636 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.636 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486636_75_80.dat. (Simulated secure write)
16:01:26.636 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.636 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486636_76_80.dat. (Simulated secure write)
16:01:26.636 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.636 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486636_77_80.dat. (Simulated secure write)
16:01:26.636 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.636 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486636_78_80.dat. (Simulated secure write)
16:01:26.636 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.636 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486636_79_80.dat. (Simulated secure write)
16:01:26.637 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.637 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486637_80_80.dat. (Simulated secure write)
16:01:26.637 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.637 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486637_81_80.dat. (Simulated secure write)
16:01:26.637 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.637 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486637_82_80.dat. (Simulated secure write)
16:01:26.637 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.637 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486637_83_80.dat. (Simulated secure write)
16:01:26.637 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.637 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486637_84_80.dat. (Simulated secure write)
16:01:26.637 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.637 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486637_85_80.dat. (Simulated secure write)
16:01:26.638 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.638 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486638_86_80.dat. (Simulated secure write)
16:01:26.638 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.638 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486638_87_80.dat. (Simulated secure write)
16:01:26.638 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.638 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486638_88_80.dat. (Simulated secure write)
16:01:26.638 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.638 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486638_89_80.dat. (Simulated secure write)
16:01:26.638 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.638 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.638 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486638_90_80.dat. (Simulated secure write)
16:01:26.638 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486638_91_80.dat. (Simulated secure write)
16:01:26.638 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.639 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486639_92_80.dat. (Simulated secure write)
16:01:26.639 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.639 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486639_93_80.dat. (Simulated secure write)
16:01:26.639 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.639 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486639_94_80.dat. (Simulated secure write)
16:01:26.639 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.639 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486639_95_80.dat. (Simulated secure write)
16:01:26.639 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.639 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486639_96_80.dat. (Simulated secure write)
16:01:26.639 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.639 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486639_97_80.dat. (Simulated secure write)
16:01:26.639 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.639 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486639_98_80.dat. (Simulated secure write)
16:01:26.639 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.639 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486639_99_80.dat. (Simulated secure write)
16:01:26.640 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.640 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486640_100_80.dat. (Simulated secure write)
16:01:26.640 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.640 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486640_101_80.dat. (Simulated secure write)
16:01:26.640 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.640 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486640_102_80.dat. (Simulated secure write)
16:01:26.640 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.640 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.640 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486640_103_80.dat. (Simulated secure write)
16:01:26.640 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486640_104_80.dat. (Simulated secure write)
16:01:26.640 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.640 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486640_105_80.dat. (Simulated secure write)
16:01:26.640 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.640 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486640_106_80.dat. (Simulated secure write)
16:01:26.641 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.641 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486641_107_80.dat. (Simulated secure write)
16:01:26.641 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.641 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486641_108_80.dat. (Simulated secure write)
16:01:26.641 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.641 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486641_109_80.dat. (Simulated secure write)
16:01:26.641 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.641 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486641_110_80.dat. (Simulated secure write)
16:01:26.641 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.641 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486641_111_80.dat. (Simulated secure write)
16:01:26.641 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.641 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486641_112_80.dat. (Simulated secure write)
16:01:26.641 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.641 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486641_113_80.dat. (Simulated secure write)
16:01:26.641 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.641 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486641_114_80.dat. (Simulated secure write)
16:01:26.642 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.642 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486642_115_80.dat. (Simulated secure write)
16:01:26.642 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.642 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486642_116_80.dat. (Simulated secure write)
16:01:26.642 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.642 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486642_117_80.dat. (Simulated secure write)
16:01:26.642 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.642 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486642_118_80.dat. (Simulated secure write)
16:01:26.642 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.642 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486642_119_80.dat. (Simulated secure write)
16:01:26.642 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.642 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486642_120_80.dat. (Simulated secure write)
16:01:26.642 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.642 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486642_121_80.dat. (Simulated secure write)
16:01:26.642 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.642 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.642 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.643 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.643 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.643 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.643 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.643 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.643 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.643 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.643 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.644 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.644 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.644 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486644_122_80.dat. (Simulated secure write)
16:01:26.644 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486644_123_80.dat. (Simulated secure write)
16:01:26.644 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486644_124_80.dat. (Simulated secure write)
16:01:26.644 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486644_125_80.dat. (Simulated secure write)
16:01:26.644 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486644_126_80.dat. (Simulated secure write)
16:01:26.644 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.644 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486644_127_80.dat. (Simulated secure write)
16:01:26.644 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.644 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486644_128_80.dat. (Simulated secure write)
16:01:26.644 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.644 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486644_129_80.dat. (Simulated secure write)
16:01:26.644 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.644 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486644_130_80.dat. (Simulated secure write)
16:01:26.644 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.644 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486644_131_80.dat. (Simulated secure write)
16:01:26.645 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.645 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486645_132_80.dat. (Simulated secure write)
16:01:26.645 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.645 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486645_133_80.dat. (Simulated secure write)
16:01:26.645 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.645 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486645_134_80.dat. (Simulated secure write)
16:01:26.645 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.645 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486645_135_80.dat. (Simulated secure write)
16:01:26.645 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.645 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486645_136_80.dat. (Simulated secure write)
16:01:26.645 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.645 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486645_137_80.dat. (Simulated secure write)
16:01:26.645 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.645 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486645_138_80.dat. (Simulated secure write)
16:01:26.645 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.645 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486645_139_80.dat. (Simulated secure write)
16:01:26.645 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486645_140_80.dat. (Simulated secure write)
16:01:26.646 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486646_142_80.dat. (Simulated secure write)
16:01:26.646 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.646 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486646_144_80.dat. (Simulated secure write)
16:01:26.646 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486645_141_80.dat. (Simulated secure write)
16:01:26.646 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486646_143_80.dat. (Simulated secure write)
16:01:26.646 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486646_145_80.dat. (Simulated secure write)
16:01:26.646 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486646_146_80.dat. (Simulated secure write)
16:01:26.646 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.646 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.646 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.646 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.646 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.646 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.646 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.647 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.647 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.647 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.647 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.647 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486647_147_80.dat. (Simulated secure write)
16:01:26.647 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486647_148_80.dat. (Simulated secure write)
16:01:26.647 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.647 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.647 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.648 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.648 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.648 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.648 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:26.648 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486648_149_80.dat. (Simulated secure write)
16:01:26.648 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486648_150_80.dat. (Simulated secure write)
16:01:26.648 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486648_151_80.dat. (Simulated secure write)
16:01:26.648 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486648_152_80.dat. (Simulated secure write)
16:01:26.648 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486648_156_80.dat. (Simulated secure write)
16:01:26.649 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486648_159_80.dat. (Simulated secure write)
16:01:26.649 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486649_161_80.dat. (Simulated secure write)
16:01:26.648 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486648_155_80.dat. (Simulated secure write)
16:01:26.648 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486648_158_80.dat. (Simulated secure write)
16:01:26.648 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486648_153_80.dat. (Simulated secure write)
16:01:26.649 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486649_160_80.dat. (Simulated secure write)
16:01:26.648 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486648_154_80.dat. (Simulated secure write)
16:01:26.649 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486649_162_80.dat. (Simulated secure write)
16:01:26.648 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486648_157_80.dat. (Simulated secure write)
16:01:26.649 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486649_163_80.dat. (Simulated secure write)
16:01:26.649 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486649_164_80.dat. (Simulated secure write)
16:01:26.649 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486649_165_80.dat. (Simulated secure write)
16:01:26.649 [debug] S2: Successfully wrote 7 bytes to ./data_1766120486649_166_80.dat. (Simulated secure write)
..16:01:26.749 [warning] S2: Invalid LISTEN_IP_S2 invalid, falling back to all interfaces.
.16:01:26.750 [info] S2: Starting UDP Listener on port 0...
..16:01:26.750 [info] S2: Starting UDP Listener on port 0...
16:01:26.750 [info] S2: Decapsulated packet from 127.0.0.1:1234. Payload size: 12 bytes.
16:01:26.751 [debug] S2: Successfully wrote 12 bytes to ./data_1766120486751_167_1234.dat. (Simulated secure write)
16:01:26.773 [error] S2: UDP Listener socket closed unexpectedly. Terminating.
16:01:26.773 [info] S2: Starting UDP Listener on port 0...
16:01:26.774 [info] S2: Decapsulated packet from 1.2.3.4:80. Payload size: 5 bytes.
16:01:26.774 [debug] S2: Successfully wrote 5 bytes to ./data_1766120486774_168_80.dat. (Simulated secure write)


  1) test UDP listener receives packet and delegates to Decapsulator (DataDiode.S2.ListenerTest)
     test/s2_listener_test.exs:116
     ** (Mox.VerificationError) error while verifying mocks for #PID<0.780.0>:

       * expected DataDiode.S2.DecapsulatorMock.process_packet/1 to be invoked once but it was invoked 0 times
     code: verify!()
     stacktrace:
       (mox 1.2.0) lib/mox.ex:862: Mox.__verify_mock_or_all__/2
       test/s2_listener_test.exs:140: (test)

...
Finished in 3.8 seconds (0.2s async, 3.6s sync)
1 doctest, 65 tests, 1 failure
Run 3 FAILED
Run 4
warning: setting :preferred_cli_env in your mix.exs "def project" is deprecated, set it inside "def cli" instead:

    def cli do
      [preferred_envs: [release: :prod, test: :test]]
    end

  (mix 1.19.4) lib/mix/cli.ex:187: Mix.CLI.preferred_cli_env/3
  (mix 1.19.4) lib/mix/cli.ex:170: Mix.CLI.maybe_change_env_and_target/2
  (mix 1.19.4) lib/mix/cli.ex:59: Mix.CLI.proceed/2
  /opt/homebrew/bin/mix:7: (file)
  (elixir 1.19.4) src/elixir_compiler.erl:81: :elixir_compiler.dispatch/4
  (elixir 1.19.4) src/elixir_compiler.erl:56: :elixir_compiler.compile/4

16:01:27.402 [info] Application logger started at :nonode@nohost
16:01:27.412 [info] Child :ttb_autostart of Supervisor :runtime_tools_sup started
Pid: #PID<0.183.0>
Start Call: :ttb_autostart.start_link()
Restart: :temporary
Shutdown: 3000
Type: :worker
16:01:27.413 [info] Application runtime_tools started at :nonode@nohost
16:01:27.413 [info] Application opentelemetry_api started at :nonode@nohost
16:01:27.413 [info] Application ctx started at :nonode@nohost
16:01:27.413 [info] Application hpack started at :nonode@nohost
16:01:27.413 [info] Application chatterbox started at :nonode@nohost
16:01:27.413 [info] Application acceptor_pool started at :nonode@nohost
16:01:27.421 [info] Child :gproc of Supervisor :gproc_sup started
Pid: #PID<0.187.0>
Start Call: :gproc.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:01:27.423 [info] Child :gproc_monitor of Supervisor :gproc_sup started
Pid: #PID<0.188.0>
Start Call: :gproc_monitor.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:01:27.423 [info] Child :gproc_bcast of Supervisor :gproc_sup started
Pid: #PID<0.189.0>
Start Call: :gproc_bcast.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:01:27.425 [info] Child :gproc_pool of Supervisor :gproc_sup started
Pid: #PID<0.190.0>
Start Call: :gproc_pool.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:01:27.425 [info] Application gproc started at :nonode@nohost
16:01:27.427 [info] Child :grpcbox_services_simple_sup of Supervisor :grpcbox_sup started
Pid: #PID<0.194.0>
Start Call: :grpcbox_services_simple_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:01:27.428 [info] Child :grpcbox_channel_sup of Supervisor :grpcbox_sup started
Pid: #PID<0.195.0>
Start Call: :grpcbox_channel_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:01:27.428 [info] Application grpcbox started at :nonode@nohost
16:01:27.428 [info] Application ssl_verify_fun started at :nonode@nohost
16:01:27.504 [info] Loading 162 CA(s) from :otp store
16:01:27.504 [info] Child :tls_certificate_check_shared_state of Supervisor :tls_certificate_check_sup started
Pid: #PID<0.199.0>
Start Call: :tls_certificate_check_shared_state.start_link()
Restart: :permanent
Shutdown: :infinity
Type: :worker
16:01:27.504 [info] Application tls_certificate_check started at :nonode@nohost
16:01:27.504 [info] Application opentelemetry_exporter started at :nonode@nohost
16:01:27.514 [info] Child :otel_span_ets of Supervisor :otel_span_sup started
Pid: #PID<0.207.0>
Start Call: :otel_span_ets.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:27.515 [info] Child :otel_span_sweeper of Supervisor :otel_span_sup started
Pid: #PID<0.208.0>
Start Call: :otel_span_sweeper.start_link(%{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:27.516 [info] Child :otel_span_sup of Supervisor :opentelemetry_sup started
Pid: #PID<0.206.0>
Start Call: :otel_span_sup.start_link(%{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:01:27.518 [info] Child :otel_resource_detector of Supervisor :opentelemetry_sup started
Pid: #PID<0.209.0>
Start Call: :otel_resource_detector.start_link(%{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:27.520 [info] Child :otel_tracer_provider_sup of Supervisor :opentelemetry_sup started
Pid: #PID<0.212.0>
Start Call: :otel_tracer_provider_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:01:27.522 [info] Child :otel_span_processor_sup of Supervisor #PID<0.213.0> (:otel_tracer_server_sup) started
Pid: #PID<0.214.0>
Start Call: :otel_span_processor_sup.start_link(:otel_span_processor_sup_global)
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:01:27.529 [info] Child :otel_tracer_server of Supervisor #PID<0.213.0> (:otel_tracer_server_sup) started
Pid: #PID<0.215.0>
Start Call: :otel_tracer_server.start_link(:global, :otel_tracer_provider_global, :otel_span_processor_sup_global, {:resource, :undefined, {:attributes, 128, 255, 0, %{"process.executable.name": "erl", "process.runtime.description": "Erlang/OTP 28 erts-16.1.2", "process.runtime.version": "16.1.2", "process.runtime.name": "BEAM", "service.name": "unknown_service:erl", "service.instance.id": 219015700291844976451646653184536574326, "telemetry.sdk.version": "1.6.0", "telemetry.sdk.language": "erlang", "telemetry.sdk.name": "opentelemetry"}}}, %{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:27.532 [debug] Child {:httpc, :"otel_exporter_otlp_<0.216.0>"} of Supervisor :httpc_profile_sup started
Pid: #PID<0.217.0>
Start Call: :httpc_manager.start_link(:"otel_exporter_otlp_<0.216.0>", :only_session_cookies, :inets)
Restart: :permanent
Shutdown: 4000
Type: :worker
16:01:27.535 [info] OTLP exporter successfully initialized
16:01:27.535 [info] Application opentelemetry started at :nonode@nohost
16:01:27.536 [info] Application jason started at :nonode@nohost
16:01:27.536 [info] Application logger_json started at :nonode@nohost
16:01:27.537 [info] Application nimble_ownership started at :nonode@nohost
16:01:27.539 [info] Child Mox of Supervisor Mox.Supervisor started
Pid: #PID<0.221.0>
Start Call: Mox.start_link_ownership()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:27.539 [info] Application mox started at :nonode@nohost
16:01:27.545 [info] Child DataDiode.Metrics of Supervisor DataDiode.Supervisor started
Pid: #PID<0.225.0>
Start Call: DataDiode.Metrics.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:27.545 [info] Child DataDiode.SystemMonitor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.226.0>
Start Call: DataDiode.SystemMonitor.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:27.546 [info] S1: Starting TCP Listener on port 0...
16:01:27.546 [info] Child DataDiode.S1.Listener of Supervisor DataDiode.Supervisor started
Pid: #PID<0.227.0>
Start Call: DataDiode.S1.Listener.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:27.548 [info] Child DataDiode.S1.HandlerSupervisor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.228.0>
Start Call: DataDiode.S1.HandlerSupervisor.start_link()
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:01:27.550 [warning] S1 Encapsulator: Invalid S2_PORT 0, using default 42001
16:01:27.550 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.229.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:27.550 [info] Child DataDiode.S1.Heartbeat of Supervisor DataDiode.Supervisor started
Pid: #PID<0.230.0>
Start Call: DataDiode.S1.Heartbeat.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:27.550 [info] Child DataDiode.S2.HeartbeatMonitor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.231.0>
Start Call: DataDiode.S2.HeartbeatMonitor.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:27.550 [info] Child DataDiode.DiskCleaner of Supervisor DataDiode.Supervisor started
Pid: #PID<0.232.0>
Start Call: DataDiode.DiskCleaner.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:27.551 [info] S2: Starting UDP Listener on port 0...
16:01:27.551 [info] Child DataDiode.S2.Listener of Supervisor DataDiode.Supervisor started
Pid: #PID<0.233.0>
Start Call: DataDiode.S2.Listener.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:27.551 [info] Child DataDiode.S2.TaskSupervisor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.234.0>
Start Call: Task.Supervisor.start_link([name: DataDiode.S2.TaskSupervisor, max_children: 200])
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:01:27.551 [info] Application data_diode started at :nonode@nohost
16:01:27.557 [info] Child ExUnit.Server of Supervisor ExUnit.Supervisor started
Pid: #PID<0.240.0>
Start Call: ExUnit.Server.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:27.557 [info] Child ExUnit.CaptureServer of Supervisor ExUnit.Supervisor started
Pid: #PID<0.241.0>
Start Call: ExUnit.CaptureServer.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:27.557 [info] Application ex_unit started at :nonode@nohost
Running ExUnit with seed: 559012, max_cases: 16

     warning: redefining module DataDiode.S1.EncapsulatorMock (current version defined in memory)
     │
 491 │     Module.create(name, [info | body], Macro.Env.location(__ENV__))
     │     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     │
     └─ deps/mox/lib/mox.ex:491: DataDiode.S1.EncapsulatorMock (module)

    warning: variable "c" is unused (if the variable is not meant to be used, prefix it with an underscore)
    │
 26 │     {:ok, c} = :gen_tcp.connect({127,0,0,1}, port, [:binary, active: false])
    │           ~
    │
    └─ test/long_term_robustness_test.exs:26:11: DataDiode.LongTermRobustnessTest."test TCPHandler exhaustive branch coverage"/1

    warning: variable "pid3" is unused (if the variable is not meant to be used, prefix it with an underscore)
    │
 62 │     {:ok, pid3} = TCPHandler.start_link(s3)
    │           ~~~~
    │
    └─ test/long_term_robustness_test.exs:62:11: DataDiode.LongTermRobustnessTest."test TCPHandler exhaustive branch coverage"/1

............16:01:27.681 [info] S1: Forwarded 11 bytes.
...16:01:27.693 [warning] S1: Dropping oversized packet (1048577 bytes) from 1.2.3.4
.16:01:27.694 [debug] S1: TCPHandler received unexpected message: :accept_loop
..16:01:27.701 [info] S1: Connection closed by 1.2.3.4:80
.16:01:27.708 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 23 bytes.
.16:01:27.709 [debug] S2: Successfully wrote 23 bytes to ./data_1766120487709_3_51210.dat. (Simulated secure write)
16:01:27.709 [info] S2: Decapsulated packet from 0.0.0.0:0. Payload size: 0 bytes.
16:01:27.709 [debug] S2: Successfully wrote 0 bytes to ./data_1766120487709_4_0.dat. (Simulated secure write)
.16:01:27.718 [error] S2: Failed to parse header: invalid_packet_size
.16:01:27.718 [error] S2: Failed to parse header: invalid_packet_size
.16:01:27.718 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 9 bytes.
.16:01:27.718 [debug] S2: Successfully wrote 9 bytes to ./data_1766120487718_5_80.dat. (Simulated secure write)
16:01:27.718 [error] S2: Failed to parse header: invalid_packet_size
.16:01:27.718 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 23 bytes.
16:01:27.718 [debug] S2: Successfully wrote 23 bytes to ./data_1766120487718_6_51210.dat. (Simulated secure write)
.16:01:27.718 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 0 bytes.
.16:01:27.718 [debug] S2: Successfully wrote 0 bytes to ./data_1766120487718_7_51210.dat. (Simulated secure write)
.....16:01:27.723 [info] S1: Starting TCP Listener on port 8092...
16:01:27.723 [info] S1: New connection accepted.
16:01:27.726 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.37>}
16:01:27.726 [info] S1: New connection accepted.
16:01:27.727 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.44>}
16:01:27.727 [info] S1: New connection accepted.
16:01:27.727 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.45>}
16:01:27.727 [info] S1: New connection accepted.
16:01:27.727 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.46>}
16:01:27.727 [info] S1: New connection accepted.
16:01:27.727 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.47>}
16:01:27.727 [info] S1: New connection accepted.
16:01:27.727 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.48>}
16:01:27.756 [info] S1: New connection accepted.
16:01:27.756 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.49>}
16:01:27.756 [info] S1: New connection accepted.
16:01:27.756 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.51>}
16:01:27.756 [info] S1: New connection accepted.
16:01:27.756 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.53>}
16:01:27.757 [info] S1: New connection accepted.
16:01:27.757 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.55>}
16:01:27.757 [info] S1: New connection accepted.
16:01:27.757 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.57>}
16:01:27.757 [info] S1: New connection accepted.
16:01:27.757 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.59>}
16:01:27.757 [info] S1: New connection accepted.
16:01:27.757 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.61>}
16:01:27.757 [info] S1: New connection accepted.
16:01:27.757 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.63>}
16:01:27.758 [info] S1: New connection accepted.
16:01:27.758 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.65>}
16:01:27.758 [info] S1: New connection accepted.
16:01:27.758 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.67>}
16:01:27.758 [info] S1: New connection accepted.
16:01:27.758 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.69>}
16:01:27.758 [info] S1: New connection accepted.
16:01:27.758 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.71>}
16:01:27.758 [info] S1: New connection accepted.
16:01:27.758 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.73>}
16:01:27.758 [info] S1: New connection accepted.
16:01:27.758 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.75>}
16:01:27.758 [info] S1: New connection accepted.
16:01:27.758 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.77>}
16:01:27.758 [info] S1: New connection accepted.
16:01:27.759 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.79>}
16:01:27.759 [info] S1: New connection accepted.
16:01:27.759 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.81>}
16:01:27.759 [info] S1: New connection accepted.
16:01:27.759 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.83>}
16:01:27.759 [info] S1: New connection accepted.
16:01:27.759 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.85>}
16:01:27.759 [info] S1: New connection accepted.
16:01:27.759 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.87>}
16:01:27.759 [info] S1: New connection accepted.
16:01:27.759 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.89>}
16:01:27.759 [info] S1: New connection accepted.
16:01:27.759 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.91>}
16:01:27.759 [info] S1: New connection accepted.
16:01:27.759 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.93>}
16:01:27.760 [info] S1: New connection accepted.
16:01:27.760 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.95>}
16:01:27.760 [info] S1: New connection accepted.
16:01:27.760 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.97>}
16:01:27.760 [info] S1: New connection accepted.
16:01:27.760 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.99>}
16:01:27.760 [info] S1: New connection accepted.
16:01:27.760 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.101>}
16:01:27.760 [info] S1: New connection accepted.
16:01:27.760 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.103>}
16:01:27.760 [info] S1: New connection accepted.
16:01:27.760 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.105>}
16:01:27.760 [info] S1: New connection accepted.
16:01:27.760 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.107>}
16:01:27.760 [info] S1: New connection accepted.
16:01:27.760 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.109>}
16:01:27.760 [info] S1: New connection accepted.
16:01:27.761 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.111>}
16:01:27.761 [info] S1: New connection accepted.
16:01:27.761 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.113>}
16:01:27.761 [info] S1: New connection accepted.
16:01:27.761 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.115>}
16:01:27.761 [info] S1: New connection accepted.
16:01:27.761 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.117>}
16:01:27.761 [info] S1: New connection accepted.
16:01:27.761 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.119>}
16:01:27.761 [info] S1: New connection accepted.
16:01:27.761 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.121>}
16:01:27.761 [info] S1: New connection accepted.
16:01:27.761 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.123>}
16:01:27.761 [info] S1: New connection accepted.
16:01:27.761 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.125>}
16:01:27.762 [info] S1: New connection accepted.
16:01:27.762 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.127>}
16:01:27.762 [info] S1: New connection accepted.
16:01:27.762 [info] S1: New connection accepted.
16:01:27.762 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.129>}
16:01:27.762 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.131>}
16:01:27.762 [info] S1: New connection accepted.
16:01:27.762 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.133>}
16:01:27.762 [info] S1: New connection accepted.
16:01:27.762 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.135>}
......16:01:28.551 [info] S1: New connection accepted.
16:01:28.551 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.142>}
16:01:28.551 [info] S1: New connection accepted.
16:01:28.551 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.144>}
16:01:28.551 [info] S1: New connection accepted.
16:01:28.552 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.147>}
16:01:28.552 [info] S1: New connection accepted.
16:01:28.552 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.148>}
16:01:28.552 [info] S1: New connection accepted.
16:01:28.552 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.150>}
.16:01:28.802 [debug] S1: TCPHandler received unexpected message: :accept_loop
.16:01:28.803 [error] S2: UDP Listener socket closed unexpectedly. Terminating.
..16:01:28.804 [info] S2: Starting UDP Listener on port 0...
16:01:28.804 [info] S2: Decapsulated packet from 127.0.0.1:1234. Payload size: 12 bytes.
16:01:28.804 [debug] S2: Successfully wrote 12 bytes to ./data_1766120488804_63_1234.dat. (Simulated secure write)
16:01:28.827 [warning] S2: Invalid LISTEN_IP_S2 invalid, falling back to all interfaces.
16:01:28.827 [info] S2: Starting UDP Listener on port 0...
16:01:28.827 [info] S2: Starting UDP Listener on port 0...
16:01:28.828 [info] S2: Decapsulated packet from 1.2.3.4:80. Payload size: 5 bytes.
16:01:28.828 [debug] S2: Successfully wrote 5 bytes to ./data_1766120488828_64_80.dat. (Simulated secure write)


  1) test UDP listener receives packet and delegates to Decapsulator (DataDiode.S2.ListenerTest)
     test/s2_listener_test.exs:116
     ** (Mox.VerificationError) error while verifying mocks for #PID<0.562.0>:

       * expected DataDiode.S2.DecapsulatorMock.process_packet/1 to be invoked once but it was invoked 0 times
     code: verify!()
     stacktrace:
       (mox 1.2.0) lib/mox.ex:862: Mox.__verify_mock_or_all__/2
       test/s2_listener_test.exs:140: (test)

.....16:01:28.840 [info] S2: Starting UDP Listener on port 0...
16:01:28.840 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.840 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488840_65_80.dat. (Simulated secure write)
16:01:28.841 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.841 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488841_66_80.dat. (Simulated secure write)
16:01:28.841 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.841 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488841_67_80.dat. (Simulated secure write)
16:01:28.841 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.841 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488841_68_80.dat. (Simulated secure write)
16:01:28.841 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.841 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488841_69_80.dat. (Simulated secure write)
16:01:28.841 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.841 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488841_70_80.dat. (Simulated secure write)
16:01:28.841 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.841 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488841_71_80.dat. (Simulated secure write)
16:01:28.841 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.841 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488841_72_80.dat. (Simulated secure write)
16:01:28.841 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.841 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488841_73_80.dat. (Simulated secure write)
16:01:28.842 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.842 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488842_74_80.dat. (Simulated secure write)
16:01:28.842 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.842 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488842_75_80.dat. (Simulated secure write)
16:01:28.842 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.842 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488842_76_80.dat. (Simulated secure write)
16:01:28.842 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.842 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488842_77_80.dat. (Simulated secure write)
16:01:28.842 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.842 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488842_78_80.dat. (Simulated secure write)
16:01:28.842 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.842 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488842_79_80.dat. (Simulated secure write)
16:01:28.842 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.842 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488842_80_80.dat. (Simulated secure write)
16:01:28.842 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.842 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488842_81_80.dat. (Simulated secure write)
16:01:28.842 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.842 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488842_82_80.dat. (Simulated secure write)
16:01:28.842 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.842 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488842_83_80.dat. (Simulated secure write)
16:01:28.842 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.842 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488842_84_80.dat. (Simulated secure write)
16:01:28.842 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.842 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488842_85_80.dat. (Simulated secure write)
16:01:28.842 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.842 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488842_86_80.dat. (Simulated secure write)
16:01:28.842 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.842 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488842_87_80.dat. (Simulated secure write)
16:01:28.842 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.842 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488842_88_80.dat. (Simulated secure write)
16:01:28.842 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.842 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488842_89_80.dat. (Simulated secure write)
16:01:28.842 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.842 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488842_90_80.dat. (Simulated secure write)
16:01:28.843 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.843 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488843_91_80.dat. (Simulated secure write)
16:01:28.843 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.843 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488843_92_80.dat. (Simulated secure write)
16:01:28.843 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.843 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488843_93_80.dat. (Simulated secure write)
16:01:28.843 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.843 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488843_94_80.dat. (Simulated secure write)
16:01:28.843 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.843 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488843_95_80.dat. (Simulated secure write)
16:01:28.843 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.843 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488843_96_80.dat. (Simulated secure write)
16:01:28.843 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.843 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488843_97_80.dat. (Simulated secure write)
16:01:28.843 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.843 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488843_98_80.dat. (Simulated secure write)
16:01:28.843 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.843 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488843_99_80.dat. (Simulated secure write)
16:01:28.843 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.843 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488843_100_80.dat. (Simulated secure write)
16:01:28.843 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.843 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488843_101_80.dat. (Simulated secure write)
16:01:28.843 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.843 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488843_102_80.dat. (Simulated secure write)
16:01:28.843 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.843 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488843_103_80.dat. (Simulated secure write)
16:01:28.843 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.843 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488843_104_80.dat. (Simulated secure write)
16:01:28.843 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.843 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488843_105_80.dat. (Simulated secure write)
16:01:28.843 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.843 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488843_106_80.dat. (Simulated secure write)
16:01:28.844 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.844 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488844_107_80.dat. (Simulated secure write)
16:01:28.844 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.844 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488844_108_80.dat. (Simulated secure write)
16:01:28.844 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.844 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488844_109_80.dat. (Simulated secure write)
16:01:28.844 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.844 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488844_110_80.dat. (Simulated secure write)
16:01:28.844 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.844 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488844_111_80.dat. (Simulated secure write)
16:01:28.844 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.844 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488844_112_80.dat. (Simulated secure write)
16:01:28.844 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.844 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488844_113_80.dat. (Simulated secure write)
16:01:28.844 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.844 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488844_114_80.dat. (Simulated secure write)
16:01:28.844 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.844 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488844_115_80.dat. (Simulated secure write)
16:01:28.844 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.844 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488844_116_80.dat. (Simulated secure write)
16:01:28.844 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.844 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488844_117_80.dat. (Simulated secure write)
16:01:28.844 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.844 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488844_118_80.dat. (Simulated secure write)
16:01:28.844 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.844 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488844_119_80.dat. (Simulated secure write)
16:01:28.844 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.844 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488844_120_80.dat. (Simulated secure write)
16:01:28.844 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.844 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488844_121_80.dat. (Simulated secure write)
16:01:28.844 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.845 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488844_122_80.dat. (Simulated secure write)
16:01:28.845 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.845 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488845_123_80.dat. (Simulated secure write)
16:01:28.845 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.845 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488845_124_80.dat. (Simulated secure write)
16:01:28.845 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.845 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488845_125_80.dat. (Simulated secure write)
16:01:28.845 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.845 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488845_126_80.dat. (Simulated secure write)
16:01:28.845 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.845 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488845_127_80.dat. (Simulated secure write)
16:01:28.845 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.845 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488845_128_80.dat. (Simulated secure write)
16:01:28.845 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.845 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488845_129_80.dat. (Simulated secure write)
16:01:28.845 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.845 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488845_130_80.dat. (Simulated secure write)
16:01:28.845 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.845 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488845_131_80.dat. (Simulated secure write)
16:01:28.845 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.845 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488845_132_80.dat. (Simulated secure write)
16:01:28.845 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.845 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488845_133_80.dat. (Simulated secure write)
16:01:28.845 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.845 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488845_134_80.dat. (Simulated secure write)
16:01:28.845 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.845 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488845_135_80.dat. (Simulated secure write)
16:01:28.845 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.845 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488845_136_80.dat. (Simulated secure write)
16:01:28.845 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.845 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.845 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488845_137_80.dat. (Simulated secure write)
16:01:28.846 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.846 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488846_138_80.dat. (Simulated secure write)
16:01:28.846 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.846 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488846_139_80.dat. (Simulated secure write)
16:01:28.846 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.846 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488846_140_80.dat. (Simulated secure write)
16:01:28.846 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.846 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488846_141_80.dat. (Simulated secure write)
16:01:28.846 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.846 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488846_142_80.dat. (Simulated secure write)
16:01:28.846 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.846 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488846_143_80.dat. (Simulated secure write)
16:01:28.846 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.846 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488846_144_80.dat. (Simulated secure write)
16:01:28.846 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.846 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488846_145_80.dat. (Simulated secure write)
16:01:28.846 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.846 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488846_146_80.dat. (Simulated secure write)
16:01:28.846 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.846 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.846 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.846 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488846_147_80.dat. (Simulated secure write)
16:01:28.846 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.846 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488846_148_80.dat. (Simulated secure write)
16:01:28.846 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.846 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488846_149_80.dat. (Simulated secure write)
16:01:28.846 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.846 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488846_150_80.dat. (Simulated secure write)
16:01:28.846 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.846 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488846_151_80.dat. (Simulated secure write)
16:01:28.846 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.846 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488846_152_80.dat. (Simulated secure write)
16:01:28.847 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.847 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488847_153_80.dat. (Simulated secure write)
16:01:28.847 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.847 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488847_154_80.dat. (Simulated secure write)
16:01:28.847 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.847 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488847_155_80.dat. (Simulated secure write)
16:01:28.847 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.847 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488847_156_80.dat. (Simulated secure write)
16:01:28.847 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.847 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488847_157_80.dat. (Simulated secure write)
16:01:28.847 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.847 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488847_158_80.dat. (Simulated secure write)
16:01:28.847 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488847_159_80.dat. (Simulated secure write)
16:01:28.847 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488847_160_80.dat. (Simulated secure write)
16:01:28.847 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488847_161_80.dat. (Simulated secure write)
16:01:28.847 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.847 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.847 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:28.847 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488847_162_80.dat. (Simulated secure write)
16:01:28.847 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488847_163_80.dat. (Simulated secure write)
16:01:28.847 [debug] S2: Successfully wrote 7 bytes to ./data_1766120488847_164_80.dat. (Simulated secure write)
..16:01:28.948 [warning] S1: Invalid LISTEN_IP invalid, using all interfaces.
.16:01:28.949 [info] S1: Starting TCP Listener on port 0...
16:01:29.451 [info] S1: New connection accepted.
..16:01:29.452 [info] S1: Starting TCP Listener on port 0...
.16:01:29.453 [error] S1: Listener socket fatal error: :closed. Terminating.
.16:01:29.454 [info] S1: Starting TCP Listener on port 0...
16:01:29.955 [error] S1: Listener socket fatal error: :closed. Terminating.
16:01:29.955 [error] GenServer :s1_flapping_test_unique terminating
** (stop) :closed
Last message: :accept_loop
State: #Port<0.170>
16:01:29.956 [error] Process :s1_flapping_test_unique (#PID<0.697.0>) terminating
** (exit) :closed
    (stdlib 7.1) gen_server.erl:2562: :gen_server.handle_common_reply/5
    (stdlib 7.1) proc_lib.erl:333: :proc_lib.init_p_do_apply/3
Initial Call: DataDiode.S1.Listener.init/1
Ancestors: [#PID<0.696.0>]
Message Queue Length: 0
Messages: []
Links: []
Dictionary: []
Trapping Exits: false
Status: :running
Heap Size: 1598
Stack Size: 29
Reductions: 2746
......16:01:30.459 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.229.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:30.460 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.710.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:01:30.471 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.710.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:30.471 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.712.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:30.482 [warning] S1 Encapsulator: Invalid IP invalid, dropping packet.
.16:01:30.583 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.712.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:30.584 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.714.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:01:30.594 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.714.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:30.594 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.716.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:01:30.618 [debug] SystemMonitor: Received unexpected message: :unexp
16:01:30.621 [debug] S1: TCPHandler received unexpected message: :unexp
16:01:30.622 [info] S1: Starting TCP Listener on port 0...
16:01:30.622 [debug] S1: Listener received unexpected message: :unexp
16:01:31.558 [info] S2: Starting UDP Listener on port 0...
16:01:31.558 [warning] S2: Received unexpected message: :unexp
16:01:31.558 [error] S2: UDP Listener socket closed unexpectedly. Terminating.
16:01:31.564 [info] DiskCleaner: Low disk space detected on . (< 15%). Starting autonomous cleanup...
16:01:31.564 [warning] DiskCleaner: Simulation - would delete oldest .dat files in . now.
16:01:31.569 [info] S2: Decapsulated packet from 127.0.0.1:20480. Payload size: 7 bytes.
16:01:31.569 [debug] S2: Successfully wrote 7 bytes to /tmp/diode_test/data_1766120491569_167_20480.dat. (Simulated secure write)
16:01:31.569 [info] S2: Decapsulated packet from 127.0.0.1:0. Payload size: 9 bytes.
16:01:31.570 [debug] S1: Generating end-to-end heartbeat.
16:01:31.570 [warning] S1 Heartbeat: Received unexpected message: :unexp
16:01:31.570 [error] S2: Critical Failure! Channel heartbeat missing for > 6 minutes. The diode path may be obstructed.
16:01:31.570 [warning] S2 HeartbeatMonitor: Received unexpected message: :unexp
.
Finished in 3.9 seconds (0.1s async, 3.8s sync)
1 doctest, 65 tests, 1 failure
Run 4 FAILED
Run 5
warning: setting :preferred_cli_env in your mix.exs "def project" is deprecated, set it inside "def cli" instead:

    def cli do
      [preferred_envs: [release: :prod, test: :test]]
    end

  (mix 1.19.4) lib/mix/cli.ex:187: Mix.CLI.preferred_cli_env/3
  (mix 1.19.4) lib/mix/cli.ex:170: Mix.CLI.maybe_change_env_and_target/2
  (mix 1.19.4) lib/mix/cli.ex:59: Mix.CLI.proceed/2
  /opt/homebrew/bin/mix:7: (file)
  (elixir 1.19.4) src/elixir_compiler.erl:81: :elixir_compiler.dispatch/4
  (elixir 1.19.4) src/elixir_compiler.erl:56: :elixir_compiler.compile/4

16:01:32.144 [info] Application logger started at :nonode@nohost
16:01:32.154 [info] Child :ttb_autostart of Supervisor :runtime_tools_sup started
Pid: #PID<0.183.0>
Start Call: :ttb_autostart.start_link()
Restart: :temporary
Shutdown: 3000
Type: :worker
16:01:32.154 [info] Application runtime_tools started at :nonode@nohost
16:01:32.154 [info] Application opentelemetry_api started at :nonode@nohost
16:01:32.154 [info] Application ctx started at :nonode@nohost
16:01:32.155 [info] Application hpack started at :nonode@nohost
16:01:32.155 [info] Application chatterbox started at :nonode@nohost
16:01:32.155 [info] Application acceptor_pool started at :nonode@nohost
16:01:32.161 [info] Child :gproc of Supervisor :gproc_sup started
Pid: #PID<0.187.0>
Start Call: :gproc.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:01:32.162 [info] Child :gproc_monitor of Supervisor :gproc_sup started
Pid: #PID<0.188.0>
Start Call: :gproc_monitor.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:01:32.163 [info] Child :gproc_bcast of Supervisor :gproc_sup started
Pid: #PID<0.189.0>
Start Call: :gproc_bcast.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:01:32.165 [info] Child :gproc_pool of Supervisor :gproc_sup started
Pid: #PID<0.190.0>
Start Call: :gproc_pool.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:01:32.165 [info] Application gproc started at :nonode@nohost
16:01:32.167 [info] Child :grpcbox_services_simple_sup of Supervisor :grpcbox_sup started
Pid: #PID<0.194.0>
Start Call: :grpcbox_services_simple_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:01:32.168 [info] Child :grpcbox_channel_sup of Supervisor :grpcbox_sup started
Pid: #PID<0.195.0>
Start Call: :grpcbox_channel_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:01:32.168 [info] Application grpcbox started at :nonode@nohost
16:01:32.168 [info] Application ssl_verify_fun started at :nonode@nohost
16:01:32.306 [info] Loading 162 CA(s) from :otp store
16:01:32.306 [info] Child :tls_certificate_check_shared_state of Supervisor :tls_certificate_check_sup started
Pid: #PID<0.199.0>
Start Call: :tls_certificate_check_shared_state.start_link()
Restart: :permanent
Shutdown: :infinity
Type: :worker
16:01:32.306 [info] Application tls_certificate_check started at :nonode@nohost
16:01:32.306 [info] Application opentelemetry_exporter started at :nonode@nohost
16:01:32.322 [info] Child :otel_span_ets of Supervisor :otel_span_sup started
Pid: #PID<0.207.0>
Start Call: :otel_span_ets.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:32.324 [info] Child :otel_span_sweeper of Supervisor :otel_span_sup started
Pid: #PID<0.208.0>
Start Call: :otel_span_sweeper.start_link(%{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:32.324 [info] Child :otel_span_sup of Supervisor :opentelemetry_sup started
Pid: #PID<0.206.0>
Start Call: :otel_span_sup.start_link(%{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:01:32.327 [info] Child :otel_resource_detector of Supervisor :opentelemetry_sup started
Pid: #PID<0.209.0>
Start Call: :otel_resource_detector.start_link(%{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:32.329 [info] Child :otel_tracer_provider_sup of Supervisor :opentelemetry_sup started
Pid: #PID<0.212.0>
Start Call: :otel_tracer_provider_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:01:32.333 [info] Child :otel_span_processor_sup of Supervisor #PID<0.213.0> (:otel_tracer_server_sup) started
Pid: #PID<0.214.0>
Start Call: :otel_span_processor_sup.start_link(:otel_span_processor_sup_global)
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:01:32.346 [info] Child :otel_tracer_server of Supervisor #PID<0.213.0> (:otel_tracer_server_sup) started
Pid: #PID<0.215.0>
Start Call: :otel_tracer_server.start_link(:global, :otel_tracer_provider_global, :otel_span_processor_sup_global, {:resource, :undefined, {:attributes, 128, 255, 0, %{"process.executable.name": "erl", "process.runtime.description": "Erlang/OTP 28 erts-16.1.2", "process.runtime.version": "16.1.2", "process.runtime.name": "BEAM", "service.name": "unknown_service:erl", "service.instance.id": 160959352652477415547197556968478166794, "telemetry.sdk.version": "1.6.0", "telemetry.sdk.language": "erlang", "telemetry.sdk.name": "opentelemetry"}}}, %{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:32.354 [debug] Child {:httpc, :"otel_exporter_otlp_<0.216.0>"} of Supervisor :httpc_profile_sup started
Pid: #PID<0.217.0>
Start Call: :httpc_manager.start_link(:"otel_exporter_otlp_<0.216.0>", :only_session_cookies, :inets)
Restart: :permanent
Shutdown: 4000
Type: :worker
16:01:32.358 [info] OTLP exporter successfully initialized
16:01:32.360 [info] Application opentelemetry started at :nonode@nohost
16:01:32.365 [info] Application jason started at :nonode@nohost
16:01:32.366 [info] Application logger_json started at :nonode@nohost
16:01:32.366 [info] Application nimble_ownership started at :nonode@nohost
16:01:32.370 [info] Child Mox of Supervisor Mox.Supervisor started
Pid: #PID<0.221.0>
Start Call: Mox.start_link_ownership()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:32.370 [info] Application mox started at :nonode@nohost
16:01:32.385 [info] Child DataDiode.Metrics of Supervisor DataDiode.Supervisor started
Pid: #PID<0.225.0>
Start Call: DataDiode.Metrics.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:32.385 [info] Child DataDiode.SystemMonitor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.226.0>
Start Call: DataDiode.SystemMonitor.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:32.388 [info] S1: Starting TCP Listener on port 0...
16:01:32.388 [info] Child DataDiode.S1.Listener of Supervisor DataDiode.Supervisor started
Pid: #PID<0.227.0>
Start Call: DataDiode.S1.Listener.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:32.392 [info] Child DataDiode.S1.HandlerSupervisor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.228.0>
Start Call: DataDiode.S1.HandlerSupervisor.start_link()
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:01:32.399 [warning] S1 Encapsulator: Invalid S2_PORT 0, using default 42001
16:01:32.399 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.229.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:32.399 [info] Child DataDiode.S1.Heartbeat of Supervisor DataDiode.Supervisor started
Pid: #PID<0.230.0>
Start Call: DataDiode.S1.Heartbeat.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:32.399 [info] Child DataDiode.S2.HeartbeatMonitor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.231.0>
Start Call: DataDiode.S2.HeartbeatMonitor.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:32.399 [info] Child DataDiode.DiskCleaner of Supervisor DataDiode.Supervisor started
Pid: #PID<0.232.0>
Start Call: DataDiode.DiskCleaner.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:32.401 [info] S2: Starting UDP Listener on port 0...
16:01:32.402 [info] Child DataDiode.S2.Listener of Supervisor DataDiode.Supervisor started
Pid: #PID<0.233.0>
Start Call: DataDiode.S2.Listener.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:32.402 [info] Child DataDiode.S2.TaskSupervisor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.234.0>
Start Call: Task.Supervisor.start_link([name: DataDiode.S2.TaskSupervisor, max_children: 200])
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:01:32.402 [info] Application data_diode started at :nonode@nohost
16:01:32.414 [info] Child ExUnit.Server of Supervisor ExUnit.Supervisor started
Pid: #PID<0.240.0>
Start Call: ExUnit.Server.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:32.414 [info] Child ExUnit.CaptureServer of Supervisor ExUnit.Supervisor started
Pid: #PID<0.241.0>
Start Call: ExUnit.CaptureServer.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:32.414 [info] Application ex_unit started at :nonode@nohost
Running ExUnit with seed: 418079, max_cases: 16

     warning: redefining module DataDiode.S1.EncapsulatorMock (current version defined in memory)
     │
 491 │     Module.create(name, [info | body], Macro.Env.location(__ENV__))
     │     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     │
     └─ deps/mox/lib/mox.ex:491: DataDiode.S1.EncapsulatorMock (module)

    warning: variable "c" is unused (if the variable is not meant to be used, prefix it with an underscore)
    │
 26 │     {:ok, c} = :gen_tcp.connect({127,0,0,1}, port, [:binary, active: false])
    │           ~
    │
    └─ test/long_term_robustness_test.exs:26:11: DataDiode.LongTermRobustnessTest."test TCPHandler exhaustive branch coverage"/1

    warning: variable "pid3" is unused (if the variable is not meant to be used, prefix it with an underscore)
    │
 62 │     {:ok, pid3} = TCPHandler.start_link(s3)
    │           ~~~~
    │
    └─ test/long_term_robustness_test.exs:62:11: DataDiode.LongTermRobustnessTest."test TCPHandler exhaustive branch coverage"/1

.............16:01:32.572 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 9 bytes.
.16:01:32.572 [debug] S2: Successfully wrote 9 bytes to ./data_1766120492572_1_80.dat. (Simulated secure write)
16:01:32.574 [warning] S1: Dropping oversized packet (1048577 bytes) from 1.2.3.4
.16:01:32.574 [debug] S1: TCPHandler received unexpected message: :unknown
.16:01:32.574 [error] S1: TCP error for 1.2.3.4: :econnreset
..16:01:32.575 [info] S1: Forwarded 11 bytes.
16:01:32.575 [error] S2: Failed to parse header: invalid_packet_size
.16:01:32.575 [info] S2: Decapsulated packet from 0.0.0.0:0. Payload size: 0 bytes.
16:01:32.575 [debug] S2: Successfully wrote 0 bytes to ./data_1766120492575_3_0.dat. (Simulated secure write)
.16:01:32.575 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 23 bytes.
16:01:32.575 [debug] S2: Successfully wrote 23 bytes to ./data_1766120492575_4_51210.dat. (Simulated secure write)
.16:01:32.575 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 23 bytes.
.16:01:32.575 [debug] S2: Successfully wrote 23 bytes to ./data_1766120492575_5_51210.dat. (Simulated secure write)
16:01:32.575 [error] S2: Failed to parse header: invalid_packet_size
.16:01:32.576 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 0 bytes.
16:01:32.576 [debug] S2: Successfully wrote 0 bytes to ./data_1766120492576_6_51210.dat. (Simulated secure write)
.16:01:32.576 [error] S2: Failed to parse header: invalid_packet_size
..16:01:32.586 [info] S1: Connection closed by 1.2.3.4:80
...16:01:32.688 [info] S1: Starting TCP Listener on port 8092...
16:01:32.689 [info] S1: New connection accepted.
16:01:32.689 [info] S1: New connection accepted.
16:01:32.690 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.40>}
16:01:32.690 [info] S1: New connection accepted.
16:01:32.690 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.42>}
16:01:32.690 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.45>}
16:01:32.690 [info] S1: New connection accepted.
16:01:32.690 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.47>}
16:01:32.690 [info] S1: New connection accepted.
16:01:32.690 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.48>}
16:01:32.690 [info] S1: New connection accepted.
16:01:32.690 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.50>}
16:01:32.690 [info] S1: New connection accepted.
16:01:32.690 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.52>}
16:01:32.691 [info] S1: New connection accepted.
16:01:32.691 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.54>}
16:01:32.691 [info] S1: New connection accepted.
16:01:32.691 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.56>}
16:01:32.691 [info] S1: New connection accepted.
16:01:32.691 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.58>}
16:01:32.691 [info] S1: New connection accepted.
16:01:32.691 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.60>}
16:01:32.692 [info] S1: New connection accepted.
16:01:32.692 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.62>}
16:01:32.692 [info] S1: New connection accepted.
16:01:32.692 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.64>}
16:01:32.692 [info] S1: New connection accepted.
16:01:32.692 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.66>}
16:01:32.692 [info] S1: New connection accepted.
16:01:32.692 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.68>}
16:01:32.692 [info] S1: New connection accepted.
16:01:32.692 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.70>}
16:01:32.693 [info] S1: New connection accepted.
16:01:32.693 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.72>}
16:01:32.693 [info] S1: New connection accepted.
16:01:32.693 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.74>}
16:01:32.693 [info] S1: New connection accepted.
16:01:32.693 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.76>}
16:01:32.693 [info] S1: New connection accepted.
16:01:32.694 [info] S1: New connection accepted.
16:01:32.694 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.78>}
16:01:32.694 [info] S1: New connection accepted.
16:01:32.694 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.80>}
16:01:32.694 [info] S1: New connection accepted.
16:01:32.694 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.82>}
16:01:32.694 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.84>}
16:01:32.694 [info] S1: New connection accepted.
16:01:32.694 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.86>}
16:01:32.695 [info] S1: New connection accepted.
16:01:32.695 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.88>}
16:01:32.695 [info] S1: New connection accepted.
16:01:32.695 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.90>}
16:01:32.695 [info] S1: New connection accepted.
16:01:32.695 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.92>}
16:01:32.696 [info] S1: New connection accepted.
16:01:32.696 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.94>}
16:01:32.697 [info] S1: New connection accepted.
16:01:32.697 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.96>}
16:01:32.697 [info] S1: New connection accepted.
16:01:32.697 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.98>}
16:01:32.697 [info] S1: New connection accepted.
16:01:32.697 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.100>}
16:01:32.697 [info] S1: New connection accepted.
16:01:32.698 [info] S1: New connection accepted.
16:01:32.698 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.102>}
16:01:32.698 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.104>}
16:01:32.698 [info] S1: New connection accepted.
16:01:32.698 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.106>}
16:01:32.698 [info] S1: New connection accepted.
16:01:32.698 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.108>}
16:01:32.698 [info] S1: New connection accepted.
16:01:32.698 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.110>}
16:01:32.699 [info] S1: New connection accepted.
16:01:32.699 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.112>}
16:01:32.699 [info] S1: New connection accepted.
16:01:32.699 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.114>}
16:01:32.699 [info] S1: New connection accepted.
16:01:32.699 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.116>}
16:01:32.699 [info] S1: New connection accepted.
16:01:32.699 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.118>}
16:01:32.699 [info] S1: New connection accepted.
16:01:32.699 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.120>}
16:01:32.700 [info] S1: New connection accepted.
16:01:32.700 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.122>}
16:01:32.700 [info] S1: New connection accepted.
16:01:32.700 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.124>}
16:01:32.700 [info] S1: New connection accepted.
16:01:32.700 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.126>}
16:01:32.700 [info] S1: New connection accepted.
16:01:32.701 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.128>}
16:01:32.701 [info] S1: New connection accepted.
16:01:32.701 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.130>}
16:01:32.701 [info] S1: New connection accepted.
16:01:32.701 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.132>}
16:01:32.701 [info] S1: New connection accepted.
16:01:32.701 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.134>}
16:01:32.701 [info] S1: New connection accepted.
16:01:32.701 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.136>}
16:01:32.701 [info] S1: New connection accepted.
16:01:32.701 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.138>}
......16:01:33.289 [debug] SystemMonitor: Received unexpected message: :unexp
16:01:33.292 [debug] S1: TCPHandler received unexpected message: :unexp
16:01:33.292 [info] S1: Starting TCP Listener on port 0...
16:01:33.292 [debug] S1: Listener received unexpected message: :unexp
16:01:33.891 [info] S2: Starting UDP Listener on port 0...
16:01:33.891 [warning] S2: Received unexpected message: :unexp
16:01:33.891 [error] S2: UDP Listener socket closed unexpectedly. Terminating.
16:01:33.895 [info] DiskCleaner: Low disk space detected on . (< 15%). Starting autonomous cleanup...
16:01:33.895 [warning] DiskCleaner: Simulation - would delete oldest .dat files in . now.
16:01:33.899 [info] S2: Decapsulated packet from 127.0.0.1:20480. Payload size: 7 bytes.
16:01:33.899 [debug] S2: Successfully wrote 7 bytes to /tmp/diode_test/data_1766120493899_57_20480.dat. (Simulated secure write)
16:01:33.899 [info] S2: Decapsulated packet from 127.0.0.1:0. Payload size: 9 bytes.
16:01:33.900 [debug] S1: Generating end-to-end heartbeat.
16:01:33.900 [warning] S1 Heartbeat: Received unexpected message: :unexp
16:01:33.900 [error] S2: Critical Failure! Channel heartbeat missing for > 6 minutes. The diode path may be obstructed.
16:01:33.900 [warning] S2 HeartbeatMonitor: Received unexpected message: :unexp
.16:01:34.396 [info] S1: New connection accepted.
16:01:34.396 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.149>}
16:01:34.396 [info] S1: New connection accepted.
16:01:34.396 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.151>}
16:01:34.397 [info] S1: New connection accepted.
16:01:34.397 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.153>}
16:01:34.397 [info] S1: New connection accepted.
16:01:34.397 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.156>}
16:01:34.397 [info] S1: New connection accepted.
16:01:34.397 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.157>}
...16:01:34.697 [debug] S1: TCPHandler received unexpected message: :accept_loop
..16:01:34.700 [info] S2: Starting UDP Listener on port 0...
..16:01:34.700 [error] S2: UDP Listener socket closed unexpectedly. Terminating.
.16:01:34.700 [warning] S2: Invalid LISTEN_IP_S2 invalid, falling back to all interfaces.
...16:01:34.701 [info] S2: Starting UDP Listener on port 0...
16:01:34.702 [info] S2: Decapsulated packet from 127.0.0.1:1234. Payload size: 12 bytes.
16:01:34.702 [debug] S2: Successfully wrote 12 bytes to ./data_1766120494702_63_1234.dat. (Simulated secure write)
16:01:34.726 [info] S2: Starting UDP Listener on port 0...
16:01:34.728 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.728 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494728_64_80.dat. (Simulated secure write)
16:01:34.728 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.728 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494728_65_80.dat. (Simulated secure write)
16:01:34.728 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.728 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494728_66_80.dat. (Simulated secure write)
16:01:34.728 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.729 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494729_67_80.dat. (Simulated secure write)
16:01:34.729 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.729 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494729_68_80.dat. (Simulated secure write)
16:01:34.729 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.729 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494729_69_80.dat. (Simulated secure write)
16:01:34.729 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.729 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494729_70_80.dat. (Simulated secure write)
16:01:34.729 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.729 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494729_71_80.dat. (Simulated secure write)
16:01:34.729 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.729 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494729_72_80.dat. (Simulated secure write)
16:01:34.729 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.729 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494729_73_80.dat. (Simulated secure write)
16:01:34.730 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.730 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494730_74_80.dat. (Simulated secure write)
16:01:34.730 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.730 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494730_75_80.dat. (Simulated secure write)
16:01:34.730 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.730 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494730_76_80.dat. (Simulated secure write)
16:01:34.730 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.730 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494730_77_80.dat. (Simulated secure write)
16:01:34.730 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.730 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494730_78_80.dat. (Simulated secure write)
16:01:34.730 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.730 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494730_79_80.dat. (Simulated secure write)
16:01:34.731 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.731 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494731_80_80.dat. (Simulated secure write)
16:01:34.731 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.731 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494731_81_80.dat. (Simulated secure write)
16:01:34.731 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.731 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494731_82_80.dat. (Simulated secure write)
16:01:34.731 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.731 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494731_83_80.dat. (Simulated secure write)
16:01:34.731 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.731 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494731_84_80.dat. (Simulated secure write)
16:01:34.732 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.732 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494732_85_80.dat. (Simulated secure write)
16:01:34.732 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.732 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494732_86_80.dat. (Simulated secure write)
16:01:34.732 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.732 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494732_87_80.dat. (Simulated secure write)
16:01:34.732 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.732 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494732_88_80.dat. (Simulated secure write)
16:01:34.732 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.732 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494732_89_80.dat. (Simulated secure write)


16:01:34.732 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
  1) test UDP listener receives packet and delegates to Decapsulator (DataDiode.S2.ListenerTest)
     test/s2_listener_test.exs:116
     ** (Mox.VerificationError) error while verifying mocks for #PID<0.637.0>:

       * expected DataDiode.S2.DecapsulatorMock.process_packet/1 to be invoked once but it was invoked 0 times
     code: verify!()
     stacktrace:
       (mox 1.2.0) lib/mox.ex:862: Mox.__verify_mock_or_all__/2
       test/s2_listener_test.exs:140: (test)

16:01:34.732 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494732_90_80.dat. (Simulated secure write)
16:01:34.732 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.733 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494733_91_80.dat. (Simulated secure write)
16:01:34.733 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.733 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494733_92_80.dat. (Simulated secure write)
16:01:34.733 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.733 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494733_93_80.dat. (Simulated secure write)
16:01:34.733 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.733 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494733_94_80.dat. (Simulated secure write)
16:01:34.733 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.733 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.733 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494733_95_80.dat. (Simulated secure write)
16:01:34.733 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.733 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494733_96_80.dat. (Simulated secure write)
16:01:34.734 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.734 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494734_97_80.dat. (Simulated secure write)
16:01:34.734 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.734 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494734_98_80.dat. (Simulated secure write)
16:01:34.734 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.734 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494734_99_80.dat. (Simulated secure write)
16:01:34.734 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.734 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494734_100_80.dat. (Simulated secure write)
16:01:34.734 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.734 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494734_101_80.dat. (Simulated secure write)
16:01:34.735 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.735 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494735_102_80.dat. (Simulated secure write)
16:01:34.735 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.735 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494735_103_80.dat. (Simulated secure write)
16:01:34.735 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.735 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494735_104_80.dat. (Simulated secure write)
16:01:34.735 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.735 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494735_105_80.dat. (Simulated secure write)
16:01:34.735 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.735 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494735_106_80.dat. (Simulated secure write)
16:01:34.735 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.735 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494735_107_80.dat. (Simulated secure write)
16:01:34.735 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.735 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494735_108_80.dat. (Simulated secure write)
16:01:34.735 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.735 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.736 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.736 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.736 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.736 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.736 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.737 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.737 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.737 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.737 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.737 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.737 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.737 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494737_109_80.dat. (Simulated secure write)
16:01:34.737 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494737_110_80.dat. (Simulated secure write)
16:01:34.738 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494738_111_80.dat. (Simulated secure write)
16:01:34.738 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494738_112_80.dat. (Simulated secure write)
16:01:34.738 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494738_113_80.dat. (Simulated secure write)
16:01:34.738 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494738_114_80.dat. (Simulated secure write)
16:01:34.738 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.738 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494738_115_80.dat. (Simulated secure write)
16:01:34.738 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.738 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.738 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.738 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.738 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.738 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.738 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.738 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.739 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.739 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.739 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.739 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494739_116_80.dat. (Simulated secure write)
16:01:34.739 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494739_117_80.dat. (Simulated secure write)
16:01:34.739 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494739_118_80.dat. (Simulated secure write)
16:01:34.739 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494739_121_80.dat. (Simulated secure write)
16:01:34.739 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494739_122_80.dat. (Simulated secure write)
16:01:34.739 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494739_124_80.dat. (Simulated secure write)
16:01:34.739 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494739_119_80.dat. (Simulated secure write)
16:01:34.739 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494739_120_80.dat. (Simulated secure write)
16:01:34.739 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494739_126_80.dat. (Simulated secure write)
16:01:34.739 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494739_123_80.dat. (Simulated secure write)
16:01:34.739 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494739_125_80.dat. (Simulated secure write)
16:01:34.739 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494739_128_80.dat. (Simulated secure write)
16:01:34.739 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494739_129_80.dat. (Simulated secure write)
16:01:34.739 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494739_127_80.dat. (Simulated secure write)
16:01:34.739 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.739 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494739_130_80.dat. (Simulated secure write)
16:01:34.739 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.739 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494739_131_80.dat. (Simulated secure write)
16:01:34.739 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.739 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494739_132_80.dat. (Simulated secure write)
16:01:34.739 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.739 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494739_133_80.dat. (Simulated secure write)
16:01:34.740 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.740 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494740_134_80.dat. (Simulated secure write)
16:01:34.740 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.740 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494740_135_80.dat. (Simulated secure write)
16:01:34.740 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.740 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.740 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494740_136_80.dat. (Simulated secure write)
16:01:34.740 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494740_137_80.dat. (Simulated secure write)
16:01:34.740 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.740 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494740_138_80.dat. (Simulated secure write)
16:01:34.740 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.740 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494740_139_80.dat. (Simulated secure write)
16:01:34.740 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494740_140_80.dat. (Simulated secure write)
16:01:34.740 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.740 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494740_141_80.dat. (Simulated secure write)
16:01:34.740 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494740_143_80.dat. (Simulated secure write)
16:01:34.740 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494740_142_80.dat. (Simulated secure write)
16:01:34.740 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494740_144_80.dat. (Simulated secure write)
16:01:34.740 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.741 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.741 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.741 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.741 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.741 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.741 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.741 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494741_145_80.dat. (Simulated secure write)
16:01:34.741 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.742 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.742 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.742 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.742 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.742 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494742_146_80.dat. (Simulated secure write)
16:01:34.742 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494742_147_80.dat. (Simulated secure write)
16:01:34.742 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.742 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494742_148_80.dat. (Simulated secure write)
16:01:34.742 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494742_149_80.dat. (Simulated secure write)
16:01:34.743 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494743_150_80.dat. (Simulated secure write)
16:01:34.743 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494743_151_80.dat. (Simulated secure write)
16:01:34.743 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.743 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494743_152_80.dat. (Simulated secure write)
16:01:34.743 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494743_153_80.dat. (Simulated secure write)
16:01:34.743 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494743_154_80.dat. (Simulated secure write)
16:01:34.743 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494743_155_80.dat. (Simulated secure write)
16:01:34.743 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494743_157_80.dat. (Simulated secure write)
16:01:34.743 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494743_156_80.dat. (Simulated secure write)
16:01:34.743 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.743 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494743_158_80.dat. (Simulated secure write)
16:01:34.743 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494743_159_80.dat. (Simulated secure write)
16:01:34.743 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.743 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.743 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:34.744 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494744_161_80.dat. (Simulated secure write)
16:01:34.744 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494744_160_80.dat. (Simulated secure write)
16:01:34.744 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494744_162_80.dat. (Simulated secure write)
16:01:34.744 [debug] S2: Successfully wrote 7 bytes to ./data_1766120494744_163_80.dat. (Simulated secure write)
.16:01:34.844 [info] S2: Starting UDP Listener on port 0...
16:01:34.845 [info] S2: Decapsulated packet from 1.2.3.4:80. Payload size: 5 bytes.
16:01:34.845 [debug] S2: Successfully wrote 5 bytes to ./data_1766120494845_164_80.dat. (Simulated secure write)
...16:01:34.856 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.229.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:34.856 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.753.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:01:34.866 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.753.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:34.867 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.755.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:01:34.878 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.755.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:34.879 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.757.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:01:34.890 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.757.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:34.890 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.759.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:34.900 [warning] S1 Encapsulator: Invalid IP invalid, dropping packet.
.16:01:35.001 [info] S1: Starting TCP Listener on port 0...
16:01:35.502 [error] S1: Listener socket fatal error: :closed. Terminating.
16:01:35.502 [error] GenServer :s1_flapping_test_unique terminating
** (stop) :closed
Last message: :accept_loop
State: #Port<0.182>
.16:01:35.503 [error] Process :s1_flapping_test_unique (#PID<0.762.0>) terminating
** (exit) :closed
    (stdlib 7.1) gen_server.erl:2562: :gen_server.handle_common_reply/5
    (stdlib 7.1) proc_lib.erl:333: :proc_lib.init_p_do_apply/3
Initial Call: DataDiode.S1.Listener.init/1
Ancestors: [#PID<0.761.0>]
Message Queue Length: 0
Messages: []
Links: []
Dictionary: []
Trapping Exits: false
Status: :running
Heap Size: 1598
Stack Size: 29
Reductions: 2746
.16:01:35.503 [error] S1: Listener socket fatal error: :closed. Terminating.
.16:01:35.503 [info] S1: Starting TCP Listener on port 0...
16:01:36.005 [info] S1: New connection accepted.
.16:01:36.005 [warning] S1: Invalid LISTEN_IP invalid, using all interfaces.
..16:01:36.006 [info] S1: Starting TCP Listener on port 0...
....
Finished in 4.0 seconds (0.1s async, 3.8s sync)
1 doctest, 65 tests, 1 failure
Run 5 FAILED
Run 6
warning: setting :preferred_cli_env in your mix.exs "def project" is deprecated, set it inside "def cli" instead:

    def cli do
      [preferred_envs: [release: :prod, test: :test]]
    end

  (mix 1.19.4) lib/mix/cli.ex:187: Mix.CLI.preferred_cli_env/3
  (mix 1.19.4) lib/mix/cli.ex:170: Mix.CLI.maybe_change_env_and_target/2
  (mix 1.19.4) lib/mix/cli.ex:59: Mix.CLI.proceed/2
  /opt/homebrew/bin/mix:7: (file)
  (elixir 1.19.4) src/elixir_compiler.erl:81: :elixir_compiler.dispatch/4
  (elixir 1.19.4) src/elixir_compiler.erl:56: :elixir_compiler.compile/4

16:01:36.977 [info] Application logger started at :nonode@nohost
16:01:36.982 [info] Child :ttb_autostart of Supervisor :runtime_tools_sup started
Pid: #PID<0.183.0>
Start Call: :ttb_autostart.start_link()
Restart: :temporary
Shutdown: 3000
Type: :worker
16:01:36.982 [info] Application runtime_tools started at :nonode@nohost
16:01:36.983 [info] Application opentelemetry_api started at :nonode@nohost
16:01:36.983 [info] Application ctx started at :nonode@nohost
16:01:36.983 [info] Application hpack started at :nonode@nohost
16:01:36.983 [info] Application chatterbox started at :nonode@nohost
16:01:36.983 [info] Application acceptor_pool started at :nonode@nohost
16:01:36.988 [info] Child :gproc of Supervisor :gproc_sup started
Pid: #PID<0.187.0>
Start Call: :gproc.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:01:36.988 [info] Child :gproc_monitor of Supervisor :gproc_sup started
Pid: #PID<0.188.0>
Start Call: :gproc_monitor.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:01:36.989 [info] Child :gproc_bcast of Supervisor :gproc_sup started
Pid: #PID<0.189.0>
Start Call: :gproc_bcast.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:01:36.991 [info] Child :gproc_pool of Supervisor :gproc_sup started
Pid: #PID<0.190.0>
Start Call: :gproc_pool.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:01:36.991 [info] Application gproc started at :nonode@nohost
16:01:36.992 [info] Child :grpcbox_services_simple_sup of Supervisor :grpcbox_sup started
Pid: #PID<0.194.0>
Start Call: :grpcbox_services_simple_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:01:36.992 [info] Child :grpcbox_channel_sup of Supervisor :grpcbox_sup started
Pid: #PID<0.195.0>
Start Call: :grpcbox_channel_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:01:36.992 [info] Application grpcbox started at :nonode@nohost
16:01:36.992 [info] Application ssl_verify_fun started at :nonode@nohost
16:01:37.052 [info] Loading 162 CA(s) from :otp store
16:01:37.052 [info] Child :tls_certificate_check_shared_state of Supervisor :tls_certificate_check_sup started
Pid: #PID<0.199.0>
Start Call: :tls_certificate_check_shared_state.start_link()
Restart: :permanent
Shutdown: :infinity
Type: :worker
16:01:37.052 [info] Application tls_certificate_check started at :nonode@nohost
16:01:37.052 [info] Application opentelemetry_exporter started at :nonode@nohost
16:01:37.057 [info] Child :otel_span_ets of Supervisor :otel_span_sup started
Pid: #PID<0.207.0>
Start Call: :otel_span_ets.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:37.058 [info] Child :otel_span_sweeper of Supervisor :otel_span_sup started
Pid: #PID<0.208.0>
Start Call: :otel_span_sweeper.start_link(%{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:37.058 [info] Child :otel_span_sup of Supervisor :opentelemetry_sup started
Pid: #PID<0.206.0>
Start Call: :otel_span_sup.start_link(%{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:01:37.060 [info] Child :otel_resource_detector of Supervisor :opentelemetry_sup started
Pid: #PID<0.209.0>
Start Call: :otel_resource_detector.start_link(%{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:37.061 [info] Child :otel_tracer_provider_sup of Supervisor :opentelemetry_sup started
Pid: #PID<0.212.0>
Start Call: :otel_tracer_provider_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:01:37.063 [info] Child :otel_span_processor_sup of Supervisor #PID<0.213.0> (:otel_tracer_server_sup) started
Pid: #PID<0.214.0>
Start Call: :otel_span_processor_sup.start_link(:otel_span_processor_sup_global)
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:01:37.068 [info] Child :otel_tracer_server of Supervisor #PID<0.213.0> (:otel_tracer_server_sup) started
Pid: #PID<0.215.0>
Start Call: :otel_tracer_server.start_link(:global, :otel_tracer_provider_global, :otel_span_processor_sup_global, {:resource, :undefined, {:attributes, 128, 255, 0, %{"process.executable.name": "erl", "process.runtime.description": "Erlang/OTP 28 erts-16.1.2", "process.runtime.version": "16.1.2", "process.runtime.name": "BEAM", "service.name": "unknown_service:erl", "service.instance.id": 140166619820062394960141989813130574891, "telemetry.sdk.version": "1.6.0", "telemetry.sdk.language": "erlang", "telemetry.sdk.name": "opentelemetry"}}}, %{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:37.070 [debug] Child {:httpc, :"otel_exporter_otlp_<0.216.0>"} of Supervisor :httpc_profile_sup started
Pid: #PID<0.217.0>
Start Call: :httpc_manager.start_link(:"otel_exporter_otlp_<0.216.0>", :only_session_cookies, :inets)
Restart: :permanent
Shutdown: 4000
Type: :worker
16:01:37.073 [info] OTLP exporter successfully initialized
16:01:37.074 [info] Application opentelemetry started at :nonode@nohost
16:01:37.074 [info] Application jason started at :nonode@nohost
16:01:37.075 [info] Application logger_json started at :nonode@nohost
16:01:37.075 [info] Application nimble_ownership started at :nonode@nohost
16:01:37.077 [info] Child Mox of Supervisor Mox.Supervisor started
Pid: #PID<0.221.0>
Start Call: Mox.start_link_ownership()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:37.077 [info] Application mox started at :nonode@nohost
16:01:37.081 [info] Child DataDiode.Metrics of Supervisor DataDiode.Supervisor started
Pid: #PID<0.225.0>
Start Call: DataDiode.Metrics.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:37.082 [info] Child DataDiode.SystemMonitor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.226.0>
Start Call: DataDiode.SystemMonitor.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:37.082 [info] S1: Starting TCP Listener on port 0...
16:01:37.082 [info] Child DataDiode.S1.Listener of Supervisor DataDiode.Supervisor started
Pid: #PID<0.227.0>
Start Call: DataDiode.S1.Listener.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:37.084 [info] Child DataDiode.S1.HandlerSupervisor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.228.0>
Start Call: DataDiode.S1.HandlerSupervisor.start_link()
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:01:37.086 [warning] S1 Encapsulator: Invalid S2_PORT 0, using default 42001
16:01:37.086 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.229.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:37.086 [info] Child DataDiode.S1.Heartbeat of Supervisor DataDiode.Supervisor started
Pid: #PID<0.230.0>
Start Call: DataDiode.S1.Heartbeat.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:37.086 [info] Child DataDiode.S2.HeartbeatMonitor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.231.0>
Start Call: DataDiode.S2.HeartbeatMonitor.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:37.086 [info] Child DataDiode.DiskCleaner of Supervisor DataDiode.Supervisor started
Pid: #PID<0.232.0>
Start Call: DataDiode.DiskCleaner.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:37.086 [info] S2: Starting UDP Listener on port 0...
16:01:37.086 [info] Child DataDiode.S2.Listener of Supervisor DataDiode.Supervisor started
Pid: #PID<0.233.0>
Start Call: DataDiode.S2.Listener.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:37.086 [info] Child DataDiode.S2.TaskSupervisor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.234.0>
Start Call: Task.Supervisor.start_link([name: DataDiode.S2.TaskSupervisor, max_children: 200])
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:01:37.086 [info] Application data_diode started at :nonode@nohost
16:01:37.091 [info] Child ExUnit.Server of Supervisor ExUnit.Supervisor started
Pid: #PID<0.240.0>
Start Call: ExUnit.Server.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:37.091 [info] Child ExUnit.CaptureServer of Supervisor ExUnit.Supervisor started
Pid: #PID<0.241.0>
Start Call: ExUnit.CaptureServer.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:37.091 [info] Application ex_unit started at :nonode@nohost
Running ExUnit with seed: 92748, max_cases: 16

    warning: variable "c" is unused (if the variable is not meant to be used, prefix it with an underscore)
    │
 26 │     {:ok, c} = :gen_tcp.connect({127,0,0,1}, port, [:binary, active: false])
    │           ~
    │
    └─ test/long_term_robustness_test.exs:26:11: DataDiode.LongTermRobustnessTest."test TCPHandler exhaustive branch coverage"/1

    warning: variable "pid3" is unused (if the variable is not meant to be used, prefix it with an underscore)
    │
 62 │     {:ok, pid3} = TCPHandler.start_link(s3)
    │           ~~~~
    │
    └─ test/long_term_robustness_test.exs:62:11: DataDiode.LongTermRobustnessTest."test TCPHandler exhaustive branch coverage"/1

..     warning: redefining module DataDiode.S1.EncapsulatorMock (current version defined in memory)
     │
 491 │     Module.create(name, [info | body], Macro.Env.location(__ENV__))
     │     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     │
     └─ deps/mox/lib/mox.ex:491: DataDiode.S1.EncapsulatorMock (module)

.......16:01:37.182 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 23 bytes.
.16:01:37.182 [debug] S2: Successfully wrote 23 bytes to ./data_1766120497182_1_51210.dat. (Simulated secure write)
.16:01:37.182 [info] S2: Decapsulated packet from 0.0.0.0:0. Payload size: 0 bytes.
.16:01:37.182 [debug] S2: Successfully wrote 0 bytes to ./data_1766120497182_2_0.dat. (Simulated secure write)
.16:01:37.182 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 0 bytes.
16:01:37.182 [debug] S2: Successfully wrote 0 bytes to ./data_1766120497182_3_51210.dat. (Simulated secure write)
..16:01:37.184 [error] S2: Failed to parse header: invalid_packet_size
..16:01:37.185 [error] S2: Failed to parse header: invalid_packet_size
16:01:37.185 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 9 bytes.
.16:01:37.185 [debug] S2: Successfully wrote 9 bytes to ./data_1766120497185_4_80.dat. (Simulated secure write)
16:01:37.185 [error] S2: Failed to parse header: invalid_packet_size
.16:01:37.185 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 23 bytes.
16:01:37.185 [debug] S2: Successfully wrote 23 bytes to ./data_1766120497185_5_51210.dat. (Simulated secure write)
.16:01:37.203 [error] S1: TCP error for 1.2.3.4: :econnreset
.16:01:37.203 [debug] S1: TCPHandler received unexpected message: :unknown
.16:01:37.203 [info] S1: Connection closed by 1.2.3.4:80
.16:01:37.209 [info] Child of Supervisor :inet_gethost_native_sup started
Pid: #PID<0.389.0>
Start Call: :inet_gethost_native.init([])
16:01:37.209 [debug] Child :inet_gethost_native_sup of Supervisor :kernel_safe_sup started
Pid: #PID<0.388.0>
Start Call: :inet_gethost_native.start_link()
Restart: :temporary
Shutdown: 1000
Type: :worker
16:01:37.215 [warning] S1: Dropping oversized packet (1048577 bytes) from 1.2.3.4
..16:01:37.215 [debug] S1: TCPHandler received unexpected message: :accept_loop
16:01:37.217 [info] S1: Forwarded 11 bytes.
...16:01:37.229 [info] S1: Starting TCP Listener on port 8092...
16:01:37.229 [info] S1: New connection accepted.
16:01:37.233 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.37>}
16:01:37.233 [info] S1: New connection accepted.
16:01:37.233 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.44>}
16:01:37.233 [info] S1: New connection accepted.
16:01:37.233 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.45>}
16:01:37.233 [info] S1: New connection accepted.
16:01:37.233 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.46>}
16:01:37.233 [info] S1: New connection accepted.
16:01:37.233 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.47>}
16:01:37.233 [info] S1: New connection accepted.
16:01:37.233 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.48>}
16:01:37.280 [info] S1: New connection accepted.
16:01:37.280 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.49>}
16:01:37.280 [info] S1: New connection accepted.
16:01:37.280 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.51>}
16:01:37.280 [info] S1: New connection accepted.
16:01:37.281 [info] S1: New connection accepted.
16:01:37.281 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.53>}
16:01:37.281 [info] S1: New connection accepted.
16:01:37.281 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.55>}
16:01:37.281 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.57>}
16:01:37.281 [info] S1: New connection accepted.
16:01:37.281 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.59>}
16:01:37.281 [info] S1: New connection accepted.
16:01:37.281 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.61>}
16:01:37.281 [info] S1: New connection accepted.
16:01:37.281 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.63>}
16:01:37.281 [info] S1: New connection accepted.
16:01:37.282 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.65>}
16:01:37.282 [info] S1: New connection accepted.
16:01:37.282 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.67>}
16:01:37.282 [info] S1: New connection accepted.
16:01:37.282 [info] S1: New connection accepted.
16:01:37.282 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.69>}
16:01:37.282 [info] S1: New connection accepted.
16:01:37.282 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.71>}
16:01:37.282 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.73>}
16:01:37.282 [info] S1: New connection accepted.
16:01:37.282 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.75>}
16:01:37.282 [info] S1: New connection accepted.
16:01:37.282 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.77>}
16:01:37.282 [info] S1: New connection accepted.
16:01:37.283 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.79>}
16:01:37.283 [info] S1: New connection accepted.
16:01:37.283 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.81>}
16:01:37.283 [info] S1: New connection accepted.
16:01:37.283 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.83>}
16:01:37.283 [info] S1: New connection accepted.
16:01:37.283 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.85>}
16:01:37.283 [info] S1: New connection accepted.
16:01:37.283 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.87>}
16:01:37.283 [info] S1: New connection accepted.
16:01:37.283 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.89>}
16:01:37.283 [info] S1: New connection accepted.
16:01:37.283 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.91>}
16:01:37.284 [info] S1: New connection accepted.
16:01:37.284 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.93>}
16:01:37.284 [info] S1: New connection accepted.
16:01:37.284 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.95>}
16:01:37.284 [info] S1: New connection accepted.
16:01:37.284 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.97>}
16:01:37.284 [info] S1: New connection accepted.
16:01:37.284 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.99>}
16:01:37.284 [info] S1: New connection accepted.
16:01:37.284 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.101>}
16:01:37.284 [info] S1: New connection accepted.
16:01:37.284 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.103>}
16:01:37.284 [info] S1: New connection accepted.
16:01:37.284 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.105>}
16:01:37.285 [info] S1: New connection accepted.
16:01:37.285 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.107>}
16:01:37.285 [info] S1: New connection accepted.
16:01:37.285 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.109>}
16:01:37.285 [info] S1: New connection accepted.
16:01:37.285 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.111>}
16:01:37.285 [info] S1: New connection accepted.
16:01:37.285 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.113>}
16:01:37.285 [info] S1: New connection accepted.
16:01:37.285 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.115>}
16:01:37.285 [info] S1: New connection accepted.
16:01:37.285 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.117>}
16:01:37.285 [info] S1: New connection accepted.
16:01:37.285 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.119>}
16:01:37.285 [info] S1: New connection accepted.
16:01:37.285 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.121>}
16:01:37.286 [info] S1: New connection accepted.
16:01:37.286 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.123>}
16:01:37.286 [info] S1: New connection accepted.
16:01:37.286 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.125>}
16:01:37.286 [info] S1: New connection accepted.
16:01:37.286 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.127>}
16:01:37.286 [info] S1: New connection accepted.
16:01:37.286 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.129>}
16:01:37.286 [info] S1: New connection accepted.
16:01:37.286 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.131>}
16:01:37.286 [info] S1: New connection accepted.
16:01:37.286 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.133>}
16:01:37.286 [info] S1: New connection accepted.
16:01:37.287 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.135>}
..16:01:37.840 [error] S2: UDP Listener socket closed unexpectedly. Terminating.
..16:01:37.841 [info] S2: Starting UDP Listener on port 0...
16:01:37.841 [info] S2: Decapsulated packet from 127.0.0.1:1234. Payload size: 12 bytes.
16:01:37.841 [debug] S2: Successfully wrote 12 bytes to ./data_1766120497841_57_1234.dat. (Simulated secure write)
16:01:37.867 [info] S2: Starting UDP Listener on port 0...
16:01:37.867 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.867 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497867_58_80.dat. (Simulated secure write)
16:01:37.868 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.868 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497868_59_80.dat. (Simulated secure write)
16:01:37.868 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.868 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497868_60_80.dat. (Simulated secure write)
16:01:37.868 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.868 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497868_61_80.dat. (Simulated secure write)
16:01:37.868 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.868 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497868_62_80.dat. (Simulated secure write)
16:01:37.869 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.869 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497869_63_80.dat. (Simulated secure write)
16:01:37.869 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.869 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497869_64_80.dat. (Simulated secure write)
16:01:37.869 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.869 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.869 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497869_65_80.dat. (Simulated secure write)
16:01:37.869 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497869_66_80.dat. (Simulated secure write)
16:01:37.869 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.869 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497869_67_80.dat. (Simulated secure write)
16:01:37.869 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.869 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497869_68_80.dat. (Simulated secure write)
16:01:37.869 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.869 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497869_69_80.dat. (Simulated secure write)
16:01:37.870 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.870 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497870_70_80.dat. (Simulated secure write)
16:01:37.870 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.870 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497870_71_80.dat. (Simulated secure write)
16:01:37.870 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.870 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497870_72_80.dat. (Simulated secure write)
16:01:37.870 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.870 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497870_73_80.dat. (Simulated secure write)
16:01:37.870 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.870 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497870_74_80.dat. (Simulated secure write)
16:01:37.870 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.870 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497870_75_80.dat. (Simulated secure write)
16:01:37.870 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.870 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497870_76_80.dat. (Simulated secure write)
16:01:37.870 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.870 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497870_77_80.dat. (Simulated secure write)
16:01:37.871 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.871 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497871_78_80.dat. (Simulated secure write)
16:01:37.871 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.871 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497871_79_80.dat. (Simulated secure write)
16:01:37.871 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.871 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497871_80_80.dat. (Simulated secure write)
16:01:37.871 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.871 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497871_81_80.dat. (Simulated secure write)
16:01:37.871 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.871 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497871_82_80.dat. (Simulated secure write)
16:01:37.871 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.871 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497871_83_80.dat. (Simulated secure write)
16:01:37.872 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.872 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497872_84_80.dat. (Simulated secure write)
16:01:37.872 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.872 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497872_85_80.dat. (Simulated secure write)
16:01:37.872 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.872 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497872_86_80.dat. (Simulated secure write)
16:01:37.872 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.872 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497872_87_80.dat. (Simulated secure write)
16:01:37.872 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.872 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497872_88_80.dat. (Simulated secure write)
16:01:37.872 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.872 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497872_89_80.dat. (Simulated secure write)
16:01:37.872 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.873 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497873_90_80.dat. (Simulated secure write)


16:01:37.873 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
  1) test UDP listener receives packet and delegates to Decapsulator (DataDiode.S2.ListenerTest)
     test/s2_listener_test.exs:116
     ** (Mox.VerificationError) error while verifying mocks for #PID<0.458.0>:

       * expected DataDiode.S2.DecapsulatorMock.process_packet/1 to be invoked once but it was invoked 0 times
     code: verify!()
     stacktrace:
       (mox 1.2.0) lib/mox.ex:862: Mox.__verify_mock_or_all__/2
       test/s2_listener_test.exs:140: (test)

16:01:37.873 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497873_91_80.dat. (Simulated secure write)
16:01:37.873 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.873 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497873_92_80.dat. (Simulated secure write)
16:01:37.873 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.873 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497873_93_80.dat. (Simulated secure write)
16:01:37.873 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.873 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497873_94_80.dat. (Simulated secure write)
16:01:37.873 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.873 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497873_95_80.dat. (Simulated secure write)
16:01:37.873 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.874 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497874_96_80.dat. (Simulated secure write)
16:01:37.874 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.874 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497874_97_80.dat. (Simulated secure write)
16:01:37.874 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.874 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497874_98_80.dat. (Simulated secure write)
16:01:37.874 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.874 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497874_99_80.dat. (Simulated secure write)
16:01:37.874 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.874 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.874 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497874_100_80.dat. (Simulated secure write)
16:01:37.874 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497874_101_80.dat. (Simulated secure write)
16:01:37.874 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.874 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497874_102_80.dat. (Simulated secure write)
16:01:37.874 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.874 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497874_103_80.dat. (Simulated secure write)
16:01:37.874 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.874 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497874_104_80.dat. (Simulated secure write)
16:01:37.874 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.875 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497874_105_80.dat. (Simulated secure write)
16:01:37.875 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.875 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497875_106_80.dat. (Simulated secure write)
16:01:37.875 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.875 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497875_107_80.dat. (Simulated secure write)
16:01:37.875 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.875 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497875_108_80.dat. (Simulated secure write)
16:01:37.875 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.875 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497875_109_80.dat. (Simulated secure write)
16:01:37.875 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.875 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497875_110_80.dat. (Simulated secure write)
16:01:37.875 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.875 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497875_111_80.dat. (Simulated secure write)
16:01:37.875 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.875 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497875_112_80.dat. (Simulated secure write)
16:01:37.876 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.876 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497876_113_80.dat. (Simulated secure write)
16:01:37.876 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.876 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497876_114_80.dat. (Simulated secure write)
16:01:37.876 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.876 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497876_115_80.dat. (Simulated secure write)
16:01:37.876 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.876 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497876_116_80.dat. (Simulated secure write)
16:01:37.876 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.876 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497876_117_80.dat. (Simulated secure write)
16:01:37.876 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.876 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497876_118_80.dat. (Simulated secure write)
16:01:37.876 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.876 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497876_119_80.dat. (Simulated secure write)
16:01:37.876 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.876 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497876_120_80.dat. (Simulated secure write)
16:01:37.877 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.877 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497877_121_80.dat. (Simulated secure write)
16:01:37.877 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.877 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497877_122_80.dat. (Simulated secure write)
16:01:37.877 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.877 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497877_123_80.dat. (Simulated secure write)
16:01:37.877 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.877 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497877_124_80.dat. (Simulated secure write)
16:01:37.877 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.877 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497877_125_80.dat. (Simulated secure write)
16:01:37.877 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.877 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497877_126_80.dat. (Simulated secure write)
16:01:37.877 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.877 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497877_127_80.dat. (Simulated secure write)
16:01:37.877 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.877 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497877_128_80.dat. (Simulated secure write)
16:01:37.877 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.877 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497877_129_80.dat. (Simulated secure write)
16:01:37.878 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.878 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497878_130_80.dat. (Simulated secure write)
16:01:37.878 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.878 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497878_131_80.dat. (Simulated secure write)
16:01:37.878 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.878 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497878_132_80.dat. (Simulated secure write)
16:01:37.878 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.878 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497878_133_80.dat. (Simulated secure write)
16:01:37.878 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.878 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497878_134_80.dat. (Simulated secure write)
16:01:37.878 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.878 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497878_135_80.dat. (Simulated secure write)
16:01:37.878 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.878 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497878_136_80.dat. (Simulated secure write)
16:01:37.878 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.878 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497878_137_80.dat. (Simulated secure write)
16:01:37.878 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.879 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.879 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497879_139_80.dat. (Simulated secure write)
16:01:37.879 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497879_138_80.dat. (Simulated secure write)
16:01:37.879 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.879 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497879_140_80.dat. (Simulated secure write)
16:01:37.879 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.879 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497879_141_80.dat. (Simulated secure write)
16:01:37.879 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.879 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497879_142_80.dat. (Simulated secure write)
16:01:37.879 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.879 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497879_143_80.dat. (Simulated secure write)
16:01:37.879 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.879 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497879_144_80.dat. (Simulated secure write)
16:01:37.879 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.879 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.879 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497879_145_80.dat. (Simulated secure write)
16:01:37.879 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497879_146_80.dat. (Simulated secure write)
16:01:37.879 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.879 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497879_147_80.dat. (Simulated secure write)
16:01:37.880 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.880 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497880_148_80.dat. (Simulated secure write)
16:01:37.880 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.880 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497880_149_80.dat. (Simulated secure write)
16:01:37.880 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.880 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497880_150_80.dat. (Simulated secure write)
16:01:37.880 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.880 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497880_151_80.dat. (Simulated secure write)
16:01:37.880 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.880 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497880_152_80.dat. (Simulated secure write)
16:01:37.880 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.880 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497880_153_80.dat. (Simulated secure write)
16:01:37.880 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.880 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497880_154_80.dat. (Simulated secure write)
16:01:37.880 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.880 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497880_155_80.dat. (Simulated secure write)
16:01:37.880 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.881 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:37.881 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497881_156_80.dat. (Simulated secure write)
16:01:37.881 [debug] S2: Successfully wrote 7 bytes to ./data_1766120497881_157_80.dat. (Simulated secure write)
.16:01:37.981 [info] S2: Starting UDP Listener on port 0...
16:01:37.981 [info] S2: Decapsulated packet from 1.2.3.4:80. Payload size: 5 bytes.
16:01:37.981 [debug] S2: Successfully wrote 5 bytes to ./data_1766120497981_158_80.dat. (Simulated secure write)
..16:01:37.992 [info] S2: Starting UDP Listener on port 0...
.16:01:37.992 [warning] S2: Invalid LISTEN_IP_S2 invalid, falling back to all interfaces.
..16:01:37.992 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.229.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:37.992 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.579.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:01:38.003 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.579.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:38.003 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.581.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:01:38.014 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.581.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:38.014 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.583.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:38.025 [warning] S1 Encapsulator: Invalid IP invalid, dropping packet.
.16:01:38.126 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.583.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:38.126 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.585.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
......16:01:38.140 [warning] S1: Invalid LISTEN_IP invalid, using all interfaces.
.16:01:38.140 [info] S1: Starting TCP Listener on port 0...
16:01:38.641 [info] S1: New connection accepted.
.....16:01:39.143 [error] S1: Listener socket fatal error: :closed. Terminating.
.16:01:39.144 [info] S1: Starting TCP Listener on port 0...
16:01:39.645 [error] S1: Listener socket fatal error: :closed. Terminating.
16:01:39.645 [error] GenServer :s1_flapping_test_unique terminating
** (stop) :closed
Last message: :accept_loop
State: #Port<0.159>
16:01:39.645 [error] Process :s1_flapping_test_unique (#PID<0.610.0>) terminating
** (exit) :closed
    (stdlib 7.1) gen_server.erl:2562: :gen_server.handle_common_reply/5
    (stdlib 7.1) proc_lib.erl:333: :proc_lib.init_p_do_apply/3
Initial Call: DataDiode.S1.Listener.init/1
Ancestors: [#PID<0.609.0>]
Message Queue Length: 0
Messages: []
Links: []
Dictionary: []
Trapping Exits: false
Status: :running
Heap Size: 1598
Stack Size: 29
Reductions: 2746
.16:01:39.646 [info] S1: Starting TCP Listener on port 0...
....16:01:40.091 [info] S1: New connection accepted.
16:01:40.091 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.163>}
16:01:40.091 [info] S1: New connection accepted.
16:01:40.091 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.166>}
16:01:40.091 [info] S1: New connection accepted.
16:01:40.091 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.168>}
16:01:40.091 [info] S1: New connection accepted.
16:01:40.092 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.170>}
16:01:40.092 [info] S1: New connection accepted.
16:01:40.092 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.171>}
..16:01:40.344 [debug] S1: TCPHandler received unexpected message: :accept_loop
...16:01:40.360 [debug] SystemMonitor: Received unexpected message: :unexp
16:01:40.365 [debug] S1: TCPHandler received unexpected message: :unexp
16:01:40.365 [info] S1: Starting TCP Listener on port 0...
16:01:40.365 [debug] S1: Listener received unexpected message: :unexp
16:01:41.094 [info] S2: Starting UDP Listener on port 0...
16:01:41.094 [warning] S2: Received unexpected message: :unexp
16:01:41.094 [error] S2: UDP Listener socket closed unexpectedly. Terminating.
16:01:41.098 [info] DiskCleaner: Low disk space detected on . (< 15%). Starting autonomous cleanup...
16:01:41.098 [warning] DiskCleaner: Simulation - would delete oldest .dat files in . now.
16:01:41.100 [info] S2: Decapsulated packet from 127.0.0.1:20480. Payload size: 7 bytes.
16:01:41.100 [debug] S2: Successfully wrote 7 bytes to /tmp/diode_test/data_1766120501100_165_20480.dat. (Simulated secure write)
16:01:41.100 [info] S2: Decapsulated packet from 127.0.0.1:0. Payload size: 9 bytes.
16:01:41.101 [debug] S1: Generating end-to-end heartbeat.
16:01:41.101 [warning] S1 Heartbeat: Received unexpected message: :unexp
16:01:41.101 [error] S2: Critical Failure! Channel heartbeat missing for > 6 minutes. The diode path may be obstructed.
16:01:41.101 [warning] S2 HeartbeatMonitor: Received unexpected message: :unexp
.
Finished in 3.9 seconds (0.1s async, 3.8s sync)
1 doctest, 65 tests, 1 failure
Run 6 FAILED
Run 7
warning: setting :preferred_cli_env in your mix.exs "def project" is deprecated, set it inside "def cli" instead:

    def cli do
      [preferred_envs: [release: :prod, test: :test]]
    end

  (mix 1.19.4) lib/mix/cli.ex:187: Mix.CLI.preferred_cli_env/3
  (mix 1.19.4) lib/mix/cli.ex:170: Mix.CLI.maybe_change_env_and_target/2
  (mix 1.19.4) lib/mix/cli.ex:59: Mix.CLI.proceed/2
  /opt/homebrew/bin/mix:7: (file)
  (elixir 1.19.4) src/elixir_compiler.erl:81: :elixir_compiler.dispatch/4
  (elixir 1.19.4) src/elixir_compiler.erl:56: :elixir_compiler.compile/4

16:01:41.551 [info] Application logger started at :nonode@nohost
16:01:41.556 [info] Child :ttb_autostart of Supervisor :runtime_tools_sup started
Pid: #PID<0.183.0>
Start Call: :ttb_autostart.start_link()
Restart: :temporary
Shutdown: 3000
Type: :worker
16:01:41.556 [info] Application runtime_tools started at :nonode@nohost
16:01:41.556 [info] Application opentelemetry_api started at :nonode@nohost
16:01:41.556 [info] Application ctx started at :nonode@nohost
16:01:41.556 [info] Application hpack started at :nonode@nohost
16:01:41.556 [info] Application chatterbox started at :nonode@nohost
16:01:41.556 [info] Application acceptor_pool started at :nonode@nohost
16:01:41.561 [info] Child :gproc of Supervisor :gproc_sup started
Pid: #PID<0.187.0>
Start Call: :gproc.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:01:41.562 [info] Child :gproc_monitor of Supervisor :gproc_sup started
Pid: #PID<0.188.0>
Start Call: :gproc_monitor.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:01:41.563 [info] Child :gproc_bcast of Supervisor :gproc_sup started
Pid: #PID<0.189.0>
Start Call: :gproc_bcast.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:01:41.564 [info] Child :gproc_pool of Supervisor :gproc_sup started
Pid: #PID<0.190.0>
Start Call: :gproc_pool.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:01:41.564 [info] Application gproc started at :nonode@nohost
16:01:41.565 [info] Child :grpcbox_services_simple_sup of Supervisor :grpcbox_sup started
Pid: #PID<0.194.0>
Start Call: :grpcbox_services_simple_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:01:41.566 [info] Child :grpcbox_channel_sup of Supervisor :grpcbox_sup started
Pid: #PID<0.195.0>
Start Call: :grpcbox_channel_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:01:41.566 [info] Application grpcbox started at :nonode@nohost
16:01:41.566 [info] Application ssl_verify_fun started at :nonode@nohost
16:01:41.629 [info] Loading 162 CA(s) from :otp store
16:01:41.630 [info] Child :tls_certificate_check_shared_state of Supervisor :tls_certificate_check_sup started
Pid: #PID<0.199.0>
Start Call: :tls_certificate_check_shared_state.start_link()
Restart: :permanent
Shutdown: :infinity
Type: :worker
16:01:41.630 [info] Application tls_certificate_check started at :nonode@nohost
16:01:41.630 [info] Application opentelemetry_exporter started at :nonode@nohost
16:01:41.636 [info] Child :otel_span_ets of Supervisor :otel_span_sup started
Pid: #PID<0.207.0>
Start Call: :otel_span_ets.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:41.636 [info] Child :otel_span_sweeper of Supervisor :otel_span_sup started
Pid: #PID<0.208.0>
Start Call: :otel_span_sweeper.start_link(%{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:41.636 [info] Child :otel_span_sup of Supervisor :opentelemetry_sup started
Pid: #PID<0.206.0>
Start Call: :otel_span_sup.start_link(%{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:01:41.639 [info] Child :otel_resource_detector of Supervisor :opentelemetry_sup started
Pid: #PID<0.209.0>
Start Call: :otel_resource_detector.start_link(%{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:41.640 [info] Child :otel_tracer_provider_sup of Supervisor :opentelemetry_sup started
Pid: #PID<0.212.0>
Start Call: :otel_tracer_provider_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:01:41.642 [info] Child :otel_span_processor_sup of Supervisor #PID<0.213.0> (:otel_tracer_server_sup) started
Pid: #PID<0.214.0>
Start Call: :otel_span_processor_sup.start_link(:otel_span_processor_sup_global)
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:01:41.648 [info] Child :otel_tracer_server of Supervisor #PID<0.213.0> (:otel_tracer_server_sup) started
Pid: #PID<0.215.0>
Start Call: :otel_tracer_server.start_link(:global, :otel_tracer_provider_global, :otel_span_processor_sup_global, {:resource, :undefined, {:attributes, 128, 255, 0, %{"process.executable.name": "erl", "process.runtime.description": "Erlang/OTP 28 erts-16.1.2", "process.runtime.version": "16.1.2", "process.runtime.name": "BEAM", "service.name": "unknown_service:erl", "service.instance.id": 272085425351883703113638288148591109680, "telemetry.sdk.version": "1.6.0", "telemetry.sdk.language": "erlang", "telemetry.sdk.name": "opentelemetry"}}}, %{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:41.650 [debug] Child {:httpc, :"otel_exporter_otlp_<0.216.0>"} of Supervisor :httpc_profile_sup started
Pid: #PID<0.217.0>
Start Call: :httpc_manager.start_link(:"otel_exporter_otlp_<0.216.0>", :only_session_cookies, :inets)
Restart: :permanent
Shutdown: 4000
Type: :worker
16:01:41.653 [info] OTLP exporter successfully initialized
16:01:41.654 [info] Application opentelemetry started at :nonode@nohost
16:01:41.655 [info] Application jason started at :nonode@nohost
16:01:41.655 [info] Application logger_json started at :nonode@nohost
16:01:41.655 [info] Application nimble_ownership started at :nonode@nohost
16:01:41.657 [info] Child Mox of Supervisor Mox.Supervisor started
Pid: #PID<0.221.0>
Start Call: Mox.start_link_ownership()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:41.658 [info] Application mox started at :nonode@nohost
16:01:41.662 [info] Child DataDiode.Metrics of Supervisor DataDiode.Supervisor started
Pid: #PID<0.225.0>
Start Call: DataDiode.Metrics.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:41.662 [info] Child DataDiode.SystemMonitor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.226.0>
Start Call: DataDiode.SystemMonitor.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:41.663 [info] S1: Starting TCP Listener on port 0...
16:01:41.663 [info] Child DataDiode.S1.Listener of Supervisor DataDiode.Supervisor started
Pid: #PID<0.227.0>
Start Call: DataDiode.S1.Listener.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:41.665 [info] Child DataDiode.S1.HandlerSupervisor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.228.0>
Start Call: DataDiode.S1.HandlerSupervisor.start_link()
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:01:41.667 [warning] S1 Encapsulator: Invalid S2_PORT 0, using default 42001
16:01:41.667 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.229.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:41.667 [info] Child DataDiode.S1.Heartbeat of Supervisor DataDiode.Supervisor started
Pid: #PID<0.230.0>
Start Call: DataDiode.S1.Heartbeat.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:41.667 [info] Child DataDiode.S2.HeartbeatMonitor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.231.0>
Start Call: DataDiode.S2.HeartbeatMonitor.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:41.667 [info] Child DataDiode.DiskCleaner of Supervisor DataDiode.Supervisor started
Pid: #PID<0.232.0>
Start Call: DataDiode.DiskCleaner.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:41.667 [info] S2: Starting UDP Listener on port 0...
16:01:41.667 [info] Child DataDiode.S2.Listener of Supervisor DataDiode.Supervisor started
Pid: #PID<0.233.0>
Start Call: DataDiode.S2.Listener.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:41.667 [info] Child DataDiode.S2.TaskSupervisor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.234.0>
Start Call: Task.Supervisor.start_link([name: DataDiode.S2.TaskSupervisor, max_children: 200])
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:01:41.667 [info] Application data_diode started at :nonode@nohost
16:01:41.672 [info] Child ExUnit.Server of Supervisor ExUnit.Supervisor started
Pid: #PID<0.240.0>
Start Call: ExUnit.Server.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:41.672 [info] Child ExUnit.CaptureServer of Supervisor ExUnit.Supervisor started
Pid: #PID<0.241.0>
Start Call: ExUnit.CaptureServer.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:41.672 [info] Application ex_unit started at :nonode@nohost
Running ExUnit with seed: 673920, max_cases: 16

    warning: variable "c" is unused (if the variable is not meant to be used, prefix it with an underscore)
    │
 26 │     {:ok, c} = :gen_tcp.connect({127,0,0,1}, port, [:binary, active: false])
    │           ~
    │
    └─ test/long_term_robustness_test.exs:26:11: DataDiode.LongTermRobustnessTest."test TCPHandler exhaustive branch coverage"/1

    warning: variable "pid3" is unused (if the variable is not meant to be used, prefix it with an underscore)
    │
 62 │     {:ok, pid3} = TCPHandler.start_link(s3)
    │           ~~~~
    │
    └─ test/long_term_robustness_test.exs:62:11: DataDiode.LongTermRobustnessTest."test TCPHandler exhaustive branch coverage"/1

.....     warning: redefining module DataDiode.S1.EncapsulatorMock (current version defined in memory)
     │
 491 │     Module.create(name, [info | body], Macro.Env.location(__ENV__))
     │     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     │
     └─ deps/mox/lib/mox.ex:491: DataDiode.S1.EncapsulatorMock (module)

.......16:01:41.762 [error] S2: Failed to parse header: invalid_packet_size
.16:01:41.763 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 23 bytes.
.16:01:41.763 [debug] S2: Successfully wrote 23 bytes to ./data_1766120501763_1_51210.dat. (Simulated secure write)
.16:01:41.763 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 0 bytes.
16:01:41.763 [debug] S2: Successfully wrote 0 bytes to ./data_1766120501763_2_51210.dat. (Simulated secure write)
16:01:41.763 [error] S2: Failed to parse header: invalid_packet_size
.16:01:41.763 [error] S2: Failed to parse header: invalid_packet_size
.16:01:41.763 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 23 bytes.
.16:01:41.763 [debug] S2: Successfully wrote 23 bytes to ./data_1766120501763_3_51210.dat. (Simulated secure write)
16:01:41.763 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 9 bytes.
16:01:41.763 [debug] S2: Successfully wrote 9 bytes to ./data_1766120501763_4_80.dat. (Simulated secure write)
.16:01:41.764 [info] S2: Decapsulated packet from 0.0.0.0:0. Payload size: 0 bytes.
.16:01:41.764 [debug] S2: Successfully wrote 0 bytes to ./data_1766120501764_5_0.dat. (Simulated secure write)
16:01:41.788 [info] Child of Supervisor :inet_gethost_native_sup started
Pid: #PID<0.383.0>
Start Call: :inet_gethost_native.init([])
16:01:41.788 [debug] Child :inet_gethost_native_sup of Supervisor :kernel_safe_sup started
Pid: #PID<0.382.0>
Start Call: :inet_gethost_native.start_link()
Restart: :temporary
Shutdown: 1000
Type: :worker
16:01:41.793 [info] S1: Forwarded 11 bytes.
..16:01:41.805 [info] S1: Connection closed by 1.2.3.4:80
.16:01:41.805 [warning] S1: Dropping oversized packet (1048577 bytes) from 1.2.3.4
.16:01:41.805 [error] S1: TCP error for 1.2.3.4: :econnreset
.16:01:41.806 [debug] S1: TCPHandler received unexpected message: :accept_loop
.16:01:41.806 [debug] S1: TCPHandler received unexpected message: :unknown
...16:01:41.806 [info] S1: Starting TCP Listener on port 8092...
16:01:41.806 [info] S1: New connection accepted.
16:01:41.807 [info] S1: New connection accepted.
16:01:41.810 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.37>}
16:01:41.810 [info] S1: New connection accepted.
16:01:41.810 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.39>}
16:01:41.810 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.46>}
16:01:41.810 [info] S1: New connection accepted.
16:01:41.810 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.47>}
16:01:41.810 [info] S1: New connection accepted.
16:01:41.810 [info] S1: New connection accepted.
16:01:41.810 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.48>}
16:01:41.810 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.49>}
16:01:41.810 [info] S1: New connection accepted.
16:01:41.810 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.50>}
16:01:41.838 [info] S1: New connection accepted.
16:01:41.839 [info] S1: New connection accepted.
16:01:41.839 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.51>}
16:01:41.839 [info] S1: New connection accepted.
16:01:41.839 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.53>}
16:01:41.839 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.55>}
16:01:41.839 [info] S1: New connection accepted.
16:01:41.839 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.57>}
16:01:41.839 [info] S1: New connection accepted.
16:01:41.839 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.59>}
16:01:41.839 [info] S1: New connection accepted.
16:01:41.839 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.61>}
16:01:41.840 [info] S1: New connection accepted.
16:01:41.840 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.63>}
16:01:41.840 [info] S1: New connection accepted.
16:01:41.840 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.65>}
16:01:41.840 [info] S1: New connection accepted.
16:01:41.840 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.67>}
16:01:41.840 [info] S1: New connection accepted.
16:01:41.840 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.69>}
16:01:41.840 [info] S1: New connection accepted.
16:01:41.840 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.71>}
16:01:41.840 [info] S1: New connection accepted.
16:01:41.840 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.73>}
16:01:41.840 [info] S1: New connection accepted.
16:01:41.840 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.75>}
16:01:41.841 [info] S1: New connection accepted.
16:01:41.841 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.77>}
16:01:41.841 [info] S1: New connection accepted.
16:01:41.841 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.79>}
16:01:41.841 [info] S1: New connection accepted.
16:01:41.841 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.81>}
16:01:41.841 [info] S1: New connection accepted.
16:01:41.841 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.83>}
16:01:41.841 [info] S1: New connection accepted.
16:01:41.841 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.86>}
16:01:41.841 [info] S1: New connection accepted.
16:01:41.841 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.87>}
16:01:41.841 [info] S1: New connection accepted.
16:01:41.841 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.89>}
16:01:41.842 [info] S1: New connection accepted.
16:01:41.842 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.91>}
16:01:41.842 [info] S1: New connection accepted.
16:01:41.842 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.93>}
16:01:41.842 [info] S1: New connection accepted.
16:01:41.842 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.95>}
16:01:41.842 [info] S1: New connection accepted.
16:01:41.842 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.97>}
16:01:41.842 [info] S1: New connection accepted.
16:01:41.842 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.99>}
16:01:41.842 [info] S1: New connection accepted.
16:01:41.842 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.101>}
16:01:41.842 [info] S1: New connection accepted.
16:01:41.842 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.103>}
16:01:41.842 [info] S1: New connection accepted.
16:01:41.843 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.105>}
16:01:41.843 [info] S1: New connection accepted.
16:01:41.843 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.107>}
16:01:41.843 [info] S1: New connection accepted.
16:01:41.843 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.109>}
16:01:41.843 [info] S1: New connection accepted.
16:01:41.843 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.111>}
16:01:41.843 [info] S1: New connection accepted.
16:01:41.843 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.113>}
16:01:41.843 [info] S1: New connection accepted.
16:01:41.843 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.115>}
16:01:41.843 [info] S1: New connection accepted.
16:01:41.843 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.117>}
16:01:41.843 [info] S1: New connection accepted.
16:01:41.843 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.119>}
16:01:41.843 [info] S1: New connection accepted.
16:01:41.843 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.121>}
16:01:41.844 [info] S1: New connection accepted.
16:01:41.844 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.123>}
16:01:41.844 [info] S1: New connection accepted.
16:01:41.844 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.125>}
16:01:41.844 [info] S1: New connection accepted.
16:01:41.844 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.127>}
16:01:41.844 [info] S1: New connection accepted.
16:01:41.844 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.129>}
16:01:41.844 [info] S1: New connection accepted.
16:01:41.844 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.131>}
16:01:41.844 [info] S1: New connection accepted.
16:01:41.844 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.133>}
16:01:41.844 [info] S1: New connection accepted.
16:01:41.844 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.135>}
....16:01:42.449 [debug] S1: TCPHandler received unexpected message: :accept_loop
..16:01:42.667 [info] S1: New connection accepted.
16:01:42.668 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.149>}
16:01:42.668 [info] S1: New connection accepted.
16:01:42.668 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.151>}
16:01:42.668 [info] S1: New connection accepted.
16:01:42.668 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.153>}
16:01:42.668 [info] S1: New connection accepted.
16:01:42.669 [info] S1: New connection accepted.
16:01:42.669 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.155>}
16:01:42.669 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.157>}
..16:01:42.922 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.229.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:42.922 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.552.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:42.933 [warning] S1 Encapsulator: Invalid IP invalid, dropping packet.
.16:01:43.035 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.552.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:43.036 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.554.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:01:43.047 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.554.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:43.048 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.556.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:01:43.058 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.556.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:43.059 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.558.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:01:43.070 [info] S1: Starting TCP Listener on port 0...
...16:01:43.071 [error] S1: Listener socket fatal error: :closed. Terminating.
..16:01:43.572 [warning] S1: Invalid LISTEN_IP invalid, using all interfaces.
...16:01:43.573 [info] S1: Starting TCP Listener on port 0...
16:01:44.074 [error] S1: Listener socket fatal error: :closed. Terminating.
16:01:44.075 [error] GenServer :s1_flapping_test_unique terminating
** (stop) :closed
Last message: :accept_loop
State: #Port<0.169>
16:01:44.075 [error] Process :s1_flapping_test_unique (#PID<0.577.0>) terminating
** (exit) :closed
    (stdlib 7.1) gen_server.erl:2562: :gen_server.handle_common_reply/5
    (stdlib 7.1) proc_lib.erl:333: :proc_lib.init_p_do_apply/3
Initial Call: DataDiode.S1.Listener.init/1
Ancestors: [#PID<0.576.0>]
Message Queue Length: 0
Messages: []
Links: []
Dictionary: []
Trapping Exits: false
Status: :running
Heap Size: 1598
Stack Size: 29
Reductions: 2746
.16:01:44.076 [info] S1: Starting TCP Listener on port 0...
16:01:44.577 [info] S1: New connection accepted.
......16:01:44.593 [debug] SystemMonitor: Received unexpected message: :unexp
16:01:44.597 [debug] S1: TCPHandler received unexpected message: :unexp
16:01:44.597 [info] S1: Starting TCP Listener on port 0...
16:01:44.597 [debug] S1: Listener received unexpected message: :unexp
16:01:45.174 [info] S2: Starting UDP Listener on port 0...
16:01:45.174 [warning] S2: Received unexpected message: :unexp
16:01:45.174 [error] S2: UDP Listener socket closed unexpectedly. Terminating.
16:01:45.179 [info] DiskCleaner: Low disk space detected on . (< 15%). Starting autonomous cleanup...
16:01:45.179 [warning] DiskCleaner: Simulation - would delete oldest .dat files in . now.
16:01:45.184 [info] S2: Decapsulated packet from 127.0.0.1:20480. Payload size: 7 bytes.
16:01:45.184 [debug] S2: Successfully wrote 7 bytes to /tmp/diode_test/data_1766120505184_63_20480.dat. (Simulated secure write)
16:01:45.184 [info] S2: Decapsulated packet from 127.0.0.1:0. Payload size: 9 bytes.
16:01:45.185 [debug] S1: Generating end-to-end heartbeat.
16:01:45.185 [warning] S1 Heartbeat: Received unexpected message: :unexp
16:01:45.185 [error] S2: Critical Failure! Channel heartbeat missing for > 6 minutes. The diode path may be obstructed.
16:01:45.185 [warning] S2 HeartbeatMonitor: Received unexpected message: :unexp
.16:01:45.186 [warning] S2: Invalid LISTEN_IP_S2 invalid, falling back to all interfaces.
..16:01:45.187 [info] S2: Starting UDP Listener on port 0...
16:01:45.187 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.187 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505187_64_80.dat. (Simulated secure write)
16:01:45.187 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.187 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505187_65_80.dat. (Simulated secure write)
16:01:45.187 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.188 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505188_66_80.dat. (Simulated secure write)
16:01:45.188 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.188 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505188_67_80.dat. (Simulated secure write)
16:01:45.188 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.188 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505188_68_80.dat. (Simulated secure write)
16:01:45.188 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.188 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505188_69_80.dat. (Simulated secure write)
16:01:45.188 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.188 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505188_70_80.dat. (Simulated secure write)
16:01:45.188 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.188 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.188 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505188_71_80.dat. (Simulated secure write)
16:01:45.188 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505188_72_80.dat. (Simulated secure write)
16:01:45.188 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.188 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505188_73_80.dat. (Simulated secure write)
16:01:45.188 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.188 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505188_74_80.dat. (Simulated secure write)
16:01:45.188 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.188 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505188_75_80.dat. (Simulated secure write)
16:01:45.189 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.189 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505189_76_80.dat. (Simulated secure write)
16:01:45.189 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.189 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505189_77_80.dat. (Simulated secure write)
16:01:45.189 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.189 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505189_78_80.dat. (Simulated secure write)
16:01:45.189 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.189 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505189_79_80.dat. (Simulated secure write)
16:01:45.189 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.189 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505189_80_80.dat. (Simulated secure write)
16:01:45.189 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.189 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505189_81_80.dat. (Simulated secure write)
16:01:45.189 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.189 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505189_82_80.dat. (Simulated secure write)
16:01:45.189 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.189 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505189_83_80.dat. (Simulated secure write)
16:01:45.189 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.189 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505189_84_80.dat. (Simulated secure write)
16:01:45.189 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.189 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505189_85_80.dat. (Simulated secure write)
16:01:45.189 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.190 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505190_86_80.dat. (Simulated secure write)
16:01:45.190 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.190 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505190_87_80.dat. (Simulated secure write)
16:01:45.190 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.190 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505190_88_80.dat. (Simulated secure write)
16:01:45.190 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.190 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505190_89_80.dat. (Simulated secure write)
16:01:45.190 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.190 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505190_90_80.dat. (Simulated secure write)
16:01:45.190 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.190 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505190_91_80.dat. (Simulated secure write)
16:01:45.190 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.190 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505190_92_80.dat. (Simulated secure write)
16:01:45.190 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.190 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505190_93_80.dat. (Simulated secure write)
16:01:45.190 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.190 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505190_94_80.dat. (Simulated secure write)
16:01:45.190 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.190 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505190_95_80.dat. (Simulated secure write)
16:01:45.191 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.191 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505191_96_80.dat. (Simulated secure write)
16:01:45.191 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.191 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505191_97_80.dat. (Simulated secure write)
16:01:45.191 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.191 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505191_98_80.dat. (Simulated secure write)
16:01:45.191 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.191 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505191_99_80.dat. (Simulated secure write)
16:01:45.191 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.191 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505191_100_80.dat. (Simulated secure write)
16:01:45.191 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.191 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505191_101_80.dat. (Simulated secure write)
16:01:45.191 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.191 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505191_102_80.dat. (Simulated secure write)
16:01:45.191 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.191 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505191_103_80.dat. (Simulated secure write)
16:01:45.191 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.191 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505191_104_80.dat. (Simulated secure write)
16:01:45.191 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.191 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505191_105_80.dat. (Simulated secure write)
16:01:45.191 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.191 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505191_106_80.dat. (Simulated secure write)
16:01:45.191 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.191 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505191_107_80.dat. (Simulated secure write)
16:01:45.192 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.192 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505192_108_80.dat. (Simulated secure write)
16:01:45.192 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.192 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505192_109_80.dat. (Simulated secure write)
16:01:45.192 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.192 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505192_110_80.dat. (Simulated secure write)
16:01:45.192 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.192 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505192_111_80.dat. (Simulated secure write)
16:01:45.192 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.192 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505192_112_80.dat. (Simulated secure write)
16:01:45.192 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.192 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505192_113_80.dat. (Simulated secure write)
16:01:45.192 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.192 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505192_114_80.dat. (Simulated secure write)
16:01:45.192 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.192 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505192_115_80.dat. (Simulated secure write)
16:01:45.192 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.192 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.192 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505192_116_80.dat. (Simulated secure write)
16:01:45.192 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505192_117_80.dat. (Simulated secure write)
16:01:45.192 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.192 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505192_118_80.dat. (Simulated secure write)
16:01:45.192 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.192 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505192_119_80.dat. (Simulated secure write)
16:01:45.192 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.193 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505193_120_80.dat. (Simulated secure write)
16:01:45.193 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.193 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505193_121_80.dat. (Simulated secure write)
16:01:45.193 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.193 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505193_122_80.dat. (Simulated secure write)
16:01:45.193 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.193 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505193_123_80.dat. (Simulated secure write)
16:01:45.193 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.193 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505193_124_80.dat. (Simulated secure write)
16:01:45.193 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.193 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505193_125_80.dat. (Simulated secure write)
16:01:45.193 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.193 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505193_126_80.dat. (Simulated secure write)
16:01:45.193 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.193 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505193_127_80.dat. (Simulated secure write)
16:01:45.193 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.193 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505193_128_80.dat. (Simulated secure write)
16:01:45.193 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.193 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505193_129_80.dat. (Simulated secure write)
16:01:45.193 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.193 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.193 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505193_130_80.dat. (Simulated secure write)
16:01:45.194 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.194 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505194_131_80.dat. (Simulated secure write)
16:01:45.194 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.194 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505194_132_80.dat. (Simulated secure write)
16:01:45.194 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.194 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505194_133_80.dat. (Simulated secure write)
16:01:45.194 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.194 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505194_134_80.dat. (Simulated secure write)
16:01:45.194 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.194 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505194_135_80.dat. (Simulated secure write)
16:01:45.194 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.194 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505194_136_80.dat. (Simulated secure write)
16:01:45.194 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.194 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505194_137_80.dat. (Simulated secure write)
16:01:45.194 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.194 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505194_138_80.dat. (Simulated secure write)
16:01:45.194 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.194 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505194_139_80.dat. (Simulated secure write)
16:01:45.194 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.194 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505194_140_80.dat. (Simulated secure write)
16:01:45.194 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.194 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505194_141_80.dat. (Simulated secure write)
16:01:45.195 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.195 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505195_142_80.dat. (Simulated secure write)
16:01:45.195 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.195 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505195_143_80.dat. (Simulated secure write)
16:01:45.195 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.195 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505195_144_80.dat. (Simulated secure write)
16:01:45.195 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.195 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.195 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505195_146_80.dat. (Simulated secure write)
16:01:45.195 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.195 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505195_145_80.dat. (Simulated secure write)
16:01:45.195 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505195_147_80.dat. (Simulated secure write)
16:01:45.195 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.195 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505195_148_80.dat. (Simulated secure write)
16:01:45.195 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.195 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505195_149_80.dat. (Simulated secure write)
16:01:45.196 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.196 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505196_150_80.dat. (Simulated secure write)
16:01:45.196 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.196 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505196_151_80.dat. (Simulated secure write)
16:01:45.196 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.196 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505196_152_80.dat. (Simulated secure write)
16:01:45.196 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.196 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505196_153_80.dat. (Simulated secure write)
16:01:45.196 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.196 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.196 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.196 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.196 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.197 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.197 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.197 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.197 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:45.197 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505197_154_80.dat. (Simulated secure write)
16:01:45.197 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505197_155_80.dat. (Simulated secure write)
16:01:45.197 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505197_158_80.dat. (Simulated secure write)
16:01:45.197 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505197_159_80.dat. (Simulated secure write)
16:01:45.197 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505197_156_80.dat. (Simulated secure write)
16:01:45.197 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505197_157_80.dat. (Simulated secure write)
16:01:45.197 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505197_160_80.dat. (Simulated secure write)
16:01:45.197 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505197_161_80.dat. (Simulated secure write)
16:01:45.197 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505197_162_80.dat. (Simulated secure write)
16:01:45.198 [debug] S2: Successfully wrote 7 bytes to ./data_1766120505198_163_80.dat. (Simulated secure write)
..16:01:45.297 [info] S2: Starting UDP Listener on port 0...
16:01:45.298 [info] S2: Decapsulated packet from 1.2.3.4:80. Payload size: 5 bytes.
16:01:45.298 [debug] S2: Successfully wrote 5 bytes to ./data_1766120505298_164_80.dat. (Simulated secure write)
.16:01:45.308 [error] S2: UDP Listener socket closed unexpectedly. Terminating.
.16:01:45.308 [info] S2: Starting UDP Listener on port 0...
16:01:45.309 [info] S2: Decapsulated packet from 127.0.0.1:1234. Payload size: 12 bytes.
16:01:45.309 [debug] S2: Successfully wrote 12 bytes to ./data_1766120505309_165_1234.dat. (Simulated secure write)
16:01:45.331 [info] S2: Starting UDP Listener on port 0...


  1) test UDP listener receives packet and delegates to Decapsulator (DataDiode.S2.ListenerTest)
     test/s2_listener_test.exs:116
     ** (Mox.VerificationError) error while verifying mocks for #PID<0.774.0>:

       * expected DataDiode.S2.DecapsulatorMock.process_packet/1 to be invoked once but it was invoked 0 times
     code: verify!()
     stacktrace:
       (mox 1.2.0) lib/mox.ex:862: Mox.__verify_mock_or_all__/2
       test/s2_listener_test.exs:140: (test)

..
Finished in 3.6 seconds (0.1s async, 3.5s sync)
1 doctest, 65 tests, 1 failure
Run 7 FAILED
Run 8
warning: setting :preferred_cli_env in your mix.exs "def project" is deprecated, set it inside "def cli" instead:

    def cli do
      [preferred_envs: [release: :prod, test: :test]]
    end

  (mix 1.19.4) lib/mix/cli.ex:187: Mix.CLI.preferred_cli_env/3
  (mix 1.19.4) lib/mix/cli.ex:170: Mix.CLI.maybe_change_env_and_target/2
  (mix 1.19.4) lib/mix/cli.ex:59: Mix.CLI.proceed/2
  /opt/homebrew/bin/mix:7: (file)
  (elixir 1.19.4) src/elixir_compiler.erl:81: :elixir_compiler.dispatch/4
  (elixir 1.19.4) src/elixir_compiler.erl:56: :elixir_compiler.compile/4

16:01:45.808 [info] Application logger started at :nonode@nohost
16:01:45.813 [info] Child :ttb_autostart of Supervisor :runtime_tools_sup started
Pid: #PID<0.183.0>
Start Call: :ttb_autostart.start_link()
Restart: :temporary
Shutdown: 3000
Type: :worker
16:01:45.814 [info] Application runtime_tools started at :nonode@nohost
16:01:45.814 [info] Application opentelemetry_api started at :nonode@nohost
16:01:45.814 [info] Application ctx started at :nonode@nohost
16:01:45.814 [info] Application hpack started at :nonode@nohost
16:01:45.814 [info] Application chatterbox started at :nonode@nohost
16:01:45.814 [info] Application acceptor_pool started at :nonode@nohost
16:01:45.819 [info] Child :gproc of Supervisor :gproc_sup started
Pid: #PID<0.187.0>
Start Call: :gproc.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:01:45.820 [info] Child :gproc_monitor of Supervisor :gproc_sup started
Pid: #PID<0.188.0>
Start Call: :gproc_monitor.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:01:45.820 [info] Child :gproc_bcast of Supervisor :gproc_sup started
Pid: #PID<0.189.0>
Start Call: :gproc_bcast.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:01:45.821 [info] Child :gproc_pool of Supervisor :gproc_sup started
Pid: #PID<0.190.0>
Start Call: :gproc_pool.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:01:45.821 [info] Application gproc started at :nonode@nohost
16:01:45.823 [info] Child :grpcbox_services_simple_sup of Supervisor :grpcbox_sup started
Pid: #PID<0.194.0>
Start Call: :grpcbox_services_simple_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:01:45.823 [info] Child :grpcbox_channel_sup of Supervisor :grpcbox_sup started
Pid: #PID<0.195.0>
Start Call: :grpcbox_channel_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:01:45.824 [info] Application grpcbox started at :nonode@nohost
16:01:45.824 [info] Application ssl_verify_fun started at :nonode@nohost
16:01:45.894 [info] Loading 162 CA(s) from :otp store
16:01:45.894 [info] Child :tls_certificate_check_shared_state of Supervisor :tls_certificate_check_sup started
Pid: #PID<0.199.0>
Start Call: :tls_certificate_check_shared_state.start_link()
Restart: :permanent
Shutdown: :infinity
Type: :worker
16:01:45.894 [info] Application tls_certificate_check started at :nonode@nohost
16:01:45.894 [info] Application opentelemetry_exporter started at :nonode@nohost
16:01:45.899 [info] Child :otel_span_ets of Supervisor :otel_span_sup started
Pid: #PID<0.207.0>
Start Call: :otel_span_ets.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:45.900 [info] Child :otel_span_sweeper of Supervisor :otel_span_sup started
Pid: #PID<0.208.0>
Start Call: :otel_span_sweeper.start_link(%{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:45.900 [info] Child :otel_span_sup of Supervisor :opentelemetry_sup started
Pid: #PID<0.206.0>
Start Call: :otel_span_sup.start_link(%{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:01:45.902 [info] Child :otel_resource_detector of Supervisor :opentelemetry_sup started
Pid: #PID<0.209.0>
Start Call: :otel_resource_detector.start_link(%{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:45.903 [info] Child :otel_tracer_provider_sup of Supervisor :opentelemetry_sup started
Pid: #PID<0.212.0>
Start Call: :otel_tracer_provider_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:01:45.905 [info] Child :otel_span_processor_sup of Supervisor #PID<0.213.0> (:otel_tracer_server_sup) started
Pid: #PID<0.214.0>
Start Call: :otel_span_processor_sup.start_link(:otel_span_processor_sup_global)
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:01:45.910 [info] Child :otel_tracer_server of Supervisor #PID<0.213.0> (:otel_tracer_server_sup) started
Pid: #PID<0.215.0>
Start Call: :otel_tracer_server.start_link(:global, :otel_tracer_provider_global, :otel_span_processor_sup_global, {:resource, :undefined, {:attributes, 128, 255, 0, %{"process.executable.name": "erl", "process.runtime.description": "Erlang/OTP 28 erts-16.1.2", "process.runtime.version": "16.1.2", "process.runtime.name": "BEAM", "service.name": "unknown_service:erl", "service.instance.id": 82703433824190286223184406520133480164, "telemetry.sdk.version": "1.6.0", "telemetry.sdk.language": "erlang", "telemetry.sdk.name": "opentelemetry"}}}, %{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:45.913 [debug] Child {:httpc, :"otel_exporter_otlp_<0.216.0>"} of Supervisor :httpc_profile_sup started
Pid: #PID<0.217.0>
Start Call: :httpc_manager.start_link(:"otel_exporter_otlp_<0.216.0>", :only_session_cookies, :inets)
Restart: :permanent
Shutdown: 4000
Type: :worker
16:01:45.916 [info] OTLP exporter successfully initialized
16:01:45.917 [info] Application opentelemetry started at :nonode@nohost
16:01:45.918 [info] Application jason started at :nonode@nohost
16:01:45.918 [info] Application logger_json started at :nonode@nohost
16:01:45.918 [info] Application nimble_ownership started at :nonode@nohost
16:01:45.920 [info] Child Mox of Supervisor Mox.Supervisor started
Pid: #PID<0.221.0>
Start Call: Mox.start_link_ownership()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:45.921 [info] Application mox started at :nonode@nohost
16:01:45.924 [info] Child DataDiode.Metrics of Supervisor DataDiode.Supervisor started
Pid: #PID<0.225.0>
Start Call: DataDiode.Metrics.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:45.925 [info] Child DataDiode.SystemMonitor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.226.0>
Start Call: DataDiode.SystemMonitor.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:45.925 [info] S1: Starting TCP Listener on port 0...
16:01:45.925 [info] Child DataDiode.S1.Listener of Supervisor DataDiode.Supervisor started
Pid: #PID<0.227.0>
Start Call: DataDiode.S1.Listener.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:45.927 [info] Child DataDiode.S1.HandlerSupervisor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.228.0>
Start Call: DataDiode.S1.HandlerSupervisor.start_link()
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:01:45.929 [warning] S1 Encapsulator: Invalid S2_PORT 0, using default 42001
16:01:45.929 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.229.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:45.929 [info] Child DataDiode.S1.Heartbeat of Supervisor DataDiode.Supervisor started
Pid: #PID<0.230.0>
Start Call: DataDiode.S1.Heartbeat.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:45.929 [info] Child DataDiode.S2.HeartbeatMonitor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.231.0>
Start Call: DataDiode.S2.HeartbeatMonitor.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:45.929 [info] Child DataDiode.DiskCleaner of Supervisor DataDiode.Supervisor started
Pid: #PID<0.232.0>
Start Call: DataDiode.DiskCleaner.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:45.929 [info] S2: Starting UDP Listener on port 0...
16:01:45.929 [info] Child DataDiode.S2.Listener of Supervisor DataDiode.Supervisor started
Pid: #PID<0.233.0>
Start Call: DataDiode.S2.Listener.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:45.929 [info] Child DataDiode.S2.TaskSupervisor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.234.0>
Start Call: Task.Supervisor.start_link([name: DataDiode.S2.TaskSupervisor, max_children: 200])
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:01:45.930 [info] Application data_diode started at :nonode@nohost
16:01:45.934 [info] Child ExUnit.Server of Supervisor ExUnit.Supervisor started
Pid: #PID<0.240.0>
Start Call: ExUnit.Server.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:45.934 [info] Child ExUnit.CaptureServer of Supervisor ExUnit.Supervisor started
Pid: #PID<0.241.0>
Start Call: ExUnit.CaptureServer.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:45.934 [info] Application ex_unit started at :nonode@nohost
Running ExUnit with seed: 936096, max_cases: 16

    warning: variable "c" is unused (if the variable is not meant to be used, prefix it with an underscore)
    │
 26 │     {:ok, c} = :gen_tcp.connect({127,0,0,1}, port, [:binary, active: false])
    │           ~
    │
    └─ test/long_term_robustness_test.exs:26:11: DataDiode.LongTermRobustnessTest."test TCPHandler exhaustive branch coverage"/1

    warning: variable "pid3" is unused (if the variable is not meant to be used, prefix it with an underscore)
    │
 62 │     {:ok, pid3} = TCPHandler.start_link(s3)
    │           ~~~~
    │
    └─ test/long_term_robustness_test.exs:62:11: DataDiode.LongTermRobustnessTest."test TCPHandler exhaustive branch coverage"/1

...     warning: redefining module DataDiode.S1.EncapsulatorMock (current version defined in memory)
     │
 491 │     Module.create(name, [info | body], Macro.Env.location(__ENV__))
     │     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     │
     └─ deps/mox/lib/mox.ex:491: DataDiode.S1.EncapsulatorMock (module)

...........16:01:46.036 [error] S2: Failed to parse header: invalid_packet_size
.16:01:46.037 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 0 bytes.
.16:01:46.037 [debug] S2: Successfully wrote 0 bytes to ./data_1766120506037_3_51210.dat. (Simulated secure write)
16:01:46.037 [error] S2: Failed to parse header: invalid_packet_size
.16:01:46.037 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 9 bytes.
.16:01:46.037 [debug] S2: Successfully wrote 9 bytes to ./data_1766120506037_4_80.dat. (Simulated secure write)
.16:01:46.037 [error] S2: Failed to parse header: invalid_packet_size
.16:01:46.037 [info] S2: Decapsulated packet from 0.0.0.0:0. Payload size: 0 bytes.
16:01:46.037 [debug] S2: Successfully wrote 0 bytes to ./data_1766120506037_5_0.dat. (Simulated secure write)
16:01:46.061 [info] Child of Supervisor :inet_gethost_native_sup started
Pid: #PID<0.395.0>
Start Call: :inet_gethost_native.init([])
16:01:46.061 [debug] Child :inet_gethost_native_sup of Supervisor :kernel_safe_sup started
Pid: #PID<0.394.0>
Start Call: :inet_gethost_native.start_link()
Restart: :temporary
Shutdown: 1000
Type: :worker
.16:01:46.066 [error] S1: TCP error for 1.2.3.4: :econnreset
.16:01:46.067 [warning] S1: Dropping oversized packet (1048577 bytes) from 1.2.3.4
.16:01:46.067 [info] S1: Connection closed by 1.2.3.4:80
.16:01:46.067 [debug] S1: TCPHandler received unexpected message: :accept_loop
.16:01:46.068 [info] S1: Forwarded 11 bytes.
.16:01:46.078 [debug] S1: TCPHandler received unexpected message: :unknown
.....16:01:46.130 [info] S1: Starting TCP Listener on port 8092...
16:01:46.131 [info] S1: New connection accepted.
16:01:46.131 [info] S1: New connection accepted.
16:01:46.132 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.40>}
16:01:46.132 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.42>}
16:01:46.132 [info] S1: New connection accepted.
16:01:46.132 [info] S1: New connection accepted.
16:01:46.132 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.49>}
16:01:46.132 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.50>}
16:01:46.132 [info] S1: New connection accepted.
16:01:46.132 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.51>}
16:01:46.132 [info] S1: New connection accepted.
16:01:46.132 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.52>}
16:01:46.132 [info] S1: New connection accepted.
16:01:46.189 [info] S1: New connection accepted.
16:01:46.189 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.53>}
16:01:46.190 [info] S1: New connection accepted.
16:01:46.190 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.54>}
16:01:46.190 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.56>}
16:01:46.190 [info] S1: New connection accepted.
16:01:46.190 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.58>}
16:01:46.190 [info] S1: New connection accepted.
16:01:46.190 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.60>}
16:01:46.190 [info] S1: New connection accepted.
16:01:46.190 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.62>}
16:01:46.190 [info] S1: New connection accepted.
16:01:46.191 [info] S1: New connection accepted.
16:01:46.191 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.64>}
16:01:46.191 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.66>}
16:01:46.191 [info] S1: New connection accepted.
16:01:46.191 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.68>}
16:01:46.191 [info] S1: New connection accepted.
16:01:46.191 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.70>}
16:01:46.191 [info] S1: New connection accepted.
16:01:46.191 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.72>}
16:01:46.191 [info] S1: New connection accepted.
16:01:46.191 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.74>}
16:01:46.191 [info] S1: New connection accepted.
16:01:46.191 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.76>}
16:01:46.192 [info] S1: New connection accepted.
16:01:46.192 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.78>}
16:01:46.192 [info] S1: New connection accepted.
16:01:46.192 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.80>}
16:01:46.192 [info] S1: New connection accepted.
16:01:46.192 [info] S1: New connection accepted.
16:01:46.192 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.82>}
16:01:46.192 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.84>}
16:01:46.192 [info] S1: New connection accepted.
16:01:46.192 [info] S1: New connection accepted.
16:01:46.192 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.86>}
16:01:46.192 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.88>}
16:01:46.192 [info] S1: New connection accepted.
16:01:46.192 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.90>}
16:01:46.192 [info] S1: New connection accepted.
16:01:46.193 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.92>}
16:01:46.193 [info] S1: New connection accepted.
16:01:46.193 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.94>}
16:01:46.193 [info] S1: New connection accepted.
16:01:46.193 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.96>}
16:01:46.193 [info] S1: New connection accepted.
16:01:46.193 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.98>}
16:01:46.193 [info] S1: New connection accepted.
16:01:46.193 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.100>}
16:01:46.193 [info] S1: New connection accepted.
16:01:46.193 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.102>}
16:01:46.193 [info] S1: New connection accepted.
16:01:46.193 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.104>}
16:01:46.194 [info] S1: New connection accepted.
16:01:46.194 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.106>}
16:01:46.194 [info] S1: New connection accepted.
16:01:46.194 [info] S1: New connection accepted.
16:01:46.194 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.108>}
16:01:46.194 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.110>}
16:01:46.194 [info] S1: New connection accepted.
16:01:46.194 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.112>}
16:01:46.194 [info] S1: New connection accepted.
16:01:46.194 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.114>}
16:01:46.194 [info] S1: New connection accepted.
16:01:46.194 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.116>}
16:01:46.194 [info] S1: New connection accepted.
16:01:46.194 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.118>}
16:01:46.195 [info] S1: New connection accepted.
16:01:46.195 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.120>}
16:01:46.195 [info] S1: New connection accepted.
16:01:46.195 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.122>}
16:01:46.195 [info] S1: New connection accepted.
16:01:46.195 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.124>}
16:01:46.195 [info] S1: New connection accepted.
16:01:46.195 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.126>}
16:01:46.195 [info] S1: New connection accepted.
16:01:46.195 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.128>}
16:01:46.195 [info] S1: New connection accepted.
16:01:46.195 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.130>}
16:01:46.195 [info] S1: New connection accepted.
16:01:46.195 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.132>}
16:01:46.196 [info] S1: New connection accepted.
16:01:46.196 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.134>}
16:01:46.196 [info] S1: New connection accepted.
16:01:46.196 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.136>}
16:01:46.196 [info] S1: New connection accepted.
16:01:46.196 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.138>}
.16:01:46.744 [debug] S1: TCPHandler received unexpected message: :accept_loop
..16:01:46.930 [info] S1: New connection accepted.
16:01:46.930 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.148>}
16:01:46.930 [info] S1: New connection accepted.
16:01:46.930 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.151>}
16:01:46.930 [info] S1: New connection accepted.
16:01:46.930 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.153>}
16:01:46.930 [info] S1: New connection accepted.
16:01:46.931 [info] S1: New connection accepted.
16:01:46.931 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.155>}
...16:01:47.187 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.229.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:47.187 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.564.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:01:47.199 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.564.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:47.199 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.566.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:01:47.209 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.566.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:47.210 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.568.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:47.220 [warning] S1 Encapsulator: Invalid IP invalid, dropping packet.
.16:01:47.321 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.568.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:47.322 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.570.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
..16:01:47.333 [info] S2: Starting UDP Listener on port 0...
16:01:47.333 [info] S2: Decapsulated packet from 127.0.0.1:1234. Payload size: 12 bytes.
16:01:47.333 [debug] S2: Successfully wrote 12 bytes to ./data_1766120507333_62_1234.dat. (Simulated secure write)
16:01:47.356 [error] S2: UDP Listener socket closed unexpectedly. Terminating.
16:01:47.357 [info] S2: Starting UDP Listener on port 0...
16:01:47.357 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.358 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507358_63_80.dat. (Simulated secure write)
16:01:47.358 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.358 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507358_64_80.dat. (Simulated secure write)
16:01:47.358 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.358 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507358_65_80.dat. (Simulated secure write)
16:01:47.358 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.358 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.358 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507358_66_80.dat. (Simulated secure write)
16:01:47.358 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507358_67_80.dat. (Simulated secure write)
16:01:47.359 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.359 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507359_68_80.dat. (Simulated secure write)
16:01:47.359 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.359 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507359_69_80.dat. (Simulated secure write)
16:01:47.359 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.359 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507359_70_80.dat. (Simulated secure write)
16:01:47.359 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.359 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507359_71_80.dat. (Simulated secure write)
16:01:47.359 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.359 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507359_72_80.dat. (Simulated secure write)
16:01:47.360 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.360 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507360_73_80.dat. (Simulated secure write)
16:01:47.360 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.360 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507360_74_80.dat. (Simulated secure write)
16:01:47.360 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.360 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507360_75_80.dat. (Simulated secure write)
16:01:47.360 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.360 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507360_76_80.dat. (Simulated secure write)
16:01:47.360 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.360 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507360_77_80.dat. (Simulated secure write)
16:01:47.360 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.360 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507360_78_80.dat. (Simulated secure write)
16:01:47.361 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.361 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507361_79_80.dat. (Simulated secure write)
16:01:47.361 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.361 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507361_80_80.dat. (Simulated secure write)
16:01:47.361 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.361 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507361_81_80.dat. (Simulated secure write)
16:01:47.361 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.361 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507361_82_80.dat. (Simulated secure write)
16:01:47.362 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.362 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507362_83_80.dat. (Simulated secure write)
16:01:47.362 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.362 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507362_84_80.dat. (Simulated secure write)
16:01:47.362 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.362 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507362_85_80.dat. (Simulated secure write)
16:01:47.362 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.362 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507362_86_80.dat. (Simulated secure write)
16:01:47.363 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.363 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507363_87_80.dat. (Simulated secure write)
16:01:47.363 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.363 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507363_88_80.dat. (Simulated secure write)
16:01:47.363 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.


16:01:47.363 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507363_89_80.dat. (Simulated secure write)
  1) test UDP listener receives packet and delegates to Decapsulator (DataDiode.S2.ListenerTest)
     test/s2_listener_test.exs:116
     ** (Mox.VerificationError) error while verifying mocks for #PID<0.574.0>:

       * expected DataDiode.S2.DecapsulatorMock.process_packet/1 to be invoked once but it was invoked 0 times
     code: verify!()
     stacktrace:
       (mox 1.2.0) lib/mox.ex:862: Mox.__verify_mock_or_all__/2
       test/s2_listener_test.exs:140: (test)

16:01:47.363 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
.16:01:47.363 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507363_90_80.dat. (Simulated secure write)
.16:01:47.363 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.363 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507363_91_80.dat. (Simulated secure write)
16:01:47.363 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.363 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507363_92_80.dat. (Simulated secure write)
16:01:47.364 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.364 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507364_93_80.dat. (Simulated secure write)
16:01:47.364 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.364 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507364_94_80.dat. (Simulated secure write)
16:01:47.364 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.364 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507364_95_80.dat. (Simulated secure write)
16:01:47.364 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.364 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507364_96_80.dat. (Simulated secure write)
16:01:47.364 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.364 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.364 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507364_98_80.dat. (Simulated secure write)
16:01:47.364 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507364_97_80.dat. (Simulated secure write)
16:01:47.364 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.364 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.364 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507364_99_80.dat. (Simulated secure write)
16:01:47.364 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507364_100_80.dat. (Simulated secure write)
16:01:47.365 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.365 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507365_101_80.dat. (Simulated secure write)
16:01:47.365 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.365 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507365_102_80.dat. (Simulated secure write)
16:01:47.365 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.365 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507365_103_80.dat. (Simulated secure write)
16:01:47.365 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.365 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507365_104_80.dat. (Simulated secure write)
16:01:47.365 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.365 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.365 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.365 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.366 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.366 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.366 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.366 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.366 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.366 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.366 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.366 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.367 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.367 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.367 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.367 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.367 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507367_105_80.dat. (Simulated secure write)
16:01:47.367 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507367_106_80.dat. (Simulated secure write)
16:01:47.367 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507367_108_80.dat. (Simulated secure write)
16:01:47.367 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507367_109_80.dat. (Simulated secure write)
16:01:47.367 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507367_107_80.dat. (Simulated secure write)
16:01:47.367 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.367 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507367_110_80.dat. (Simulated secure write)
16:01:47.367 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.367 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507367_111_80.dat. (Simulated secure write)
16:01:47.367 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.367 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507367_112_80.dat. (Simulated secure write)
16:01:47.368 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.368 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507368_113_80.dat. (Simulated secure write)
16:01:47.368 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.368 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507368_114_80.dat. (Simulated secure write)
16:01:47.368 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.368 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507368_115_80.dat. (Simulated secure write)
16:01:47.368 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.368 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507368_116_80.dat. (Simulated secure write)
16:01:47.368 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.368 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507368_117_80.dat. (Simulated secure write)
16:01:47.368 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.368 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507368_118_80.dat. (Simulated secure write)
16:01:47.368 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.368 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507368_119_80.dat. (Simulated secure write)
16:01:47.369 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.369 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507369_120_80.dat. (Simulated secure write)
16:01:47.369 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.369 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507369_121_80.dat. (Simulated secure write)
16:01:47.369 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.369 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507369_122_80.dat. (Simulated secure write)
16:01:47.369 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.369 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507369_123_80.dat. (Simulated secure write)
16:01:47.369 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507369_124_80.dat. (Simulated secure write)
16:01:47.369 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507369_130_80.dat. (Simulated secure write)
16:01:47.369 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507369_129_80.dat. (Simulated secure write)
16:01:47.369 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507369_127_80.dat. (Simulated secure write)
16:01:47.369 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.369 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507369_125_80.dat. (Simulated secure write)
16:01:47.369 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507369_132_80.dat. (Simulated secure write)
16:01:47.369 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507369_126_80.dat. (Simulated secure write)
16:01:47.369 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507369_134_80.dat. (Simulated secure write)
16:01:47.369 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507369_128_80.dat. (Simulated secure write)
16:01:47.369 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507369_133_80.dat. (Simulated secure write)
16:01:47.369 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507369_131_80.dat. (Simulated secure write)
16:01:47.369 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.369 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.369 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.369 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.370 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.370 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.370 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.370 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.370 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.370 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.370 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.370 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.370 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.370 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.371 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.371 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.371 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.371 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.371 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.371 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.371 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.371 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.371 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.372 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.372 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.372 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.372 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:47.372 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507372_135_80.dat. (Simulated secure write)
16:01:47.372 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507372_136_80.dat. (Simulated secure write)
16:01:47.372 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507372_137_80.dat. (Simulated secure write)
16:01:47.372 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507372_141_80.dat. (Simulated secure write)
16:01:47.372 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507372_140_80.dat. (Simulated secure write)
16:01:47.372 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507372_142_80.dat. (Simulated secure write)
16:01:47.372 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507372_138_80.dat. (Simulated secure write)
16:01:47.372 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507372_139_80.dat. (Simulated secure write)
16:01:47.372 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507372_143_80.dat. (Simulated secure write)
16:01:47.373 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507373_144_80.dat. (Simulated secure write)
16:01:47.373 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507373_145_80.dat. (Simulated secure write)
16:01:47.373 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507373_147_80.dat. (Simulated secure write)
16:01:47.373 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507373_146_80.dat. (Simulated secure write)
16:01:47.373 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507373_148_80.dat. (Simulated secure write)
16:01:47.373 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507373_150_80.dat. (Simulated secure write)
16:01:47.373 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507373_154_80.dat. (Simulated secure write)
16:01:47.373 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507373_156_80.dat. (Simulated secure write)
16:01:47.373 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507373_151_80.dat. (Simulated secure write)
16:01:47.373 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507373_157_80.dat. (Simulated secure write)
16:01:47.373 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507373_152_80.dat. (Simulated secure write)
16:01:47.373 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507373_160_80.dat. (Simulated secure write)
16:01:47.373 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507373_153_80.dat. (Simulated secure write)
16:01:47.373 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507373_158_80.dat. (Simulated secure write)
16:01:47.373 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507373_155_80.dat. (Simulated secure write)
16:01:47.373 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507373_159_80.dat. (Simulated secure write)
16:01:47.373 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507373_149_80.dat. (Simulated secure write)
16:01:47.373 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507373_161_80.dat. (Simulated secure write)
16:01:47.373 [debug] S2: Successfully wrote 7 bytes to ./data_1766120507373_162_80.dat. (Simulated secure write)
16:01:47.431 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.156>}
.16:01:47.473 [info] S2: Starting UDP Listener on port 0...
16:01:47.473 [info] S2: Decapsulated packet from 1.2.3.4:80. Payload size: 5 bytes.
16:01:47.473 [debug] S2: Successfully wrote 5 bytes to ./data_1766120507473_163_80.dat. (Simulated secure write)
.16:01:47.485 [info] S2: Starting UDP Listener on port 0...
.16:01:47.485 [warning] S2: Invalid LISTEN_IP_S2 invalid, falling back to all interfaces.
.........16:01:47.490 [warning] S1: Invalid LISTEN_IP invalid, using all interfaces.
.16:01:47.490 [error] S1: Listener socket fatal error: :closed. Terminating.
....16:01:47.991 [info] S1: Starting TCP Listener on port 0...
16:01:48.492 [error] S1: Listener socket fatal error: :closed. Terminating.
16:01:48.492 [error] GenServer :s1_flapping_test_unique terminating
** (stop) :closed
Last message: :accept_loop
State: #Port<0.175>
16:01:48.493 [error] Process :s1_flapping_test_unique (#PID<0.717.0>) terminating
** (exit) :closed
    (stdlib 7.1) gen_server.erl:2562: :gen_server.handle_common_reply/5
    (stdlib 7.1) proc_lib.erl:333: :proc_lib.init_p_do_apply/3
Initial Call: DataDiode.S1.Listener.init/1
Ancestors: [#PID<0.716.0>]
Message Queue Length: 0
Messages: []
Links: []
Dictionary: []
Trapping Exits: false
Status: :running
Heap Size: 1598
Stack Size: 29
Reductions: 2746
.16:01:48.494 [info] S1: Starting TCP Listener on port 0...
.16:01:48.496 [info] S1: Starting TCP Listener on port 0...
16:01:48.997 [info] S1: New connection accepted.
.16:01:49.006 [debug] SystemMonitor: Received unexpected message: :unexp
16:01:49.009 [debug] S1: TCPHandler received unexpected message: :unexp
16:01:49.009 [info] S1: Starting TCP Listener on port 0...
16:01:49.009 [debug] S1: Listener received unexpected message: :unexp
16:01:49.943 [info] S2: Starting UDP Listener on port 0...
16:01:49.943 [warning] S2: Received unexpected message: :unexp
16:01:49.943 [error] S2: UDP Listener socket closed unexpectedly. Terminating.
16:01:50.024 [info] DiskCleaner: Low disk space detected on . (< 15%). Starting autonomous cleanup...
16:01:50.025 [warning] DiskCleaner: Simulation - would delete oldest .dat files in . now.
16:01:50.076 [info] S2: Decapsulated packet from 127.0.0.1:20480. Payload size: 7 bytes.
16:01:50.076 [debug] S2: Successfully wrote 7 bytes to /tmp/diode_test/data_1766120510076_165_20480.dat. (Simulated secure write)
16:01:50.077 [info] S2: Decapsulated packet from 127.0.0.1:0. Payload size: 9 bytes.
16:01:50.081 [debug] S1: Generating end-to-end heartbeat.
16:01:50.081 [warning] S1 Heartbeat: Received unexpected message: :unexp
16:01:50.081 [error] S2: Critical Failure! Channel heartbeat missing for > 6 minutes. The diode path may be obstructed.
16:01:50.081 [warning] S2 HeartbeatMonitor: Received unexpected message: :unexp
.
Finished in 4.1 seconds (0.1s async, 4.0s sync)
1 doctest, 65 tests, 1 failure
Run 8 FAILED
Run 9
warning: setting :preferred_cli_env in your mix.exs "def project" is deprecated, set it inside "def cli" instead:

    def cli do
      [preferred_envs: [release: :prod, test: :test]]
    end

  (mix 1.19.4) lib/mix/cli.ex:187: Mix.CLI.preferred_cli_env/3
  (mix 1.19.4) lib/mix/cli.ex:170: Mix.CLI.maybe_change_env_and_target/2
  (mix 1.19.4) lib/mix/cli.ex:59: Mix.CLI.proceed/2
  /opt/homebrew/bin/mix:7: (file)
  (elixir 1.19.4) src/elixir_compiler.erl:81: :elixir_compiler.dispatch/4
  (elixir 1.19.4) src/elixir_compiler.erl:56: :elixir_compiler.compile/4

16:01:50.677 [info] Application logger started at :nonode@nohost
16:01:50.683 [info] Child :ttb_autostart of Supervisor :runtime_tools_sup started
Pid: #PID<0.183.0>
Start Call: :ttb_autostart.start_link()
Restart: :temporary
Shutdown: 3000
Type: :worker
16:01:50.683 [info] Application runtime_tools started at :nonode@nohost
16:01:50.683 [info] Application opentelemetry_api started at :nonode@nohost
16:01:50.683 [info] Application ctx started at :nonode@nohost
16:01:50.683 [info] Application hpack started at :nonode@nohost
16:01:50.683 [info] Application chatterbox started at :nonode@nohost
16:01:50.683 [info] Application acceptor_pool started at :nonode@nohost
16:01:50.688 [info] Child :gproc of Supervisor :gproc_sup started
Pid: #PID<0.187.0>
Start Call: :gproc.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:01:50.689 [info] Child :gproc_monitor of Supervisor :gproc_sup started
Pid: #PID<0.188.0>
Start Call: :gproc_monitor.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:01:50.690 [info] Child :gproc_bcast of Supervisor :gproc_sup started
Pid: #PID<0.189.0>
Start Call: :gproc_bcast.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:01:50.691 [info] Child :gproc_pool of Supervisor :gproc_sup started
Pid: #PID<0.190.0>
Start Call: :gproc_pool.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:01:50.691 [info] Application gproc started at :nonode@nohost
16:01:50.692 [info] Child :grpcbox_services_simple_sup of Supervisor :grpcbox_sup started
Pid: #PID<0.194.0>
Start Call: :grpcbox_services_simple_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:01:50.693 [info] Child :grpcbox_channel_sup of Supervisor :grpcbox_sup started
Pid: #PID<0.195.0>
Start Call: :grpcbox_channel_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:01:50.693 [info] Application grpcbox started at :nonode@nohost
16:01:50.693 [info] Application ssl_verify_fun started at :nonode@nohost
16:01:50.755 [info] Loading 162 CA(s) from :otp store
16:01:50.755 [info] Child :tls_certificate_check_shared_state of Supervisor :tls_certificate_check_sup started
Pid: #PID<0.199.0>
Start Call: :tls_certificate_check_shared_state.start_link()
Restart: :permanent
Shutdown: :infinity
Type: :worker
16:01:50.755 [info] Application tls_certificate_check started at :nonode@nohost
16:01:50.755 [info] Application opentelemetry_exporter started at :nonode@nohost
16:01:50.760 [info] Child :otel_span_ets of Supervisor :otel_span_sup started
Pid: #PID<0.207.0>
Start Call: :otel_span_ets.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:50.761 [info] Child :otel_span_sweeper of Supervisor :otel_span_sup started
Pid: #PID<0.208.0>
Start Call: :otel_span_sweeper.start_link(%{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:50.761 [info] Child :otel_span_sup of Supervisor :opentelemetry_sup started
Pid: #PID<0.206.0>
Start Call: :otel_span_sup.start_link(%{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:01:50.763 [info] Child :otel_resource_detector of Supervisor :opentelemetry_sup started
Pid: #PID<0.209.0>
Start Call: :otel_resource_detector.start_link(%{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:50.764 [info] Child :otel_tracer_provider_sup of Supervisor :opentelemetry_sup started
Pid: #PID<0.212.0>
Start Call: :otel_tracer_provider_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:01:50.766 [info] Child :otel_span_processor_sup of Supervisor #PID<0.213.0> (:otel_tracer_server_sup) started
Pid: #PID<0.214.0>
Start Call: :otel_span_processor_sup.start_link(:otel_span_processor_sup_global)
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:01:50.771 [info] Child :otel_tracer_server of Supervisor #PID<0.213.0> (:otel_tracer_server_sup) started
Pid: #PID<0.215.0>
Start Call: :otel_tracer_server.start_link(:global, :otel_tracer_provider_global, :otel_span_processor_sup_global, {:resource, :undefined, {:attributes, 128, 255, 0, %{"process.executable.name": "erl", "process.runtime.description": "Erlang/OTP 28 erts-16.1.2", "process.runtime.version": "16.1.2", "process.runtime.name": "BEAM", "service.name": "unknown_service:erl", "service.instance.id": 323331602146501403722632495715006657468, "telemetry.sdk.version": "1.6.0", "telemetry.sdk.language": "erlang", "telemetry.sdk.name": "opentelemetry"}}}, %{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:50.774 [debug] Child {:httpc, :"otel_exporter_otlp_<0.216.0>"} of Supervisor :httpc_profile_sup started
Pid: #PID<0.217.0>
Start Call: :httpc_manager.start_link(:"otel_exporter_otlp_<0.216.0>", :only_session_cookies, :inets)
Restart: :permanent
Shutdown: 4000
Type: :worker
16:01:50.777 [info] OTLP exporter successfully initialized
16:01:50.777 [info] Application opentelemetry started at :nonode@nohost
16:01:50.778 [info] Application jason started at :nonode@nohost
16:01:50.778 [info] Application logger_json started at :nonode@nohost
16:01:50.778 [info] Application nimble_ownership started at :nonode@nohost
16:01:50.781 [info] Child Mox of Supervisor Mox.Supervisor started
Pid: #PID<0.221.0>
Start Call: Mox.start_link_ownership()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:50.781 [info] Application mox started at :nonode@nohost
16:01:50.785 [info] Child DataDiode.Metrics of Supervisor DataDiode.Supervisor started
Pid: #PID<0.225.0>
Start Call: DataDiode.Metrics.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:50.785 [info] Child DataDiode.SystemMonitor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.226.0>
Start Call: DataDiode.SystemMonitor.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:50.786 [info] S1: Starting TCP Listener on port 0...
16:01:50.786 [info] Child DataDiode.S1.Listener of Supervisor DataDiode.Supervisor started
Pid: #PID<0.227.0>
Start Call: DataDiode.S1.Listener.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:50.788 [info] Child DataDiode.S1.HandlerSupervisor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.228.0>
Start Call: DataDiode.S1.HandlerSupervisor.start_link()
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:01:50.790 [warning] S1 Encapsulator: Invalid S2_PORT 0, using default 42001
16:01:50.790 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.229.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:50.790 [info] Child DataDiode.S1.Heartbeat of Supervisor DataDiode.Supervisor started
Pid: #PID<0.230.0>
Start Call: DataDiode.S1.Heartbeat.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:50.790 [info] Child DataDiode.S2.HeartbeatMonitor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.231.0>
Start Call: DataDiode.S2.HeartbeatMonitor.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:50.790 [info] Child DataDiode.DiskCleaner of Supervisor DataDiode.Supervisor started
Pid: #PID<0.232.0>
Start Call: DataDiode.DiskCleaner.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:50.791 [info] S2: Starting UDP Listener on port 0...
16:01:50.791 [info] Child DataDiode.S2.Listener of Supervisor DataDiode.Supervisor started
Pid: #PID<0.233.0>
Start Call: DataDiode.S2.Listener.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:50.791 [info] Child DataDiode.S2.TaskSupervisor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.234.0>
Start Call: Task.Supervisor.start_link([name: DataDiode.S2.TaskSupervisor, max_children: 200])
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:01:50.791 [info] Application data_diode started at :nonode@nohost
16:01:50.796 [info] Child ExUnit.Server of Supervisor ExUnit.Supervisor started
Pid: #PID<0.240.0>
Start Call: ExUnit.Server.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:50.796 [info] Child ExUnit.CaptureServer of Supervisor ExUnit.Supervisor started
Pid: #PID<0.241.0>
Start Call: ExUnit.CaptureServer.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:50.796 [info] Application ex_unit started at :nonode@nohost
Running ExUnit with seed: 797975, max_cases: 16

    warning: variable "c" is unused (if the variable is not meant to be used, prefix it with an underscore)
    │
 26 │     {:ok, c} = :gen_tcp.connect({127,0,0,1}, port, [:binary, active: false])
    │           ~
    │
    └─ test/long_term_robustness_test.exs:26:11: DataDiode.LongTermRobustnessTest."test TCPHandler exhaustive branch coverage"/1

    warning: variable "pid3" is unused (if the variable is not meant to be used, prefix it with an underscore)
    │
 62 │     {:ok, pid3} = TCPHandler.start_link(s3)
    │           ~~~~
    │
    └─ test/long_term_robustness_test.exs:62:11: DataDiode.LongTermRobustnessTest."test TCPHandler exhaustive branch coverage"/1

....     warning: redefining module DataDiode.S1.EncapsulatorMock (current version defined in memory)
     │
 491 │     Module.create(name, [info | body], Macro.Env.location(__ENV__))
     │     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     │
     └─ deps/mox/lib/mox.ex:491: DataDiode.S1.EncapsulatorMock (module)

......16:01:50.885 [info] DiskCleaner: Low disk space detected on . (< 15%). Starting autonomous cleanup...
16:01:50.886 [warning] DiskCleaner: Simulation - would delete oldest .dat files in . now.
..16:01:50.890 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 0 bytes.
.16:01:50.890 [debug] S2: Successfully wrote 0 bytes to ./data_1766120510890_1_51210.dat. (Simulated secure write)
.16:01:50.890 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 23 bytes.
.16:01:50.890 [debug] S2: Successfully wrote 23 bytes to ./data_1766120510890_2_51210.dat. (Simulated secure write)
16:01:50.890 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 9 bytes.
16:01:50.890 [debug] S2: Successfully wrote 9 bytes to ./data_1766120510890_3_80.dat. (Simulated secure write)
16:01:50.893 [error] S2: Failed to parse header: invalid_packet_size
.16:01:50.893 [info] S2: Decapsulated packet from 192.168.1.1:51210. Payload size: 23 bytes.
.16:01:50.893 [debug] S2: Successfully wrote 23 bytes to ./data_1766120510893_4_51210.dat. (Simulated secure write)
.16:01:50.893 [error] S2: Failed to parse header: invalid_packet_size
.16:01:50.893 [info] S2: Decapsulated packet from 0.0.0.0:0. Payload size: 0 bytes.
.16:01:50.893 [debug] S2: Successfully wrote 0 bytes to ./data_1766120510893_5_0.dat. (Simulated secure write)
16:01:50.893 [error] S2: Failed to parse header: invalid_packet_size
16:01:50.908 [info] S1: Connection closed by 1.2.3.4:80
.16:01:50.914 [info] Child of Supervisor :inet_gethost_native_sup started
Pid: #PID<0.389.0>
Start Call: :inet_gethost_native.init([])
16:01:50.914 [debug] Child :inet_gethost_native_sup of Supervisor :kernel_safe_sup started
Pid: #PID<0.388.0>
Start Call: :inet_gethost_native.start_link()
Restart: :temporary
Shutdown: 1000
Type: :worker
.16:01:50.920 [debug] S1: TCPHandler received unexpected message: :accept_loop
.16:01:50.921 [warning] S1: Dropping oversized packet (1048577 bytes) from 1.2.3.4
.16:01:50.921 [error] S1: TCP error for 1.2.3.4: :econnreset
.16:01:50.921 [debug] S1: TCPHandler received unexpected message: :unknown
.16:01:50.922 [info] S1: Forwarded 11 bytes.
.....16:01:50.985 [info] S1: Starting TCP Listener on port 8092...
16:01:50.985 [info] S1: New connection accepted.
16:01:50.986 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.40>}
16:01:50.986 [info] S1: New connection accepted.
16:01:50.986 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.46>}
16:01:50.986 [info] S1: New connection accepted.
16:01:50.986 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.48>}
16:01:50.986 [info] S1: New connection accepted.
16:01:50.986 [info] S1: New connection accepted.
16:01:50.986 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.49>}
16:01:50.986 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.51>}
16:01:50.986 [info] S1: New connection accepted.
16:01:50.986 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.52>}
16:01:50.986 [info] S1: New connection accepted.
16:01:50.986 [info] S1: New connection accepted.
16:01:50.986 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.54>}
16:01:50.986 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.55>}
16:01:50.986 [info] S1: New connection accepted.
16:01:50.986 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.56>}
16:01:50.986 [info] S1: New connection accepted.
16:01:50.987 [info] S1: New connection accepted.
16:01:50.987 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.58>}
16:01:50.987 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.60>}
16:01:50.987 [info] S1: New connection accepted.
16:01:50.987 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.62>}
16:01:50.987 [info] S1: New connection accepted.
16:01:50.987 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.64>}
16:01:50.987 [info] S1: New connection accepted.
16:01:50.987 [info] S1: New connection accepted.
16:01:50.987 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.66>}
16:01:50.987 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.68>}
16:01:50.987 [info] S1: New connection accepted.
16:01:50.987 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.70>}
16:01:50.987 [info] S1: New connection accepted.
16:01:50.988 [info] S1: New connection accepted.
16:01:50.988 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.72>}
16:01:50.988 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.74>}
16:01:50.988 [info] S1: New connection accepted.
16:01:50.988 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.76>}
16:01:50.988 [info] S1: New connection accepted.
16:01:50.988 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.78>}
16:01:50.988 [info] S1: New connection accepted.
16:01:50.988 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.80>}
16:01:50.988 [info] S1: New connection accepted.
16:01:50.988 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.82>}
16:01:50.988 [info] S1: New connection accepted.
16:01:50.988 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.84>}
16:01:50.988 [info] S1: New connection accepted.
16:01:50.988 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.86>}
16:01:50.988 [info] S1: New connection accepted.
16:01:50.988 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.88>}
16:01:50.989 [info] S1: New connection accepted.
16:01:50.989 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.90>}
16:01:50.989 [info] S1: New connection accepted.
16:01:50.989 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.92>}
16:01:50.989 [info] S1: New connection accepted.
16:01:50.989 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.94>}
16:01:50.989 [info] S1: New connection accepted.
16:01:50.989 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.96>}
16:01:50.989 [info] S1: New connection accepted.
16:01:50.989 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.98>}
16:01:50.989 [info] S1: New connection accepted.
16:01:50.989 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.100>}
16:01:50.989 [info] S1: New connection accepted.
16:01:50.989 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.102>}
16:01:50.989 [info] S1: New connection accepted.
16:01:50.989 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.104>}
16:01:50.989 [info] S1: New connection accepted.
16:01:50.989 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.106>}
16:01:50.990 [info] S1: New connection accepted.
16:01:50.990 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.108>}
16:01:50.990 [info] S1: New connection accepted.
16:01:50.990 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.110>}
16:01:50.990 [info] S1: New connection accepted.
16:01:50.990 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.112>}
16:01:50.990 [info] S1: New connection accepted.
16:01:50.990 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.114>}
16:01:50.990 [info] S1: New connection accepted.
16:01:50.990 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.116>}
16:01:50.990 [info] S1: New connection accepted.
16:01:50.990 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.118>}
16:01:50.990 [info] S1: New connection accepted.
16:01:50.990 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.120>}
16:01:50.990 [info] S1: New connection accepted.
16:01:50.990 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.122>}
16:01:50.991 [info] S1: New connection accepted.
16:01:50.991 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.124>}
16:01:50.991 [info] S1: New connection accepted.
16:01:50.991 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.126>}
16:01:50.991 [info] S1: New connection accepted.
16:01:50.991 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.128>}
16:01:50.991 [info] S1: New connection accepted.
16:01:50.991 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.130>}
16:01:50.991 [info] S1: New connection accepted.
16:01:50.991 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.132>}
16:01:50.991 [info] S1: New connection accepted.
16:01:50.991 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.134>}
16:01:50.991 [info] S1: New connection accepted.
16:01:50.991 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.136>}
16:01:50.991 [info] S1: New connection accepted.
16:01:51.492 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.138>}
.16:01:51.538 [debug] S1: TCPHandler received unexpected message: :accept_loop
.16:01:51.790 [info] S1: New connection accepted.
16:01:51.790 [info] S1: New connection accepted.
16:01:51.790 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.147>}
16:01:51.791 [info] S1: New connection accepted.
16:01:51.791 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.149>}
16:01:51.791 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.151>}
16:01:51.791 [info] S1: New connection accepted.
16:01:51.791 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.153>}
16:01:51.791 [info] S1: New connection accepted.
16:01:51.791 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.155>}
....16:01:52.047 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.229.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:52.048 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.556.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:01:52.059 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.556.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:52.060 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.558.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:01:52.070 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.558.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:52.071 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.560.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:01:52.082 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.560.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:52.082 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.562.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:52.092 [warning] S1 Encapsulator: Invalid IP invalid, dropping packet.
.16:01:52.208 [debug] SystemMonitor: Received unexpected message: :unexp
16:01:52.213 [debug] S1: TCPHandler received unexpected message: :unexp
16:01:52.213 [info] S1: Starting TCP Listener on port 0...
16:01:52.213 [debug] S1: Listener received unexpected message: :unexp
16:01:52.793 [info] S2: Starting UDP Listener on port 0...
16:01:52.793 [warning] S2: Received unexpected message: :unexp
16:01:52.793 [error] S2: UDP Listener socket closed unexpectedly. Terminating.
16:01:52.805 [info] DiskCleaner: Low disk space detected on . (< 15%). Starting autonomous cleanup...
16:01:52.805 [warning] DiskCleaner: Simulation - would delete oldest .dat files in . now.
16:01:52.809 [info] S2: Decapsulated packet from 127.0.0.1:20480. Payload size: 7 bytes.
16:01:52.809 [debug] S2: Successfully wrote 7 bytes to /tmp/diode_test/data_1766120512809_63_20480.dat. (Simulated secure write)
16:01:52.809 [info] S2: Decapsulated packet from 127.0.0.1:0. Payload size: 9 bytes.
16:01:52.811 [debug] S1: Generating end-to-end heartbeat.
16:01:52.811 [warning] S1 Heartbeat: Received unexpected message: :unexp
16:01:52.811 [error] S2: Critical Failure! Channel heartbeat missing for > 6 minutes. The diode path may be obstructed.
16:01:52.811 [warning] S2 HeartbeatMonitor: Received unexpected message: :unexp
.........16:01:52.816 [info] S1: Starting TCP Listener on port 0...
16:01:53.318 [error] S1: Listener socket fatal error: :closed. Terminating.
16:01:53.318 [error] GenServer :s1_flapping_test_unique terminating
** (stop) :closed
Last message: :accept_loop
State: #Port<0.175>
16:01:53.318 [error] Process :s1_flapping_test_unique (#PID<0.646.0>) terminating
** (exit) :closed
    (stdlib 7.1) gen_server.erl:2562: :gen_server.handle_common_reply/5
    (stdlib 7.1) proc_lib.erl:333: :proc_lib.init_p_do_apply/3
Initial Call: DataDiode.S1.Listener.init/1
Ancestors: [#PID<0.645.0>]
Message Queue Length: 0
Messages: []
Links: []
Dictionary: []
Trapping Exits: false
Status: :running
Heap Size: 1598
Stack Size: 29
Reductions: 2746
.16:01:53.319 [error] S1: Listener socket fatal error: :closed. Terminating.
.16:01:53.319 [warning] S1: Invalid LISTEN_IP invalid, using all interfaces.
...16:01:53.821 [info] S1: Starting TCP Listener on port 0...
16:01:54.322 [info] S1: New connection accepted.
.16:01:54.323 [info] S1: Starting TCP Listener on port 0...
.16:01:54.323 [info] S2: Starting UDP Listener on port 0...
16:01:54.324 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.324 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514324_65_80.dat. (Simulated secure write)
16:01:54.324 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.324 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.324 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514324_66_80.dat. (Simulated secure write)
16:01:54.324 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514324_67_80.dat. (Simulated secure write)
16:01:54.324 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.324 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514324_68_80.dat. (Simulated secure write)
16:01:54.325 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.325 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514325_69_80.dat. (Simulated secure write)
16:01:54.325 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.325 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514325_70_80.dat. (Simulated secure write)
16:01:54.325 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.325 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514325_71_80.dat. (Simulated secure write)
16:01:54.325 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.325 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514325_72_80.dat. (Simulated secure write)
16:01:54.326 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.326 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514326_73_80.dat. (Simulated secure write)
16:01:54.326 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.326 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514326_74_80.dat. (Simulated secure write)
16:01:54.326 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.326 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514326_75_80.dat. (Simulated secure write)
16:01:54.326 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.326 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514326_76_80.dat. (Simulated secure write)
16:01:54.326 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.326 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514326_77_80.dat. (Simulated secure write)
16:01:54.326 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.326 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514326_78_80.dat. (Simulated secure write)
16:01:54.327 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.327 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514327_79_80.dat. (Simulated secure write)
16:01:54.327 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.327 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514327_80_80.dat. (Simulated secure write)
16:01:54.327 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.327 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514327_81_80.dat. (Simulated secure write)
16:01:54.327 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.327 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514327_82_80.dat. (Simulated secure write)
16:01:54.327 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.327 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514327_83_80.dat. (Simulated secure write)
16:01:54.327 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.327 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514327_84_80.dat. (Simulated secure write)
16:01:54.328 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.328 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514328_85_80.dat. (Simulated secure write)
16:01:54.328 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.328 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514328_86_80.dat. (Simulated secure write)
16:01:54.328 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.328 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514328_87_80.dat. (Simulated secure write)
16:01:54.328 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.329 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514329_88_80.dat. (Simulated secure write)
16:01:54.329 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.329 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514329_89_80.dat. (Simulated secure write)
16:01:54.329 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.329 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514329_90_80.dat. (Simulated secure write)
16:01:54.329 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.329 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514329_91_80.dat. (Simulated secure write)
16:01:54.329 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.329 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514329_92_80.dat. (Simulated secure write)
16:01:54.329 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.329 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514329_93_80.dat. (Simulated secure write)
16:01:54.330 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.330 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514330_94_80.dat. (Simulated secure write)
16:01:54.330 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.330 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514330_95_80.dat. (Simulated secure write)
16:01:54.330 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.330 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514330_96_80.dat. (Simulated secure write)
16:01:54.330 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.330 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514330_97_80.dat. (Simulated secure write)
16:01:54.330 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.330 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514330_98_80.dat. (Simulated secure write)
16:01:54.330 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.330 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514330_99_80.dat. (Simulated secure write)
16:01:54.330 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.330 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514330_100_80.dat. (Simulated secure write)
16:01:54.330 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.330 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514330_101_80.dat. (Simulated secure write)
16:01:54.330 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.331 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514331_102_80.dat. (Simulated secure write)
16:01:54.331 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.331 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514331_103_80.dat. (Simulated secure write)
16:01:54.331 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.331 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514331_104_80.dat. (Simulated secure write)
16:01:54.331 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.331 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.331 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514331_105_80.dat. (Simulated secure write)
16:01:54.331 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514331_106_80.dat. (Simulated secure write)
16:01:54.331 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.331 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514331_107_80.dat. (Simulated secure write)
16:01:54.331 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.331 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514331_108_80.dat. (Simulated secure write)
16:01:54.332 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.332 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514332_109_80.dat. (Simulated secure write)
16:01:54.332 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.332 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514332_110_80.dat. (Simulated secure write)
16:01:54.332 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.332 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514332_111_80.dat. (Simulated secure write)
16:01:54.332 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.332 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514332_112_80.dat. (Simulated secure write)
16:01:54.332 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.332 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514332_113_80.dat. (Simulated secure write)
16:01:54.332 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.332 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514332_114_80.dat. (Simulated secure write)
16:01:54.332 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.332 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514332_115_80.dat. (Simulated secure write)
16:01:54.333 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.333 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514333_116_80.dat. (Simulated secure write)
16:01:54.333 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.333 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514333_117_80.dat. (Simulated secure write)
16:01:54.333 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.333 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514333_118_80.dat. (Simulated secure write)
16:01:54.333 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.333 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514333_119_80.dat. (Simulated secure write)
16:01:54.333 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.333 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514333_120_80.dat. (Simulated secure write)
16:01:54.333 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.333 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514333_121_80.dat. (Simulated secure write)
16:01:54.333 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.333 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514333_122_80.dat. (Simulated secure write)
16:01:54.334 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.334 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514334_123_80.dat. (Simulated secure write)
16:01:54.334 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.334 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514334_124_80.dat. (Simulated secure write)
16:01:54.334 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.334 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514334_125_80.dat. (Simulated secure write)
16:01:54.334 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.334 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514334_126_80.dat. (Simulated secure write)
16:01:54.334 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.334 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514334_127_80.dat. (Simulated secure write)
16:01:54.334 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.334 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514334_128_80.dat. (Simulated secure write)
16:01:54.334 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.334 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514334_129_80.dat. (Simulated secure write)
16:01:54.334 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.334 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514334_130_80.dat. (Simulated secure write)
16:01:54.335 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.335 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514335_131_80.dat. (Simulated secure write)
16:01:54.335 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.335 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514335_132_80.dat. (Simulated secure write)
16:01:54.335 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.335 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514335_133_80.dat. (Simulated secure write)
16:01:54.335 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.335 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.335 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514335_134_80.dat. (Simulated secure write)
16:01:54.335 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.335 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514335_135_80.dat. (Simulated secure write)
16:01:54.335 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.335 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514335_136_80.dat. (Simulated secure write)
16:01:54.335 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.335 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514335_137_80.dat. (Simulated secure write)
16:01:54.335 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.335 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514335_138_80.dat. (Simulated secure write)
16:01:54.336 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.336 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514336_139_80.dat. (Simulated secure write)
16:01:54.336 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.336 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514336_140_80.dat. (Simulated secure write)
16:01:54.336 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.336 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514336_141_80.dat. (Simulated secure write)
16:01:54.336 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.336 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514336_142_80.dat. (Simulated secure write)
16:01:54.336 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.336 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514336_143_80.dat. (Simulated secure write)
16:01:54.336 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.336 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514336_144_80.dat. (Simulated secure write)
16:01:54.336 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.336 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514336_145_80.dat. (Simulated secure write)
16:01:54.337 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.337 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514337_146_80.dat. (Simulated secure write)
16:01:54.337 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514337_147_80.dat. (Simulated secure write)
16:01:54.337 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.337 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.337 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.337 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514337_148_80.dat. (Simulated secure write)
16:01:54.337 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.337 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514337_149_80.dat. (Simulated secure write)
16:01:54.337 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.337 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514337_150_80.dat. (Simulated secure write)
16:01:54.337 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.337 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514337_151_80.dat. (Simulated secure write)
16:01:54.337 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.337 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514337_152_80.dat. (Simulated secure write)
16:01:54.337 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.338 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514338_153_80.dat. (Simulated secure write)
16:01:54.338 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.338 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514338_154_80.dat. (Simulated secure write)
16:01:54.338 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.338 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514338_155_80.dat. (Simulated secure write)
16:01:54.338 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.338 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514338_156_80.dat. (Simulated secure write)
16:01:54.338 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.338 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514338_157_80.dat. (Simulated secure write)
16:01:54.338 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.338 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514338_158_80.dat. (Simulated secure write)
16:01:54.338 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.338 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514338_159_80.dat. (Simulated secure write)
16:01:54.338 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.338 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514338_160_80.dat. (Simulated secure write)
16:01:54.338 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514338_161_80.dat. (Simulated secure write)
16:01:54.339 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.339 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:54.339 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514339_163_80.dat. (Simulated secure write)
16:01:54.339 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514339_162_80.dat. (Simulated secure write)
16:01:54.339 [debug] S2: Successfully wrote 7 bytes to ./data_1766120514339_164_80.dat. (Simulated secure write)
..16:01:54.441 [info] S2: Starting UDP Listener on port 0...
16:01:54.441 [info] S2: Decapsulated packet from 127.0.0.1:1234. Payload size: 12 bytes.
16:01:54.441 [debug] S2: Successfully wrote 12 bytes to ./data_1766120514441_165_1234.dat. (Simulated secure write)
16:01:54.465 [info] S2: Starting UDP Listener on port 0...
16:01:54.465 [error] S2: UDP Listener socket closed unexpectedly. Terminating.
16:01:54.466 [info] S2: Starting UDP Listener on port 0...
16:01:54.466 [info] S2: Decapsulated packet from 1.2.3.4:80. Payload size: 5 bytes.
16:01:54.466 [debug] S2: Successfully wrote 5 bytes to ./data_1766120514466_166_80.dat. (Simulated secure write)


  1) test UDP listener receives packet and delegates to Decapsulator (DataDiode.S2.ListenerTest)
     test/s2_listener_test.exs:116
     ** (Mox.VerificationError) error while verifying mocks for #PID<0.768.0>:

       * expected DataDiode.S2.DecapsulatorMock.process_packet/1 to be invoked once but it was invoked 0 times
     code: verify!()
     stacktrace:
       (mox 1.2.0) lib/mox.ex:862: Mox.__verify_mock_or_all__/2
       test/s2_listener_test.exs:140: (test)

.....16:01:54.477 [warning] S2: Invalid LISTEN_IP_S2 invalid, falling back to all interfaces.
.
Finished in 3.6 seconds (0.1s async, 3.5s sync)
1 doctest, 65 tests, 1 failure
Run 9 FAILED
Run 10
warning: setting :preferred_cli_env in your mix.exs "def project" is deprecated, set it inside "def cli" instead:

    def cli do
      [preferred_envs: [release: :prod, test: :test]]
    end

  (mix 1.19.4) lib/mix/cli.ex:187: Mix.CLI.preferred_cli_env/3
  (mix 1.19.4) lib/mix/cli.ex:170: Mix.CLI.maybe_change_env_and_target/2
  (mix 1.19.4) lib/mix/cli.ex:59: Mix.CLI.proceed/2
  /opt/homebrew/bin/mix:7: (file)
  (elixir 1.19.4) src/elixir_compiler.erl:81: :elixir_compiler.dispatch/4
  (elixir 1.19.4) src/elixir_compiler.erl:56: :elixir_compiler.compile/4

16:01:54.945 [info] Application logger started at :nonode@nohost
16:01:54.950 [info] Child :ttb_autostart of Supervisor :runtime_tools_sup started
Pid: #PID<0.183.0>
Start Call: :ttb_autostart.start_link()
Restart: :temporary
Shutdown: 3000
Type: :worker
16:01:54.950 [info] Application runtime_tools started at :nonode@nohost
16:01:54.950 [info] Application opentelemetry_api started at :nonode@nohost
16:01:54.950 [info] Application ctx started at :nonode@nohost
16:01:54.950 [info] Application hpack started at :nonode@nohost
16:01:54.950 [info] Application chatterbox started at :nonode@nohost
16:01:54.950 [info] Application acceptor_pool started at :nonode@nohost
16:01:54.955 [info] Child :gproc of Supervisor :gproc_sup started
Pid: #PID<0.187.0>
Start Call: :gproc.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:01:54.956 [info] Child :gproc_monitor of Supervisor :gproc_sup started
Pid: #PID<0.188.0>
Start Call: :gproc_monitor.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:01:54.956 [info] Child :gproc_bcast of Supervisor :gproc_sup started
Pid: #PID<0.189.0>
Start Call: :gproc_bcast.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:01:54.958 [info] Child :gproc_pool of Supervisor :gproc_sup started
Pid: #PID<0.190.0>
Start Call: :gproc_pool.start_link()
Restart: :permanent
Shutdown: 2000
Type: :worker
16:01:54.958 [info] Application gproc started at :nonode@nohost
16:01:54.959 [info] Child :grpcbox_services_simple_sup of Supervisor :grpcbox_sup started
Pid: #PID<0.194.0>
Start Call: :grpcbox_services_simple_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:01:54.960 [info] Child :grpcbox_channel_sup of Supervisor :grpcbox_sup started
Pid: #PID<0.195.0>
Start Call: :grpcbox_channel_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:01:54.960 [info] Application grpcbox started at :nonode@nohost
16:01:54.960 [info] Application ssl_verify_fun started at :nonode@nohost
16:01:55.024 [info] Loading 162 CA(s) from :otp store
16:01:55.024 [info] Child :tls_certificate_check_shared_state of Supervisor :tls_certificate_check_sup started
Pid: #PID<0.199.0>
Start Call: :tls_certificate_check_shared_state.start_link()
Restart: :permanent
Shutdown: :infinity
Type: :worker
16:01:55.024 [info] Application tls_certificate_check started at :nonode@nohost
16:01:55.024 [info] Application opentelemetry_exporter started at :nonode@nohost
16:01:55.031 [info] Child :otel_span_ets of Supervisor :otel_span_sup started
Pid: #PID<0.207.0>
Start Call: :otel_span_ets.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:55.031 [info] Child :otel_span_sweeper of Supervisor :otel_span_sup started
Pid: #PID<0.208.0>
Start Call: :otel_span_sweeper.start_link(%{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:55.031 [info] Child :otel_span_sup of Supervisor :opentelemetry_sup started
Pid: #PID<0.206.0>
Start Call: :otel_span_sup.start_link(%{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:01:55.034 [info] Child :otel_resource_detector of Supervisor :opentelemetry_sup started
Pid: #PID<0.209.0>
Start Call: :otel_resource_detector.start_link(%{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:55.036 [info] Child :otel_tracer_provider_sup of Supervisor :opentelemetry_sup started
Pid: #PID<0.212.0>
Start Call: :otel_tracer_provider_sup.start_link()
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:01:55.038 [info] Child :otel_span_processor_sup of Supervisor #PID<0.213.0> (:otel_tracer_server_sup) started
Pid: #PID<0.214.0>
Start Call: :otel_span_processor_sup.start_link(:otel_span_processor_sup_global)
Restart: :permanent
Shutdown: 5000
Type: :supervisor
16:01:55.043 [info] Child :otel_tracer_server of Supervisor #PID<0.213.0> (:otel_tracer_server_sup) started
Pid: #PID<0.215.0>
Start Call: :otel_tracer_server.start_link(:global, :otel_tracer_provider_global, :otel_span_processor_sup_global, {:resource, :undefined, {:attributes, 128, 255, 0, %{"process.executable.name": "erl", "process.runtime.description": "Erlang/OTP 28 erts-16.1.2", "process.runtime.version": "16.1.2", "process.runtime.name": "BEAM", "service.name": "unknown_service:erl", "service.instance.id": 127367609729905844265053175302080106514, "telemetry.sdk.version": "1.6.0", "telemetry.sdk.language": "erlang", "telemetry.sdk.name": "opentelemetry"}}}, %{log_level: :info, sdk_disabled: false, text_map_propagators: [:trace_context, :baggage], create_application_tracers: true, attribute_count_limit: 128, attribute_per_event_limit: 128, attribute_per_link_limit: 128, attribute_value_length_limit: :infinity, bsp_exporting_timeout_ms: :undefined, bsp_max_queue_size: :undefined, bsp_scheduled_delay_ms: :undefined, deny_list: [], event_count_limit: 128, exemplar_filter: :trace_based, exemplars_enabled: false, id_generator: :otel_id_generator, link_count_limit: 128, metric_producers: [], metrics_exporter: {:opentelemetry_exporter, %{}}, processors: [otel_batch_processor: %{exporter: {:opentelemetry_exporter, %{}}, exporting_timeout_ms: 30000, max_queue_size: 2048, scheduled_delay_ms: 5000}], readers: [], register_loaded_applications: :undefined, resource_detector_timeout: 5000, resource_detectors: [:otel_resource_env_var, :otel_resource_app_env], sampler: {:parent_based, %{root: :always_on}}, ssp_exporting_timeout_ms: :undefined, sweeper: %{strategy: :drop, interval: 600000, span_ttl: 1800000, storage_size: :infinity}, traces_exporter: {:opentelemetry_exporter, %{}}, views: []})
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:55.047 [debug] Child {:httpc, :"otel_exporter_otlp_<0.216.0>"} of Supervisor :httpc_profile_sup started
Pid: #PID<0.217.0>
Start Call: :httpc_manager.start_link(:"otel_exporter_otlp_<0.216.0>", :only_session_cookies, :inets)
Restart: :permanent
Shutdown: 4000
Type: :worker
16:01:55.049 [info] OTLP exporter successfully initialized
16:01:55.050 [info] Application opentelemetry started at :nonode@nohost
16:01:55.051 [info] Application jason started at :nonode@nohost
16:01:55.051 [info] Application logger_json started at :nonode@nohost
16:01:55.051 [info] Application nimble_ownership started at :nonode@nohost
16:01:55.054 [info] Child Mox of Supervisor Mox.Supervisor started
Pid: #PID<0.221.0>
Start Call: Mox.start_link_ownership()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:55.054 [info] Application mox started at :nonode@nohost
16:01:55.059 [info] Child DataDiode.Metrics of Supervisor DataDiode.Supervisor started
Pid: #PID<0.225.0>
Start Call: DataDiode.Metrics.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:55.059 [info] Child DataDiode.SystemMonitor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.226.0>
Start Call: DataDiode.SystemMonitor.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:55.059 [info] S1: Starting TCP Listener on port 0...
16:01:55.059 [info] Child DataDiode.S1.Listener of Supervisor DataDiode.Supervisor started
Pid: #PID<0.227.0>
Start Call: DataDiode.S1.Listener.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:55.061 [info] Child DataDiode.S1.HandlerSupervisor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.228.0>
Start Call: DataDiode.S1.HandlerSupervisor.start_link()
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:01:55.063 [warning] S1 Encapsulator: Invalid S2_PORT 0, using default 42001
16:01:55.063 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.229.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:55.063 [info] Child DataDiode.S1.Heartbeat of Supervisor DataDiode.Supervisor started
Pid: #PID<0.230.0>
Start Call: DataDiode.S1.Heartbeat.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:55.063 [info] Child DataDiode.S2.HeartbeatMonitor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.231.0>
Start Call: DataDiode.S2.HeartbeatMonitor.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:55.063 [info] Child DataDiode.DiskCleaner of Supervisor DataDiode.Supervisor started
Pid: #PID<0.232.0>
Start Call: DataDiode.DiskCleaner.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:55.063 [info] S2: Starting UDP Listener on port 0...
16:01:55.063 [info] Child DataDiode.S2.Listener of Supervisor DataDiode.Supervisor started
Pid: #PID<0.233.0>
Start Call: DataDiode.S2.Listener.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:55.064 [info] Child DataDiode.S2.TaskSupervisor of Supervisor DataDiode.Supervisor started
Pid: #PID<0.234.0>
Start Call: Task.Supervisor.start_link([name: DataDiode.S2.TaskSupervisor, max_children: 200])
Restart: :permanent
Shutdown: :infinity
Type: :supervisor
16:01:55.064 [info] Application data_diode started at :nonode@nohost
16:01:55.068 [info] Child ExUnit.Server of Supervisor ExUnit.Supervisor started
Pid: #PID<0.240.0>
Start Call: ExUnit.Server.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:55.068 [info] Child ExUnit.CaptureServer of Supervisor ExUnit.Supervisor started
Pid: #PID<0.241.0>
Start Call: ExUnit.CaptureServer.start_link([])
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:55.068 [info] Application ex_unit started at :nonode@nohost
Running ExUnit with seed: 69871, max_cases: 16

    warning: variable "c" is unused (if the variable is not meant to be used, prefix it with an underscore)
    │
 26 │     {:ok, c} = :gen_tcp.connect({127,0,0,1}, port, [:binary, active: false])
    │           ~
    │
    └─ test/long_term_robustness_test.exs:26:11: DataDiode.LongTermRobustnessTest."test TCPHandler exhaustive branch coverage"/1

    warning: variable "pid3" is unused (if the variable is not meant to be used, prefix it with an underscore)
    │
 62 │     {:ok, pid3} = TCPHandler.start_link(s3)
    │           ~~~~
    │
    └─ test/long_term_robustness_test.exs:62:11: DataDiode.LongTermRobustnessTest."test TCPHandler exhaustive branch coverage"/1

....     warning: redefining module DataDiode.S1.EncapsulatorMock (current version defined in memory)
     │
 491 │     Module.create(name, [info | body], Macro.Env.location(__ENV__))
     │     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     │
     └─ deps/mox/lib/mox.ex:491: DataDiode.S1.EncapsulatorMock (module)

................16:01:55.191 [error] S1: TCP error for 1.2.3.4: :econnreset
.16:01:55.206 [info] Child of Supervisor :inet_gethost_native_sup started
Pid: #PID<0.414.0>
Start Call: :inet_gethost_native.init([])
16:01:55.207 [debug] Child :inet_gethost_native_sup of Supervisor :kernel_safe_sup started
Pid: #PID<0.413.0>
Start Call: :inet_gethost_native.start_link()
Restart: :temporary
Shutdown: 1000
Type: :worker
16:01:55.219 [info] S1: Forwarded 11 bytes.
.16:01:55.231 [warning] S1: Dropping oversized packet (1048577 bytes) from 1.2.3.4
.16:01:55.231 [debug] S1: TCPHandler received unexpected message: :unknown
.16:01:55.232 [info] S1: Connection closed by 1.2.3.4:80
..16:01:55.232 [debug] S1: TCPHandler received unexpected message: :accept_loop
.16:01:55.233 [info] S1: Starting TCP Listener on port 8092...
16:01:55.234 [info] S1: New connection accepted.
16:01:55.237 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.37>}
16:01:55.237 [info] S1: New connection accepted.
16:01:55.237 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.44>}
16:01:55.237 [info] S1: New connection accepted.
16:01:55.237 [info] S1: New connection accepted.
16:01:55.237 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.45>}
16:01:55.237 [info] S1: New connection accepted.
16:01:55.237 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.46>}
16:01:55.237 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.47>}
16:01:55.237 [info] S1: New connection accepted.
16:01:55.237 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.48>}
16:01:55.310 [info] S1: New connection accepted.
16:01:55.310 [info] S1: New connection accepted.
16:01:55.310 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.49>}
16:01:55.311 [info] S1: New connection accepted.
16:01:55.311 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.51>}
16:01:55.311 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.53>}
16:01:55.311 [info] S1: New connection accepted.
16:01:55.311 [info] S1: New connection accepted.
16:01:55.311 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.55>}
16:01:55.311 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.57>}
16:01:55.311 [info] S1: New connection accepted.
16:01:55.311 [info] S1: New connection accepted.
16:01:55.311 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.59>}
16:01:55.311 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.61>}
16:01:55.311 [info] S1: New connection accepted.
16:01:55.312 [info] S1: New connection accepted.
16:01:55.312 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.63>}
16:01:55.312 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.65>}
16:01:55.312 [info] S1: New connection accepted.
16:01:55.312 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.67>}
16:01:55.312 [info] S1: New connection accepted.
16:01:55.312 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.69>}
16:01:55.312 [info] S1: New connection accepted.
16:01:55.312 [info] S1: New connection accepted.
16:01:55.312 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.71>}
16:01:55.312 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.73>}
16:01:55.312 [info] S1: New connection accepted.
16:01:55.312 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.75>}
16:01:55.312 [info] S1: New connection accepted.
16:01:55.312 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.77>}
16:01:55.313 [info] S1: New connection accepted.
16:01:55.313 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.79>}
16:01:55.313 [info] S1: New connection accepted.
16:01:55.313 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.81>}
16:01:55.313 [info] S1: New connection accepted.
16:01:55.313 [info] S1: New connection accepted.
16:01:55.313 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.83>}
16:01:55.313 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.85>}
16:01:55.313 [info] S1: New connection accepted.
16:01:55.313 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.87>}
16:01:55.313 [info] S1: New connection accepted.
16:01:55.313 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.89>}
16:01:55.314 [info] S1: New connection accepted.
16:01:55.314 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.91>}
16:01:55.314 [info] S1: New connection accepted.
16:01:55.314 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.93>}
16:01:55.314 [info] S1: New connection accepted.
16:01:55.314 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.95>}
16:01:55.314 [info] S1: New connection accepted.
16:01:55.314 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.97>}
16:01:55.314 [info] S1: New connection accepted.
16:01:55.314 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.99>}
16:01:55.314 [info] S1: New connection accepted.
16:01:55.314 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.101>}
16:01:55.315 [info] S1: New connection accepted.
16:01:55.315 [info] S1: New connection accepted.
16:01:55.315 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.103>}
16:01:55.315 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.105>}
16:01:55.315 [info] S1: New connection accepted.
16:01:55.315 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.107>}
16:01:55.315 [info] S1: New connection accepted.
16:01:55.315 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.109>}
16:01:55.315 [info] S1: New connection accepted.
16:01:55.315 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.111>}
16:01:55.315 [info] S1: New connection accepted.
16:01:55.315 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.113>}
16:01:55.315 [info] S1: New connection accepted.
16:01:55.315 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.115>}
16:01:55.316 [info] S1: New connection accepted.
16:01:55.316 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.117>}
16:01:55.316 [info] S1: New connection accepted.
16:01:55.316 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.119>}
16:01:55.316 [info] S1: New connection accepted.
16:01:55.316 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.121>}
16:01:55.316 [info] S1: New connection accepted.
16:01:55.316 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.123>}
16:01:55.316 [info] S1: New connection accepted.
16:01:55.316 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.125>}
16:01:55.316 [info] S1: New connection accepted.
16:01:55.316 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.127>}
16:01:55.316 [info] S1: New connection accepted.
16:01:55.316 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.129>}
16:01:55.316 [info] S1: New connection accepted.
16:01:55.316 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.131>}
16:01:55.316 [info] S1: New connection accepted.
16:01:55.317 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.133>}
16:01:55.317 [info] S1: New connection accepted.
16:01:55.317 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.135>}
...........16:01:55.970 [debug] S1: TCPHandler received unexpected message: :accept_loop
.16:01:56.066 [info] S1: New connection accepted.
16:01:56.066 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.149>}
16:01:56.066 [info] S1: New connection accepted.
16:01:56.066 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.152>}
16:01:56.066 [info] S1: New connection accepted.
16:01:56.066 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.153>}
16:01:56.066 [info] S1: New connection accepted.
16:01:56.066 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.155>}
16:01:56.066 [info] S1: New connection accepted.
.16:01:56.270 [info] S2: Starting UDP Listener on port 0...
16:01:56.270 [info] S2: Decapsulated packet from 127.0.0.1:1234. Payload size: 12 bytes.
16:01:56.270 [debug] S2: Successfully wrote 12 bytes to ./data_1766120516270_62_1234.dat. (Simulated secure write)
16:01:56.291 [error] S2: UDP Listener socket closed unexpectedly. Terminating.
16:01:56.292 [info] S2: Starting UDP Listener on port 0...
16:01:56.292 [info] S2: Decapsulated packet from 1.2.3.4:80. Payload size: 5 bytes.
16:01:56.292 [debug] S2: Successfully wrote 5 bytes to ./data_1766120516292_63_80.dat. (Simulated secure write)


  1) test UDP listener receives packet and delegates to Decapsulator (DataDiode.S2.ListenerTest)
     test/s2_listener_test.exs:116
     ** (Mox.VerificationError) error while verifying mocks for #PID<0.583.0>:

       * expected DataDiode.S2.DecapsulatorMock.process_packet/1 to be invoked once but it was invoked 0 times
     code: verify!()
     stacktrace:
       (mox 1.2.0) lib/mox.ex:862: Mox.__verify_mock_or_all__/2
       test/s2_listener_test.exs:140: (test)

..16:01:56.302 [warning] S2: Invalid LISTEN_IP_S2 invalid, falling back to all interfaces.
...16:01:56.302 [info] S2: Starting UDP Listener on port 0...
16:01:56.303 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.303 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516303_64_80.dat. (Simulated secure write)
16:01:56.303 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.303 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516303_65_80.dat. (Simulated secure write)
16:01:56.303 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.303 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.303 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516303_66_80.dat. (Simulated secure write)
16:01:56.303 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516303_67_80.dat. (Simulated secure write)
16:01:56.303 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.303 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516303_68_80.dat. (Simulated secure write)
16:01:56.303 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.303 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516303_69_80.dat. (Simulated secure write)
16:01:56.303 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.303 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516303_70_80.dat. (Simulated secure write)
16:01:56.303 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.303 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516303_71_80.dat. (Simulated secure write)
16:01:56.303 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.303 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516303_72_80.dat. (Simulated secure write)
16:01:56.303 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.303 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516303_73_80.dat. (Simulated secure write)
16:01:56.303 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.304 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516304_74_80.dat. (Simulated secure write)
16:01:56.304 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.304 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516304_75_80.dat. (Simulated secure write)
16:01:56.304 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.304 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516304_76_80.dat. (Simulated secure write)
16:01:56.304 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.304 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516304_77_80.dat. (Simulated secure write)
16:01:56.304 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.304 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516304_78_80.dat. (Simulated secure write)
16:01:56.304 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.304 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516304_79_80.dat. (Simulated secure write)
16:01:56.304 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.304 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516304_80_80.dat. (Simulated secure write)
16:01:56.304 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.304 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516304_81_80.dat. (Simulated secure write)
16:01:56.304 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.304 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516304_82_80.dat. (Simulated secure write)
16:01:56.304 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.304 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516304_83_80.dat. (Simulated secure write)
16:01:56.304 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.304 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516304_84_80.dat. (Simulated secure write)
16:01:56.304 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.304 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516304_85_80.dat. (Simulated secure write)
16:01:56.304 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.304 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516304_86_80.dat. (Simulated secure write)
16:01:56.304 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.304 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516304_87_80.dat. (Simulated secure write)
16:01:56.304 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.304 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516304_88_80.dat. (Simulated secure write)
16:01:56.304 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.305 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516305_89_80.dat. (Simulated secure write)
16:01:56.305 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.305 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516305_90_80.dat. (Simulated secure write)
16:01:56.305 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.305 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516305_91_80.dat. (Simulated secure write)
16:01:56.305 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.305 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516305_92_80.dat. (Simulated secure write)
16:01:56.305 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.305 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516305_93_80.dat. (Simulated secure write)
16:01:56.305 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.305 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516305_94_80.dat. (Simulated secure write)
16:01:56.305 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.305 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516305_95_80.dat. (Simulated secure write)
16:01:56.305 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.305 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516305_96_80.dat. (Simulated secure write)
16:01:56.305 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.305 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516305_97_80.dat. (Simulated secure write)
16:01:56.305 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.305 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.305 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516305_98_80.dat. (Simulated secure write)
16:01:56.305 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516305_99_80.dat. (Simulated secure write)
16:01:56.305 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.305 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516305_100_80.dat. (Simulated secure write)
16:01:56.305 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.305 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516305_101_80.dat. (Simulated secure write)
16:01:56.305 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.305 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516305_102_80.dat. (Simulated secure write)
16:01:56.305 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.305 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516305_103_80.dat. (Simulated secure write)
16:01:56.305 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.305 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516305_104_80.dat. (Simulated secure write)
16:01:56.305 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.306 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516306_105_80.dat. (Simulated secure write)
16:01:56.306 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.306 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516306_106_80.dat. (Simulated secure write)
16:01:56.306 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.306 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516306_107_80.dat. (Simulated secure write)
16:01:56.306 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.306 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516306_108_80.dat. (Simulated secure write)
16:01:56.306 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.306 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516306_109_80.dat. (Simulated secure write)
16:01:56.306 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.306 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516306_110_80.dat. (Simulated secure write)
16:01:56.306 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.306 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516306_111_80.dat. (Simulated secure write)
16:01:56.306 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.306 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516306_112_80.dat. (Simulated secure write)
16:01:56.306 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.306 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516306_113_80.dat. (Simulated secure write)
16:01:56.306 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.306 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516306_114_80.dat. (Simulated secure write)
16:01:56.306 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.306 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516306_115_80.dat. (Simulated secure write)
16:01:56.306 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.306 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516306_116_80.dat. (Simulated secure write)
16:01:56.306 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.306 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516306_117_80.dat. (Simulated secure write)
16:01:56.306 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.306 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516306_118_80.dat. (Simulated secure write)
16:01:56.306 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.306 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516306_119_80.dat. (Simulated secure write)
16:01:56.307 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.307 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516307_120_80.dat. (Simulated secure write)
16:01:56.307 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.307 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516307_121_80.dat. (Simulated secure write)
16:01:56.307 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.307 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516307_122_80.dat. (Simulated secure write)
16:01:56.307 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.307 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.307 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.307 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.307 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.307 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.307 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.307 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.307 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.307 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.307 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.307 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516307_123_80.dat. (Simulated secure write)
16:01:56.307 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516307_129_80.dat. (Simulated secure write)
16:01:56.307 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516307_124_80.dat. (Simulated secure write)
16:01:56.307 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516307_125_80.dat. (Simulated secure write)
16:01:56.307 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516307_126_80.dat. (Simulated secure write)
16:01:56.307 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516307_127_80.dat. (Simulated secure write)
16:01:56.307 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516307_128_80.dat. (Simulated secure write)
16:01:56.307 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.307 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516307_131_80.dat. (Simulated secure write)
16:01:56.307 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516307_132_80.dat. (Simulated secure write)
16:01:56.307 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516307_130_80.dat. (Simulated secure write)
16:01:56.308 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.308 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516308_133_80.dat. (Simulated secure write)
16:01:56.308 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516308_134_80.dat. (Simulated secure write)
16:01:56.308 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.308 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516308_135_80.dat. (Simulated secure write)
16:01:56.308 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.308 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516308_136_80.dat. (Simulated secure write)
16:01:56.308 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.308 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516308_137_80.dat. (Simulated secure write)
16:01:56.308 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.308 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516308_138_80.dat. (Simulated secure write)
16:01:56.308 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.308 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516308_139_80.dat. (Simulated secure write)
16:01:56.308 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.308 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516308_140_80.dat. (Simulated secure write)
16:01:56.308 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.308 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516308_141_80.dat. (Simulated secure write)
16:01:56.308 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.308 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516308_142_80.dat. (Simulated secure write)
16:01:56.308 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516308_143_80.dat. (Simulated secure write)
16:01:56.308 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.308 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.308 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.308 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.308 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.308 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.308 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.308 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.309 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.309 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.309 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.309 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.309 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.309 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.309 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.309 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.309 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.309 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.309 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516309_146_80.dat. (Simulated secure write)
16:01:56.309 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516309_150_80.dat. (Simulated secure write)
16:01:56.309 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516309_148_80.dat. (Simulated secure write)
16:01:56.309 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516309_151_80.dat. (Simulated secure write)
16:01:56.309 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.309 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516309_153_80.dat. (Simulated secure write)
16:01:56.309 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516309_144_80.dat. (Simulated secure write)
16:01:56.309 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516309_154_80.dat. (Simulated secure write)
16:01:56.309 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516309_145_80.dat. (Simulated secure write)
16:01:56.309 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516309_152_80.dat. (Simulated secure write)
16:01:56.309 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516309_147_80.dat. (Simulated secure write)
16:01:56.309 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516309_149_80.dat. (Simulated secure write)
16:01:56.309 [info] S2: Decapsulated packet from 127.0.0.1:80. Payload size: 7 bytes.
16:01:56.309 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516309_155_80.dat. (Simulated secure write)
16:01:56.310 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516310_156_80.dat. (Simulated secure write)
16:01:56.310 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516310_157_80.dat. (Simulated secure write)
16:01:56.310 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516310_158_80.dat. (Simulated secure write)
16:01:56.310 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516310_159_80.dat. (Simulated secure write)
16:01:56.310 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516310_160_80.dat. (Simulated secure write)
16:01:56.310 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516310_161_80.dat. (Simulated secure write)
16:01:56.310 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516310_162_80.dat. (Simulated secure write)
16:01:56.310 [debug] S2: Successfully wrote 7 bytes to ./data_1766120516310_163_80.dat. (Simulated secure write)
..16:01:56.413 [info] S2: Starting UDP Listener on port 0...
.16:01:56.413 [warning] S1: Invalid LISTEN_IP invalid, using all interfaces.
..16:01:56.567 [debug] S1: Listener received unexpected message: {:tcp_closed, #Port<0.157>}
.16:01:56.915 [info] S1: Starting TCP Listener on port 0...
.16:01:56.915 [error] S1: Listener socket fatal error: :closed. Terminating.
.16:01:56.915 [info] S1: Starting TCP Listener on port 0...
16:01:57.417 [info] S1: New connection accepted.
....16:01:57.418 [info] S1: Starting TCP Listener on port 0...
16:01:57.919 [error] S1: Listener socket fatal error: :closed. Terminating.
16:01:57.919 [error] GenServer :s1_flapping_test_unique terminating
** (stop) :closed
Last message: :accept_loop
State: #Port<0.171>
16:01:57.919 [error] Process :s1_flapping_test_unique (#PID<0.728.0>) terminating
** (exit) :closed
    (stdlib 7.1) gen_server.erl:2562: :gen_server.handle_common_reply/5
    (stdlib 7.1) proc_lib.erl:333: :proc_lib.init_p_do_apply/3
Initial Call: DataDiode.S1.Listener.init/1
Ancestors: [#PID<0.727.0>]
Message Queue Length: 0
Messages: []
Links: []
Dictionary: []
Trapping Exits: false
Status: :running
Heap Size: 1598
Stack Size: 29
Reductions: 2746
.16:01:57.920 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.229.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:57.920 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.732.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:57.930 [warning] S1 Encapsulator: Invalid IP invalid, dropping packet.
.16:01:58.032 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.732.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:58.032 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.734.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:01:58.043 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.734.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:58.043 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.736.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
.16:01:58.055 [error] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor terminated
** (exit) killed
Pid: #PID<0.736.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
16:01:58.055 [info] Child DataDiode.S1.Encapsulator of Supervisor DataDiode.Supervisor started
Pid: #PID<0.738.0>
Start Call: DataDiode.S1.Encapsulator.start_link()
Restart: :permanent
Shutdown: 5000
Type: :worker
...16:01:58.087 [debug] SystemMonitor: Received unexpected message: :unexp
16:01:58.093 [debug] S1: TCPHandler received unexpected message: :unexp
16:01:58.093 [info] S1: Starting TCP Listener on port 0...
16:01:58.093 [debug] S1: Listener received unexpected message: :unexp
16:01:59.073 [info] S2: Starting UDP Listener on port 0...
16:01:59.073 [warning] S2: Received unexpected message: :unexp
16:01:59.073 [error] S2: UDP Listener socket closed unexpectedly. Terminating.
16:01:59.080 [info] DiskCleaner: Low disk space detected on . (< 15%). Starting autonomous cleanup...
16:01:59.080 [warning] DiskCleaner: Simulation - would delete oldest .dat files in . now.
16:01:59.087 [info] S2: Decapsulated packet from 127.0.0.1:20480. Payload size: 7 bytes.
16:01:59.087 [debug] S2: Successfully wrote 7 bytes to /tmp/diode_test/data_1766120519087_165_20480.dat. (Simulated secure write)
16:01:59.087 [info] S2: Decapsulated packet from 127.0.0.1:0. Payload size: 9 bytes.
16:01:59.089 [debug] S1: Generating end-to-end heartbeat.
16:01:59.089 [warning] S1 Heartbeat: Received unexpected message: :unexp
16:01:59.089 [error] S2: Critical Failure! Channel heartbeat missing for > 6 minutes. The diode path may be obstructed.
16:01:59.089 [warning] S2 HeartbeatMonitor: Received unexpected message: :unexp
.
Finished in 4.0 seconds (0.1s async, 3.8s sync)
1 doctest, 65 tests, 1 failure
Run 10 FAILED
